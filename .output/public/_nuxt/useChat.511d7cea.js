var rn=Object.defineProperty;var sn=(e,t,o)=>t in e?rn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var we=(e,t,o)=>(sn(e,typeof t!="symbol"?t+"":t,o),o);import{a4 as Tt,a6 as an,b4 as At,a3 as at,i as ln,Z as kt,c5 as cn,aY as xt,c6 as it,q as ee,c7 as un,aw as fn,c8 as dn,av as hn,bK as He,af as pe,aE as vn,V as mn,W as lt,K as Mt,b as Q,a7 as je,au as pn,a8 as gn,m as yn,c9 as wn,ca as bn,a2 as se,r as P,n as Je,cb as ct,aU as ut,ao as Cn,az as ae,o as j,g as K,w as Y,ak as Re,a as X,D as O,s as ft,aB as be,c as $e,am as Ce,A as ie,t as fe,b5 as Ee,d as Le,aA as Oe,as as En,ab as _t,cc as It,cd as Ht,at as dt,ah as Sn,ad as Bn,aC as ht,bx as vt,ce as Ze,cf as Tn,cg as An,ch as kn,ci as xn,cj as te,f as mt,ck as Mn,L as _n,E as G,aI as Me,cl as Ye,aH as pt,cm as In,j as Rt}from"./entry.32771b15.js";import{E as Hn}from"./el-button.93db6cc9.js";import{t as Rn,E as $n}from"./el-input.ece2ad57.js";import{u as Se}from"./useTitle.34b5aadb.js";import{E as Ln,i as On}from"./focus-trap.447ef56c.js";import{a as Nn}from"./scroll.7528881f.js";const Dn='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',zn=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,gt=e=>Array.from(e.querySelectorAll(Dn)).filter(t=>Pn(t)&&zn(t)),Pn=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.disabled)return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}};var ke=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(ke||{});const Wn=(e,t,o)=>{let s={offsetX:0,offsetY:0};const i=C=>{const M=C.clientX,n=C.clientY,{offsetX:A,offsetY:B}=s,w=e.value.getBoundingClientRect(),R=w.left,_=w.top,E=w.width,y=w.height,S=document.documentElement.clientWidth,a=document.documentElement.clientHeight,m=-R+A,r=-_+B,u=S-R-E+A,p=a-_-y+B,v=b=>{const x=Math.min(Math.max(A+b.clientX-M,m),u),T=Math.min(Math.max(B+b.clientY-n,r),p);s={offsetX:x,offsetY:T},e.value.style.transform=`translate(${at(x)}, ${at(T)})`},k=()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",k)},l=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",i)},g=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",i)};Tt(()=>{an(()=>{o.value?l():g()})}),At(()=>{g()})},Un=(e,t={})=>{ln(e)||Rn("[useLockscreen]","You need to pass a ref param to this function");const o=t.ns||kt("popup"),s=cn(()=>o.bm("parent","hidden"));if(!xt||it(document.body,s.value))return;let i=0,l=!1,g="0";const C=()=>{setTimeout(()=>{hn(document==null?void 0:document.body,s.value),l&&document&&(document.body.style.width=g)},200)};ee(e,M=>{if(!M){C();return}l=!it(document.body,s.value),l&&(g=document.body.style.width),i=Nn(o.namespace.value);const n=document.documentElement.clientHeight<document.body.scrollHeight,A=un(document.body,"overflowY");i>0&&(n||A==="scroll")&&l&&(document.body.style.width=`calc(100% - ${i}px)`),fn(document.body,s.value)}),dn(()=>C())},$t=e=>{if(!e)return{onClick:He,onMousedown:He,onMouseup:He};let t=!1,o=!1;return{onClick:g=>{t&&o&&e(g),t=o=!1},onMousedown:g=>{t=g.target===g.currentTarget},onMouseup:g=>{o=g.target===g.currentTarget}}},Xe="_trap-focus-children",ne=[],yt=e=>{if(ne.length===0)return;const t=ne[ne.length-1][Xe];if(t.length>0&&e.code===vn.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const o=e.shiftKey,s=e.target===t[0],i=e.target===t[t.length-1];s&&o&&(e.preventDefault(),t[t.length-1].focus()),i&&!o&&(e.preventDefault(),t[0].focus())}},Vn={beforeMount(e){e[Xe]=gt(e),ne.push(e),ne.length<=1&&document.addEventListener("keydown",yt)},updated(e){pe(()=>{e[Xe]=gt(e)})},unmounted(){ne.shift(),ne.length===0&&document.removeEventListener("keydown",yt)}},qn=mn({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:lt([String,Array,Object])},zIndex:{type:lt([String,Number])}}),jn={click:e=>e instanceof MouseEvent},Yn="overlay";var Xn=Mt({name:"ElOverlay",props:qn,emits:jn,setup(e,{slots:t,emit:o}){const s=kt(Yn),i=M=>{o("click",M)},{onClick:l,onMousedown:g,onMouseup:C}=$t(e.customMaskEvent?void 0:i);return()=>e.mask?Q("div",{class:[s.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:l,onMousedown:g,onMouseup:C},[je(t,"default")],ke.STYLE|ke.CLASS|ke.PROPS,["onClick","onMouseup","onMousedown"]):pn("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[je(t,"default")])}});const Kn=Xn,Gn=Mt({name:"ElMessageBox",directives:{TrapFocus:Vn},components:{ElButton:Hn,ElFocusTrap:Ln,ElInput:$n,ElOverlay:Kn,ElIcon:yn,...wn},inheritAttrs:!1,props:{buttonSize:{type:String,validator:On},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:o,zIndex:s,ns:i,size:l}=bn("message-box",se(()=>e.buttonSize)),{t:g}=o,{nextZIndex:C}=s,M=P(!1),n=Je({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:C()}),A=se(()=>{const I=n.type;return{[i.bm("icon",I)]:I&&ct[I]}}),B=ut(),w=ut(),R=se(()=>n.icon||ct[n.type]||""),_=se(()=>!!n.message),E=P(),y=P(),S=P(),a=P(),m=P(),r=se(()=>n.confirmButtonClass);ee(()=>n.inputValue,async I=>{await pe(),e.boxType==="prompt"&&I!==null&&T()},{immediate:!0}),ee(()=>M.value,I=>{var $,D;I&&(e.boxType!=="prompt"&&(n.autofocus?S.value=(D=($=m.value)==null?void 0:$.$el)!=null?D:E.value:S.value=E.value),n.zIndex=C()),e.boxType==="prompt"&&(I?pe().then(()=>{var L;a.value&&a.value.$el&&(n.autofocus?S.value=(L=H())!=null?L:E.value:S.value=E.value)}):(n.editorErrorMessage="",n.validateError=!1))});const u=se(()=>e.draggable);Wn(E,y,u),Tt(async()=>{await pe(),e.closeOnHashChange&&window.addEventListener("hashchange",p)}),At(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",p)});function p(){M.value&&(M.value=!1,pe(()=>{n.action&&t("action",n.action)}))}const v=()=>{e.closeOnClickModal&&x(n.distinguishCancelAndClose?"close":"cancel")},k=$t(v),b=I=>{if(n.inputType!=="textarea")return I.preventDefault(),x("confirm")},x=I=>{var $;e.boxType==="prompt"&&I==="confirm"&&!T()||(n.action=I,n.beforeClose?($=n.beforeClose)==null||$.call(n,I,n,p):p())},T=()=>{if(e.boxType==="prompt"){const I=n.inputPattern;if(I&&!I.test(n.inputValue||""))return n.editorErrorMessage=n.inputErrorMessage||g("el.messagebox.error"),n.validateError=!0,!1;const $=n.inputValidator;if(typeof $=="function"){const D=$(n.inputValue);if(D===!1)return n.editorErrorMessage=n.inputErrorMessage||g("el.messagebox.error"),n.validateError=!0,!1;if(typeof D=="string")return n.editorErrorMessage=D,n.validateError=!0,!1}}return n.editorErrorMessage="",n.validateError=!1,!0},H=()=>{const I=a.value.$refs;return I.input||I.textarea},U=()=>{x("close")},V=()=>{e.closeOnPressEscape&&U()};return e.lockScroll&&Un(M),{...Cn(n),ns:i,overlayEvent:k,visible:M,hasMessage:_,typeClass:A,contentId:B,inputId:w,btnSize:l,iconComponent:R,confirmButtonClasses:r,rootRef:E,focusStartRef:S,headerRef:y,inputRef:a,confirmRef:m,doClose:p,handleClose:U,onCloseRequested:V,handleWrapperClick:v,handleInputEnter:b,handleAction:x,t:g}}}),Fn=["aria-label","aria-describedby"],Qn=["aria-label"],Jn=["id"];function Zn(e,t,o,s,i,l){const g=ae("el-icon"),C=ae("close"),M=ae("el-input"),n=ae("el-button"),A=ae("el-focus-trap"),B=ae("el-overlay");return j(),K(En,{name:"fade-in-linear",onAfterLeave:t[11]||(t[11]=w=>e.$emit("vanish")),persisted:""},{default:Y(()=>[Re(Q(B,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:Y(()=>[X("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:O(`${e.ns.namespace.value}-overlay-message-box`),onClick:t[8]||(t[8]=(...w)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...w)),onMousedown:t[9]||(t[9]=(...w)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...w)),onMouseup:t[10]||(t[10]=(...w)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...w))},[Q(A,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:Y(()=>[X("div",{ref:"rootRef",class:O([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:ft(e.customStyle),tabindex:"-1",onClick:t[7]||(t[7]=be(()=>{},["stop"]))},[e.title!==null&&e.title!==void 0?(j(),$e("div",{key:0,ref:"headerRef",class:O(e.ns.e("header"))},[X("div",{class:O(e.ns.e("title"))},[e.iconComponent&&e.center?(j(),K(g,{key:0,class:O([e.ns.e("status"),e.typeClass])},{default:Y(()=>[(j(),K(Ce(e.iconComponent)))]),_:1},8,["class"])):ie("v-if",!0),X("span",null,fe(e.title),1)],2),e.showClose?(j(),$e("button",{key:0,type:"button",class:O(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:t[0]||(t[0]=w=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:t[1]||(t[1]=Ee(be(w=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[Q(g,{class:O(e.ns.e("close"))},{default:Y(()=>[Q(C)]),_:1},8,["class"])],42,Qn)):ie("v-if",!0)],2)):ie("v-if",!0),X("div",{id:e.contentId,class:O(e.ns.e("content"))},[X("div",{class:O(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(j(),K(g,{key:0,class:O([e.ns.e("status"),e.typeClass])},{default:Y(()=>[(j(),K(Ce(e.iconComponent)))]),_:1},8,["class"])):ie("v-if",!0),e.hasMessage?(j(),$e("div",{key:1,class:O(e.ns.e("message"))},[je(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(j(),K(Ce(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(j(),K(Ce(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:Y(()=>[Le(fe(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):ie("v-if",!0)],2),Re(X("div",{class:O(e.ns.e("input"))},[Q(M,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":t[2]||(t[2]=w=>e.inputValue=w),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:O({invalid:e.validateError}),onKeydown:Ee(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),X("div",{class:O(e.ns.e("errormsg")),style:ft({visibility:e.editorErrorMessage?"visible":"hidden"})},fe(e.editorErrorMessage),7)],2),[[Oe,e.showInput]])],10,Jn),X("div",{class:O(e.ns.e("btns"))},[e.showCancelButton?(j(),K(n,{key:0,loading:e.cancelButtonLoading,class:O([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:t[3]||(t[3]=w=>e.handleAction("cancel")),onKeydown:t[4]||(t[4]=Ee(be(w=>e.handleAction("cancel"),["prevent"]),["enter"]))},{default:Y(()=>[Le(fe(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):ie("v-if",!0),Re(Q(n,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:O([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:t[5]||(t[5]=w=>e.handleAction("confirm")),onKeydown:t[6]||(t[6]=Ee(be(w=>e.handleAction("confirm"),["prevent"]),["enter"]))},{default:Y(()=>[Le(fe(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[Oe,e.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,Fn)]),_:3},8,["z-index","overlay-class","mask"]),[[Oe,e.visible]])]),_:3})}var eo=gn(Gn,[["render",Zn],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const ge=new Map,to=e=>{let t=document.body;return e.appendTo&&(_t(e.appendTo)&&(t=document.querySelector(e.appendTo)),vt(e.appendTo)&&(t=e.appendTo),vt(t)||(t=document.body)),t},no=(e,t,o=null)=>{const s=Q(eo,e,ht(e.message)||It(e.message)?{default:ht(e.message)?e.message:()=>e.message}:null);return s.appContext=o,Ht(s,t),to(e).appendChild(t.firstElementChild),s.component},oo=()=>document.createElement("div"),ro=(e,t)=>{const o=oo();e.onVanish=()=>{Ht(null,o),ge.delete(i)},e.onAction=l=>{const g=ge.get(i);let C;e.showInput?C={value:i.inputValue,action:l}:C=l,e.callback?e.callback(C,s.proxy):l==="cancel"||l==="close"?e.distinguishCancelAndClose&&l!=="cancel"?g.reject("close"):g.reject("cancel"):g.resolve(C)};const s=no(e,o,t),i=s.proxy;for(const l in e)dt(e,l)&&!dt(i.$props,l)&&(i[l]=e[l]);return i.visible=!0,i};function ue(e,t=null){if(!xt)return Promise.reject();let o;return _t(e)||It(e)?e={message:e}:o=e.callback,new Promise((s,i)=>{const l=ro(e,t??ue._context);ge.set(l,{options:e,callback:o,resolve:s,reject:i})})}const so=["alert","confirm","prompt"],ao={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};so.forEach(e=>{ue[e]=io(e)});function io(e){return(t,o,s,i)=>{let l="";return Sn(o)?(s=o,l=""):Bn(o)?l="":l=o,ue(Object.assign({title:l,message:t,type:"",...ao[e]},s,{boxType:e}),i)}}ue.close=()=>{ge.forEach((e,t)=>{t.doClose()}),ge.clear()};ue._context=null;const F=ue;F.install=e=>{F._context=e._context,e.config.globalProperties.$msgbox=F,e.config.globalProperties.$messageBox=F,e.config.globalProperties.$alert=F.alert,e.config.globalProperties.$confirm=F.confirm,e.config.globalProperties.$prompt=F.prompt};const Ne=F;var lo=Tn,co=An,uo=kn,fo={formats:uo,parse:co,stringify:lo};const ho=Ze(fo);async function J(e=0){return await new Promise((t,o)=>{setTimeout(()=>{try{window.scrollTo(0,document.body.scrollHeight),t(null)}catch(s){o(s)}},+e||0)})}const vo={get isMobileScreen(){return window.innerWidth<600},get isTouchScreen(){return"ontouchstart"in document||navigator.maxTouchPoints>0}};function wt(){return vo}const bt="web-browsing",Ct="temperature-suffix",De="temperature",Ie=e=>(e==null?void 0:e.toString)===void 0?"":e.toString(),mo=e=>Ie(e).toLowerCase(),Lt="01",Ot="0123456789",Nt="0123456789abcdef",Dt="0123456789abcdefghijklmnopqrstuvwxyz",zt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Ke=e=>{switch(typeof e!="string"&&(e=mo(e)),e){case"2":return Lt;case"10":return Ot;case"16":return Nt;case"36":return Dt;case"62":return zt;case"64":return oe;case"64w":case"64+":return Pt;default:return e}},po=(e,t,o,s=0)=>{typeof e!="string"&&(e=Ie(e));let i=BigInt(0);t=Ke(t);const l=t.length;for(let C=0;C<e.length;C++)i+=BigInt(t.indexOf(e[C])*Math.pow(l,e.length-1-C));let g="";if(o=Ke(o),g===""){const C=BigInt(o.length);for(;i>0;)g=o.charAt(+BigInt(i%C).toString())+g,i=BigInt(i/C)}return(g===""?o.charAt(0):g).padStart(s,o[0])},go=e=>{const t=e.split("").map(l=>l.charCodeAt(0)),o=[];let s=0;for(;s<t.length;){const[l,g=0,C=0]=t.slice(s,s+=3),M=(l<<16)+(g<<8)+C,n=M>>18,A=M>>12&63,B=M>>6&63,w=M&63;o.push(oe[n],oe[A],oe[B],oe[w])}const i=t.length%3;return o.join("").slice(0,1+o.length-i)+(i===2?"==":i===1?"=":"")},yo=/[^A-Za-z0-9+/]/g,Wt=e=>e.replace(yo,""),ze=e=>String.fromCharCode(+e),wo=e=>{const t=Wt(e).split(""),o=[];let s=0;for(;s<t.length;){const[i,l,g,C]=t.slice(s,s+=4).map(M=>oe.indexOf(M));o.push(ze(i<<2|l>>4)),g!==64&&o.push(ze((l&15)<<4|g>>2)),C!==64&&o.push(ze((g&3)<<6|C))}return o.join("").replaceAll("\0","")},ce={BASE2_CHARSET:Lt,BASE10_CHARSET:Ot,BASE16_CHARSET:Nt,BASE36_CHARSET:Dt,BASE62_CHARSET:zt,BASE64_CHARSET:oe,BASE64WEB_CHARSET:Pt,convert:po,getCharset:Ke,secureBase64:Wt,textToBase64:go,base64ToText:wo};var Ut={exports:{}};function bo(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Pe={exports:{}},Et;function et(){return Et||(Et=1,function(e,t){(function(o,s){e.exports=s()})(te,function(){var o=o||function(s,i){var l;if(typeof window<"u"&&window.crypto&&(l=window.crypto),typeof self<"u"&&self.crypto&&(l=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(l=globalThis.crypto),!l&&typeof window<"u"&&window.msCrypto&&(l=window.msCrypto),!l&&typeof te<"u"&&te.crypto&&(l=te.crypto),!l&&typeof bo=="function")try{l=xn}catch{}var g=function(){if(l){if(typeof l.getRandomValues=="function")try{return l.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof l.randomBytes=="function")try{return l.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function a(){}return function(m){var r;return a.prototype=m,r=new a,a.prototype=null,r}}(),M={},n=M.lib={},A=n.Base=function(){return{extend:function(a){var m=C(this);return a&&m.mixIn(a),(!m.hasOwnProperty("init")||this.init===m.init)&&(m.init=function(){m.$super.init.apply(this,arguments)}),m.init.prototype=m,m.$super=this,m},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var m in a)a.hasOwnProperty(m)&&(this[m]=a[m]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),B=n.WordArray=A.extend({init:function(a,m){a=this.words=a||[],m!=i?this.sigBytes=m:this.sigBytes=a.length*4},toString:function(a){return(a||R).stringify(this)},concat:function(a){var m=this.words,r=a.words,u=this.sigBytes,p=a.sigBytes;if(this.clamp(),u%4)for(var v=0;v<p;v++){var k=r[v>>>2]>>>24-v%4*8&255;m[u+v>>>2]|=k<<24-(u+v)%4*8}else for(var b=0;b<p;b+=4)m[u+b>>>2]=r[b>>>2];return this.sigBytes+=p,this},clamp:function(){var a=this.words,m=this.sigBytes;a[m>>>2]&=4294967295<<32-m%4*8,a.length=s.ceil(m/4)},clone:function(){var a=A.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var m=[],r=0;r<a;r+=4)m.push(g());return new B.init(m,a)}}),w=M.enc={},R=w.Hex={stringify:function(a){for(var m=a.words,r=a.sigBytes,u=[],p=0;p<r;p++){var v=m[p>>>2]>>>24-p%4*8&255;u.push((v>>>4).toString(16)),u.push((v&15).toString(16))}return u.join("")},parse:function(a){for(var m=a.length,r=[],u=0;u<m;u+=2)r[u>>>3]|=parseInt(a.substr(u,2),16)<<24-u%8*4;return new B.init(r,m/2)}},_=w.Latin1={stringify:function(a){for(var m=a.words,r=a.sigBytes,u=[],p=0;p<r;p++){var v=m[p>>>2]>>>24-p%4*8&255;u.push(String.fromCharCode(v))}return u.join("")},parse:function(a){for(var m=a.length,r=[],u=0;u<m;u++)r[u>>>2]|=(a.charCodeAt(u)&255)<<24-u%4*8;return new B.init(r,m)}},E=w.Utf8={stringify:function(a){try{return decodeURIComponent(escape(_.stringify(a)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(a){return _.parse(unescape(encodeURIComponent(a)))}},y=n.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=new B.init,this._nDataBytes=0},_append:function(a){typeof a=="string"&&(a=E.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(a){var m,r=this._data,u=r.words,p=r.sigBytes,v=this.blockSize,k=v*4,b=p/k;a?b=s.ceil(b):b=s.max((b|0)-this._minBufferSize,0);var x=b*v,T=s.min(x*4,p);if(x){for(var H=0;H<x;H+=v)this._doProcessBlock(u,H);m=u.splice(0,x),r.sigBytes-=T}return new B.init(m,T)},clone:function(){var a=A.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});n.Hasher=y.extend({cfg:A.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var m=this._doFinalize();return m},blockSize:16,_createHelper:function(a){return function(m,r){return new a.init(r).finalize(m)}},_createHmacHelper:function(a){return function(m,r){return new S.HMAC.init(a,r).finalize(m)}}});var S=M.algo={};return M}(Math);return o})}(Pe)),Pe.exports}var We={exports:{}},St;function Co(){return St||(St=1,function(e,t){(function(o,s){e.exports=s(et())})(te,function(o){return function(s){var i=o,l=i.lib,g=l.Base,C=l.WordArray,M=i.x64={};M.Word=g.extend({init:function(n,A){this.high=n,this.low=A}}),M.WordArray=g.extend({init:function(n,A){n=this.words=n||[],A!=s?this.sigBytes=A:this.sigBytes=n.length*8},toX32:function(){for(var n=this.words,A=n.length,B=[],w=0;w<A;w++){var R=n[w];B.push(R.high),B.push(R.low)}return C.create(B,this.sigBytes)},clone:function(){for(var n=g.clone.call(this),A=n.words=this.words.slice(0),B=A.length,w=0;w<B;w++)A[w]=A[w].clone();return n}})}(),o})}(We)),We.exports}(function(e,t){(function(o,s,i){e.exports=s(et(),Co())})(te,function(o){return function(s){var i=o,l=i.lib,g=l.WordArray,C=l.Hasher,M=i.x64,n=M.Word,A=i.algo,B=[],w=[],R=[];(function(){for(var y=1,S=0,a=0;a<24;a++){B[y+5*S]=(a+1)*(a+2)/2%64;var m=S%5,r=(2*y+3*S)%5;y=m,S=r}for(var y=0;y<5;y++)for(var S=0;S<5;S++)w[y+5*S]=S+(2*y+3*S)%5*5;for(var u=1,p=0;p<24;p++){for(var v=0,k=0,b=0;b<7;b++){if(u&1){var x=(1<<b)-1;x<32?k^=1<<x:v^=1<<x-32}u&128?u=u<<1^113:u<<=1}R[p]=n.create(v,k)}})();var _=[];(function(){for(var y=0;y<25;y++)_[y]=n.create()})();var E=A.SHA3=C.extend({cfg:C.cfg.extend({outputLength:512}),_doReset:function(){for(var y=this._state=[],S=0;S<25;S++)y[S]=new n.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(y,S){for(var a=this._state,m=this.blockSize/2,r=0;r<m;r++){var u=y[S+2*r],p=y[S+2*r+1];u=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,p=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360;var v=a[r];v.high^=p,v.low^=u}for(var k=0;k<24;k++){for(var b=0;b<5;b++){for(var x=0,T=0,H=0;H<5;H++){var v=a[b+5*H];x^=v.high,T^=v.low}var U=_[b];U.high=x,U.low=T}for(var b=0;b<5;b++)for(var V=_[(b+4)%5],I=_[(b+1)%5],$=I.high,D=I.low,x=V.high^($<<1|D>>>31),T=V.low^(D<<1|$>>>31),H=0;H<5;H++){var v=a[b+5*H];v.high^=x,v.low^=T}for(var L=1;L<25;L++){var x,T,v=a[L],q=v.high,W=v.low,c=B[L];c<32?(x=q<<c|W>>>32-c,T=W<<c|q>>>32-c):(x=W<<c-32|q>>>64-c,T=q<<c-32|W>>>64-c);var f=_[w[L]];f.high=x,f.low=T}var d=_[0],h=a[0];d.high=h.high,d.low=h.low;for(var b=0;b<5;b++)for(var H=0;H<5;H++){var L=b+5*H,v=a[L],nt=_[L],ot=_[(b+1)%5+5*H],rt=_[(b+2)%5+5*H];v.high=nt.high^~ot.high&rt.high,v.low=nt.low^~ot.low&rt.low}var v=a[0],st=R[k];v.high^=st.high,v.low^=st.low}},_doFinalize:function(){var y=this._data,S=y.words;this._nDataBytes*8;var a=y.sigBytes*8,m=this.blockSize*32;S[a>>>5]|=1<<24-a%32,S[(s.ceil((a+1)/m)*m>>>5)-1]|=128,y.sigBytes=S.length*4,this._process();for(var r=this._state,u=this.cfg.outputLength/8,p=u/8,v=[],k=0;k<p;k++){var b=r[k],x=b.high,T=b.low;x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,v.push(T),v.push(x)}return new g.init(v,u)},clone:function(){for(var y=C.clone.call(this),S=y._state=this._state.slice(0),a=0;a<25;a++)S[a]=S[a].clone();return y}});i.SHA3=C._createHelper(E),i.HmacSHA3=C._createHmacHelper(E)}(Math),o.SHA3})})(Ut);var Eo=Ut.exports;const Vt=Ze(Eo);function So(...e){return e.reduce((t,o)=>t+o,0)}function Bo(e){try{return typeof e[Symbol==null?void 0:Symbol.iterator]=="function"}catch{return!1}}function qt(e){const t=new Set;return JSON.stringify(e,(s,i)=>{if(typeof i=="object"&&i!==null){if(t.has(i))return;t.add(i),Bo(i)&&(i=[...i])}return i})}const To=e=>Vt(e,{outputLength:256}).toString(),Ao=/0b[0-1]+/i;function ye(e){if(typeof e=="number")return Math.round(e);if(e instanceof Object&&(e=qt(e)),typeof e=="string"){if(Ao.test(e))return parseInt(e.substring(2,e.length-1),2);const t=parseInt(e);return Number.isNaN(t)?t:So(parseInt(To(e),16))}else return Date.now()}const N=624,Be=397,ko=2567483615,Ue=2147483648,Ve=2147483647;class xo{constructor(t){we(this,"mt",new Array(N));we(this,"mti",N+1);we(this,"seed");return this.seed=t=ye(t),Array.isArray(t)?this.init_by_array(t,t.length):this.init_seed(t),this}init_seed(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<N;this.mti++)t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(((t&4294901760)>>>16)*1812433253<<16)+(t&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}init_by_array(t,o){let s,i,l;for(this.init_seed(19650218),s=1,i=0,l=N>o?N:o;l!==0;l--){const g=this.mt[s-1]^this.mt[s-1]>>>30;this.mt[s]=(this.mt[s]^(((g&4294901760)>>>16)*1664525<<16)+(g&65535)*1664525)+t[i]+i,this.mt[s]>>>=0,s++,i++,s>=N&&(this.mt[0]=this.mt[N-1],s=1),i>=o&&(i=0)}for(l=N-1;l!==0;l--){const g=this.mt[s-1]^this.mt[s-1]>>>30;this.mt[s]=(this.mt[s]^(((g&4294901760)>>>16)*1566083941<<16)+(g&65535)*1566083941)-s,this.mt[s]>>>=0,s++,s>=N&&(this.mt[0]=this.mt[N-1],s=1)}this.mt[0]=2147483648}random_int(){let t;const o=new Array(0,ko);if(this.mti>=N){let s;for(this.mti===N+1&&this.init_seed(5489),s=0;s<N-Be;s++)t=this.mt[s]&Ue|this.mt[s+1]&Ve,this.mt[s]=this.mt[s+Be]^t>>>1^o[t&1];for(;s<N-1;s++)t=this.mt[s]&Ue|this.mt[s+1]&Ve,this.mt[s]=this.mt[s+(Be-N)]^t>>>1^o[t&1];t=this.mt[N-1]&Ue|this.mt[0]&Ve,this.mt[N-1]=this.mt[Be-1]^t>>>1^o[t&1],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,t^=t>>>18,t>>>0}random_int31(){return this.random_int()>>>1}random_incl(){return this.random_int()*(1/4294967295)}random(){return this.random_int()*(1/4294967296)}random_excl(){return(this.random_int()+.5)*(1/4294967296)}random_long(){return((this.random_int()>>>5)*67108864+(this.random_int()>>>6))*(1/9007199254740992)}}function jt(e){return new xo(e)}const{BASE10_CHARSET:Mo,BASE16_CHARSET:_o,BASE64WEB_CHARSET:Io}=ce,Ho=jt(),Yt=(e=Ho)=>e.random(),tt=(e,t,o)=>((t===void 0||t===0)&&(t=e,e=0),Math.floor(e+Yt(o)*t)),Xt=(e,t)=>e[tt(0,e.length,t)],Kt=(e,t=1,o)=>{const s=[],i=[];for(let l=0;l<t;l++)i.length===0&&i.push(...e),s.push(i.splice(tt(0,i.length,o),1)[0]);return s},Ro=(e,t)=>Kt(e,e.length,t),Te=(e,t=8,o)=>new Array(t).fill(0).map(s=>Xt(e,o)).join(""),Gt={MT:jt,toSeed:ye,rand:Yt,randInt:tt,charset:Te,choice:Xt,choices:Kt,shuffle:Ro,base10:(e=6,t)=>Te(Mo,e,t),base16:(e=32,t)=>Te(_o,e,t),base64:(e=32,t)=>Te(Io,e,t),lcg(e){let t=ye(e);return()=>(t=(t*1664525+1013904223)%4294967296)/4294967296}};var Ft={exports:{}};(function(e,t){(function(o,s){e.exports=s(et())})(te,function(o){return function(s){var i=o,l=i.lib,g=l.WordArray,C=l.Hasher,M=i.algo,n=[];(function(){for(var E=0;E<64;E++)n[E]=s.abs(s.sin(E+1))*4294967296|0})();var A=M.MD5=C.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(E,y){for(var S=0;S<16;S++){var a=y+S,m=E[a];E[a]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}var r=this._hash.words,u=E[y+0],p=E[y+1],v=E[y+2],k=E[y+3],b=E[y+4],x=E[y+5],T=E[y+6],H=E[y+7],U=E[y+8],V=E[y+9],I=E[y+10],$=E[y+11],D=E[y+12],L=E[y+13],q=E[y+14],W=E[y+15],c=r[0],f=r[1],d=r[2],h=r[3];c=B(c,f,d,h,u,7,n[0]),h=B(h,c,f,d,p,12,n[1]),d=B(d,h,c,f,v,17,n[2]),f=B(f,d,h,c,k,22,n[3]),c=B(c,f,d,h,b,7,n[4]),h=B(h,c,f,d,x,12,n[5]),d=B(d,h,c,f,T,17,n[6]),f=B(f,d,h,c,H,22,n[7]),c=B(c,f,d,h,U,7,n[8]),h=B(h,c,f,d,V,12,n[9]),d=B(d,h,c,f,I,17,n[10]),f=B(f,d,h,c,$,22,n[11]),c=B(c,f,d,h,D,7,n[12]),h=B(h,c,f,d,L,12,n[13]),d=B(d,h,c,f,q,17,n[14]),f=B(f,d,h,c,W,22,n[15]),c=w(c,f,d,h,p,5,n[16]),h=w(h,c,f,d,T,9,n[17]),d=w(d,h,c,f,$,14,n[18]),f=w(f,d,h,c,u,20,n[19]),c=w(c,f,d,h,x,5,n[20]),h=w(h,c,f,d,I,9,n[21]),d=w(d,h,c,f,W,14,n[22]),f=w(f,d,h,c,b,20,n[23]),c=w(c,f,d,h,V,5,n[24]),h=w(h,c,f,d,q,9,n[25]),d=w(d,h,c,f,k,14,n[26]),f=w(f,d,h,c,U,20,n[27]),c=w(c,f,d,h,L,5,n[28]),h=w(h,c,f,d,v,9,n[29]),d=w(d,h,c,f,H,14,n[30]),f=w(f,d,h,c,D,20,n[31]),c=R(c,f,d,h,x,4,n[32]),h=R(h,c,f,d,U,11,n[33]),d=R(d,h,c,f,$,16,n[34]),f=R(f,d,h,c,q,23,n[35]),c=R(c,f,d,h,p,4,n[36]),h=R(h,c,f,d,b,11,n[37]),d=R(d,h,c,f,H,16,n[38]),f=R(f,d,h,c,I,23,n[39]),c=R(c,f,d,h,L,4,n[40]),h=R(h,c,f,d,u,11,n[41]),d=R(d,h,c,f,k,16,n[42]),f=R(f,d,h,c,T,23,n[43]),c=R(c,f,d,h,V,4,n[44]),h=R(h,c,f,d,D,11,n[45]),d=R(d,h,c,f,W,16,n[46]),f=R(f,d,h,c,v,23,n[47]),c=_(c,f,d,h,u,6,n[48]),h=_(h,c,f,d,H,10,n[49]),d=_(d,h,c,f,q,15,n[50]),f=_(f,d,h,c,x,21,n[51]),c=_(c,f,d,h,D,6,n[52]),h=_(h,c,f,d,k,10,n[53]),d=_(d,h,c,f,I,15,n[54]),f=_(f,d,h,c,p,21,n[55]),c=_(c,f,d,h,U,6,n[56]),h=_(h,c,f,d,W,10,n[57]),d=_(d,h,c,f,T,15,n[58]),f=_(f,d,h,c,L,21,n[59]),c=_(c,f,d,h,b,6,n[60]),h=_(h,c,f,d,$,10,n[61]),d=_(d,h,c,f,v,15,n[62]),f=_(f,d,h,c,V,21,n[63]),r[0]=r[0]+c|0,r[1]=r[1]+f|0,r[2]=r[2]+d|0,r[3]=r[3]+h|0},_doFinalize:function(){var E=this._data,y=E.words,S=this._nDataBytes*8,a=E.sigBytes*8;y[a>>>5]|=128<<24-a%32;var m=s.floor(S/4294967296),r=S;y[(a+64>>>9<<4)+15]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,y[(a+64>>>9<<4)+14]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360,E.sigBytes=(y.length+1)*4,this._process();for(var u=this._hash,p=u.words,v=0;v<4;v++){var k=p[v];p[v]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return u},clone:function(){var E=C.clone.call(this);return E._hash=this._hash.clone(),E}});function B(E,y,S,a,m,r,u){var p=E+(y&S|~y&a)+m+u;return(p<<r|p>>>32-r)+y}function w(E,y,S,a,m,r,u){var p=E+(y&a|S&~a)+m+u;return(p<<r|p>>>32-r)+y}function R(E,y,S,a,m,r,u){var p=E+(y^S^a)+m+u;return(p<<r|p>>>32-r)+y}function _(E,y,S,a,m,r,u){var p=E+(S^(y|~a))+m+u;return(p<<r|p>>>32-r)+y}i.MD5=C._createHelper(A),i.HmacMD5=C._createHmacHelper(A)}(Math),o.MD5})})(Ft);var $o=Ft.exports;const Lo=Ze($o),{MT:_e,shuffle:Oo,randInt:xe}=Gt,{convert:Qt,getCharset:Jt}=ce,Zt=(e,t)=>{const o=Oo(e,t);return()=>(o.push(o.shift()),o)},en=(e,t=16,o=1,s)=>{const i=Number.isNaN(+t)?64:+t,l=Jt(t),g=ye(s!==void 0?s:xe(0,i)),C=_e(g),M=Zt(l,_e(xe(0,1e6,C))),n=typeof e=="string"?e.split(""):e,A=[s!==void 0?l[xe(0,i)]:Qt(g,10,t),...n.map(B=>M()[l.indexOf(B)])];return--o<1?A.join(""):en(A,t,o,s)},tn=(e,t=16,o=1,s)=>{const i=Jt(t),l=ye(s!==void 0?s:+Qt(e[0],t,10)),g=_e(l),C=Zt(i,_e(xe(0,1e6,g))),n=(typeof e=="string"?e.split(""):e).slice(1,e.length).map(A=>i[C().indexOf(A)]);return--o<1?n.join(""):tn(n,t,o,s)},{textToBase64:No,base64ToText:Do,secureBase64:zo}=ce;function nn(e,t=1,o){return typeof e=="object"?e=qt(e):typeof e!="string"&&(e=Ie(e)),en(zo(No(e)),64,t,o)}function Po(e,t=1,o,s=!0){if(e=Do(tn(e,64,t,o)),!s)return e;try{return JSON.parse(e)}catch{return e}}function Wo(e,t=512,o){const s=nn(e,1,o).substring(1);return t==="MD5"?Lo(s).toString():Vt(s,{outputLength:t}).toString()}const Uo={e:nn,d:Po,h:Wo},Vo=new Map([["THINKING","Please wait, I am answering another question..."]]);function qo(e,t){switch(e){case"model":if(["gpt3","gpt4","gpt-web-1","gpt-web-2"].includes(t))return!0;break;case"temperature":if(typeof t=="number"&&t>=0&&t<=1)return!0;break;case"context":if(typeof t=="boolean")return!0;break}return!1}function jo(e){try{return JSON.parse(e)}catch{return e}}function Yo(e){try{const t={};for(const o in e){const s=jo(e[o]);qo(o,s)&&(t[o]=s)}return t}catch{return{}}}function Xo(e){try{return ho.stringify(Yo(e))}catch{return""}}const Ko=4e3,Go=()=>{if(!Fe.value)return"";const e=z.value.filter(o=>o.done).map(o=>(o.Q?`Question:
${o.Q}`:"")+(o.Q&&o.A?`

`:"")+(o.A?`Answer:
${o.A}`:""));for(;e.length>1&&e.slice(1,e.length).join("").length>Ko;)e.shift();const t=e.join(`
---
`);return t.length===0?"":(e.push(),`Conversation History
===
${t}`)},z=P([]),re=P([]),de=()=>{try{document.querySelector(".InputBox textarea").focus()}catch{}},Ae=()=>new Promise((e,t)=>{$fetch("/api/curva/check",{method:"POST"}).then(o=>{const{list:s,named:i}=o;re.value=s.sort().map(l=>({id:l,name:i[l]})),e(!0)}).catch(o=>{G.error("Initialization Failed"),t(o)})}),Fo=e=>new Promise(async(t,o)=>{if(e==null)return t([]);const s=await $fetch("/api/curva/history",{method:"POST",body:{id:e}});(!s||s.length===0)&&Me("/c/");try{t(s.map(i=>Je({...i,t:new Date(i.t),done:!!i.A})))}catch{Me("/c/"),t([])}}),on=async function(e){return await $fetch("/api/curva/suggestions",{method:"POST",body:{question:e}})},Qo=async()=>{try{const e=z.value.at(-1),t=await on(e.Q),o=Ye()>=document.body.clientHeight;e.more=t,o&&J()}catch(e){console.error(e)}},Ge=P("gpt4"),Fe=P(!0),le=P(.5),Z=P(!1),he=P(Z.value),ve=P(Z.value),me=P(""),Jo=(()=>{const{h:e}=Uo,t=()=>[77,68,53].map(i=>String.fromCharCode(i)).join(""),o=(i,l,g)=>({hash:e(`${i}${l}`,t(),g),timestamp:Ie(g)}),s=(i,l,g,C,M,n)=>{var B,w;let A=(w=(B=Rt()._route)==null?void 0:B.params)==null?void 0:w.conv;return A||(A=Gt.base64(8),re.value.push({id:A,name:void 0}),Me(`/c/${A}?feature=new`)),{conv:A,context:Go(),prompt:i,model:l,temperature:g,t:C,tz:M,id:n}};return(i,l)=>{const g=new Date,C=g.getTime(),M=g.getTimezoneOffset()/60*-1,n=s(i,Ge.value,le.value,C,M,l),A=o(i,n.context,C);return $fetch("/api/curva/answer",{method:"POST",headers:A,body:n})}})(),Zo=(e="",t="",o=!1)=>Je({done:o,Q:e,A:t,queries:[],urls:[],dt:void 0,t:new Date});let qe=new Set;const er=()=>{re.value=[],z.value=[],Me("/c/"),Qe=!0};let Qe=!0;function Bt(){{const e=In();e.get("feature")==="new"&&(e.delete("feature"),e.save())}}function lr(){const e=mt("appName").value,t=Mn(),o=+(t.has(De)?t.get(De):.5);t.delete(bt,{path:"/"}),t.delete(bt),t.delete(Ct,{path:"/"}),t.delete(Ct),o>=0&&o<=1&&(le.value=o),ee(le,r=>{le.value=Math.round(r*10)/10,t.set(De,`${r}`,{path:"/"})});const s=Rt(),i=()=>{var r,u;return(u=(r=s._route)==null?void 0:r.params)==null?void 0:u.conv},l=()=>{const r=i();return re.value.filter(u=>u.id===r)[0].name||""};ee(Z,r=>{wt().isMobileScreen?(he.value=!1,ve.value!==r&&(ve.value=r)):(ve.value=!1,he.value!==r&&(he.value=r)),setTimeout(()=>{try{de()}catch{}},0)}),ee(ve,r=>{Z.value=r}),ee(he,r=>{Z.value=r});const g=async r=>{wt().isMobileScreen&&(Z.value=!1),z.value=[];const u=pt.service();try{const v=(await Promise.all([r===null&&re.value.length>0?null:Ae(),r===null?null:Fo(r)]))[1];v!==null&&i()===r&&(z.value=v,Qo())}finally{try{Se(`${l()||"Chat"} - ${e}`)}catch{Se(`Chat - ${e}`)}if(J(),u!==null)try{await J(500)}finally{u.close();try{await J(500)}finally{}}}setTimeout(()=>de(),500)},C=async(r,u=!1)=>{const p=Promise.all([...qe]),v=Qe&&u?new Promise(async k=>{await g(r),Bt(),k(null)}):u?new Promise(k=>k(null)):g(r);Qe=!1,qe.add(v);try{await p}catch{}try{await v}finally{qe.delete(v)}};async function M(r,u){return await $fetch("/api/curva/conv",{method:"PUT",body:{id:r||i(),name:u||l(),config:Xo({model:Ge.value,temperature:le.value,context:Fe.value})}})}const n=_n().t,A=mt("version"),B=(r,u)=>{if(document.querySelectorAll(".Message.T").length>0)return G.info("Thinking too many questions."),!1;const v=r===void 0?me.value:r,k=v.trim();if(v===me.value&&(me.value="",k===""))return!1;const b=Zo(k,"",!1);z.value.push(b),J(),setTimeout(()=>{de()},500);const x=on(k);return Jo(k,u).then(T=>{Bt();const H=Ye()>=document.body.clientHeight,U=T.id,V=T.answer,I=T.error,$=T.urls,D=T.queries,L=T.dt,q=T.version;if(!V){if(I){const W=z.value.indexOf(b);switch(I){case"THINKING":z.value.splice(W,1),G.warning(Vo.get(I)),me.value=k;return;default:throw I}}throw n("error.plzRefresh")}b.id=U,b.A=V,b.urls=$||[],b.queries=D||[],b.dt=L||void 0,q!==A.value&&Ne.confirm(n("action.newVersion"),n("message.notice"),{confirmButtonText:n("message.ok"),cancelButtonText:n("message.cancel"),type:"warning"}).then(()=>{location.reload()}).finally(()=>{de()}),H&&J(),x.then(W=>{const c=Ye()>=document.body.clientHeight;b.more=W,c&&J()}).catch(()=>{})}).catch(T=>{G.error(T||"Oops! Something went wrong!"),b.A="Oops! Something went wrong!"}).finally(()=>{b.done=!0,b.t=new Date}),!0},w=async()=>{const r=z.value.pop();r!==void 0&&(B(r.Q,r.id)||z.value.push(r))},R=r=>{z.value=z.value.filter(u=>u.id!==r),$fetch("/api/curva/answer",{method:"DELETE",body:{conv:i(),id:r}}).then(()=>G.info("The message has been deleted.")).catch(()=>G.error("An error occurred while deleting the message."))},_=()=>{C(i())},E=(r,u="")=>{r||(r=i(),u=l()),Ne.prompt(n("message.renameConvHint"),n("message.setting"),{confirmButtonText:n("message.ok"),cancelButtonText:n("message.cancel"),inputValue:u,inputPlaceholder:ce.convert(r,"64w",10)}).then(async({value:p})=>{try{await M(r,p),G({type:"success",message:n("message.renameSuccess")}),await Ae();try{Se(`${l()||"Chat"} - ${e}`)}catch{Se(`Chat - ${e}`)}}catch{G({type:"error",message:"Oops! Something went wrong!"})}}).catch(()=>{})},y=r=>{var b,x;const u=r||i(),p=[...re.value];let v=-1,k="createNewChat";for(let T=0;T<p.length;T++)if(p[T].id===u){v=T;break}if(v!==-1){const T=(b=p[v-1])==null?void 0:b.id,H=(x=p[v+1])==null?void 0:x.id;T!==void 0?k=T:H!==void 0&&(k=H)}Ne.confirm(n("message.deleteConvConfirm"),n("message.warning"),{confirmButtonText:n("message.ok"),cancelButtonText:n("message.cancel"),type:"warning"}).then(()=>{const T=pt.service();$fetch("/api/curva/conv",{method:"DELETE",body:{id:u}}).finally(async()=>{var H;T.close(),r===i()?(H=document.getElementById(k))==null||H.click():await Ae()})})},S=(r,u)=>{const p=document.createElement("a");p.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(u)),p.setAttribute("download",r),p.style.display="none",document.body.appendChild(p),p.click(),p.remove()};return{model:Ge,conversations:re,messages:z,temperature:le,contextMode:Fe,openMenu:Z,openSidebar:he,openDrawer:ve,inputValue:me,getCurrentConvId:i,getCurrentConvName:l,checkTokenAndGetConversations:Ae,loadChat:C,sendMessage:B,deleteMessage:R,regenerateMessage:w,focusInput:de,refreshConversation:_,renameConversation:E,deleteConversation:y,exportAsMarkdown:()=>{let r=0;const u=`${ce.convert(i(),"64w",10)}.md`,p=z.value.map(v=>{r++;try{return(v.t?`${new Date(v.t.getTime()-(v.dt||0)).toLocaleString()}${v.dt===void 0?"":" (Δt: "+v.dt.toString()+"ms)"}

`:"")+(v.Q?`QUESTION ${r}:

${v.Q.replaceAll(`
`,`

`)}`:"")+(v.Q&&v.A?`

`:"")+(v.A?`ANSWER ${r}:

${v.A}`:"")}catch{return"(Unknown message)"}}).join(`

---

`)+`

---

`;S(u,p)},exportAsJson:()=>{S(`${ce.convert(i(),"64w",10)}.json`,JSON.stringify(z.value.map(r=>({question:r.Q,answer:r.A,created:new Date(r.t.getTime()).toUTCString(),timeUsed:r.dt||void 0,queries:r.queries||void 0,urls:r.urls||void 0})),null,4))},clear:er}}export{Ne as E,Wn as a,Un as b,Kn as c,$t as d,ce as e,wt as f,Gt as r,Ie as s,lr as u};
