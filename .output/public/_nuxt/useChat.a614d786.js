var Ce=Object.defineProperty;var Te=(t,e,o)=>e in t?Ce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var at=(t,e,o)=>(Te(t,typeof e!="symbol"?e+"":e,o),o);import{ce as kt,cf as be,cg as Be,ch as Ae,ci as Ee,cj as J,r as D,h as nt,aa as Vt,W as ke,E as q,i as zt,ck as He,D as Re,g as Ie,A as ht,cl as bt,V as X,z as mt,l as Xt,cm as We}from"./entry.53b65866.js";import{E as gt}from"./el-overlay.d859ddb6.js";import"./el-button.d0d903a6.js";import"./el-input.391afb4d.js";import{u as Oe}from"./useAuth.f8bad6e4.js";import{u as Nt}from"./useTitle.829e3219.js";var $e=be,Pe=Be,Le=Ae,De={formats:Le,parse:Pe,stringify:$e};const Kt=kt(De),qe={get isMobileScreen(){return window.innerWidth<600},get isTouchScreen(){return"ontouchstart"in document||navigator.maxTouchPoints>0}};function vt(){return qe}var Jt={exports:{}};function ze(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yt={exports:{}},Mt;function Ht(){return Mt||(Mt=1,function(t,e){(function(o,r){t.exports=r()})(J,function(){var o=o||function(r,h){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),typeof self<"u"&&self.crypto&&(m=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(m=globalThis.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof J<"u"&&J.crypto&&(m=J.crypto),!m&&typeof ze=="function")try{m=Ee}catch{}var g=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},E=Object.create||function(){function n(){}return function(l){var v;return n.prototype=l,v=new n,n.prototype=null,v}}(),k={},a=k.lib={},T=a.Base=function(){return{extend:function(n){var l=E(this);return n&&l.mixIn(n),(!l.hasOwnProperty("init")||this.init===l.init)&&(l.init=function(){l.$super.init.apply(this,arguments)}),l.init.prototype=l,l.$super=this,l},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var l in n)n.hasOwnProperty(l)&&(this[l]=n[l]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),b=a.WordArray=T.extend({init:function(n,l){n=this.words=n||[],l!=h?this.sigBytes=l:this.sigBytes=n.length*4},toString:function(n){return(n||w).stringify(this)},concat:function(n){var l=this.words,v=n.words,p=this.sigBytes,_=n.sigBytes;if(this.clamp(),p%4)for(var x=0;x<_;x++){var H=v[x>>>2]>>>24-x%4*8&255;l[p+x>>>2]|=H<<24-(p+x)%4*8}else for(var C=0;C<_;C+=4)l[p+C>>>2]=v[C>>>2];return this.sigBytes+=_,this},clamp:function(){var n=this.words,l=this.sigBytes;n[l>>>2]&=4294967295<<32-l%4*8,n.length=r.ceil(l/4)},clone:function(){var n=T.clone.call(this);return n.words=this.words.slice(0),n},random:function(n){for(var l=[],v=0;v<n;v+=4)l.push(g());return new b.init(l,n)}}),B=k.enc={},w=B.Hex={stringify:function(n){for(var l=n.words,v=n.sigBytes,p=[],_=0;_<v;_++){var x=l[_>>>2]>>>24-_%4*8&255;p.push((x>>>4).toString(16)),p.push((x&15).toString(16))}return p.join("")},parse:function(n){for(var l=n.length,v=[],p=0;p<l;p+=2)v[p>>>3]|=parseInt(n.substr(p,2),16)<<24-p%8*4;return new b.init(v,l/2)}},S=B.Latin1={stringify:function(n){for(var l=n.words,v=n.sigBytes,p=[],_=0;_<v;_++){var x=l[_>>>2]>>>24-_%4*8&255;p.push(String.fromCharCode(x))}return p.join("")},parse:function(n){for(var l=n.length,v=[],p=0;p<l;p++)v[p>>>2]|=(n.charCodeAt(p)&255)<<24-p%4*8;return new b.init(v,l)}},y=B.Utf8={stringify:function(n){try{return decodeURIComponent(escape(S.stringify(n)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(n){return S.parse(unescape(encodeURIComponent(n)))}},f=a.BufferedBlockAlgorithm=T.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(n){typeof n=="string"&&(n=y.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(n){var l,v=this._data,p=v.words,_=v.sigBytes,x=this.blockSize,H=x*4,C=_/H;n?C=r.ceil(C):C=r.max((C|0)-this._minBufferSize,0);var A=C*x,R=r.min(A*4,_);if(A){for(var I=0;I<A;I+=x)this._doProcessBlock(p,I);l=p.splice(0,A),v.sigBytes-=R}return new b.init(l,R)},clone:function(){var n=T.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0});a.Hasher=f.extend({cfg:T.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){n&&this._append(n);var l=this._doFinalize();return l},blockSize:16,_createHelper:function(n){return function(l,v){return new n.init(v).finalize(l)}},_createHmacHelper:function(n){return function(l,v){return new d.HMAC.init(n,v).finalize(l)}}});var d=k.algo={};return k}(Math);return o})}(yt)),yt.exports}var wt={exports:{}},Ft;function Ne(){return Ft||(Ft=1,function(t,e){(function(o,r){t.exports=r(Ht())})(J,function(o){return function(r){var h=o,m=h.lib,g=m.Base,E=m.WordArray,k=h.x64={};k.Word=g.extend({init:function(a,T){this.high=a,this.low=T}}),k.WordArray=g.extend({init:function(a,T){a=this.words=a||[],T!=r?this.sigBytes=T:this.sigBytes=a.length*8},toX32:function(){for(var a=this.words,T=a.length,b=[],B=0;B<T;B++){var w=a[B];b.push(w.high),b.push(w.low)}return E.create(b,this.sigBytes)},clone:function(){for(var a=g.clone.call(this),T=a.words=this.words.slice(0),b=T.length,B=0;B<b;B++)T[B]=T[B].clone();return a}})}(),o})}(wt)),wt.exports}(function(t,e){(function(o,r,h){t.exports=r(Ht(),Ne())})(J,function(o){return function(r){var h=o,m=h.lib,g=m.WordArray,E=m.Hasher,k=h.x64,a=k.Word,T=h.algo,b=[],B=[],w=[];(function(){for(var f=1,d=0,n=0;n<24;n++){b[f+5*d]=(n+1)*(n+2)/2%64;var l=d%5,v=(2*f+3*d)%5;f=l,d=v}for(var f=0;f<5;f++)for(var d=0;d<5;d++)B[f+5*d]=d+(2*f+3*d)%5*5;for(var p=1,_=0;_<24;_++){for(var x=0,H=0,C=0;C<7;C++){if(p&1){var A=(1<<C)-1;A<32?H^=1<<A:x^=1<<A-32}p&128?p=p<<1^113:p<<=1}w[_]=a.create(x,H)}})();var S=[];(function(){for(var f=0;f<25;f++)S[f]=a.create()})();var y=T.SHA3=E.extend({cfg:E.cfg.extend({outputLength:512}),_doReset:function(){for(var f=this._state=[],d=0;d<25;d++)f[d]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(f,d){for(var n=this._state,l=this.blockSize/2,v=0;v<l;v++){var p=f[d+2*v],_=f[d+2*v+1];p=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360;var x=n[v];x.high^=_,x.low^=p}for(var H=0;H<24;H++){for(var C=0;C<5;C++){for(var A=0,R=0,I=0;I<5;I++){var x=n[C+5*I];A^=x.high,R^=x.low}var G=S[C];G.high=A,G.low=R}for(var C=0;C<5;C++)for(var j=S[(C+4)%5],Q=S[(C+1)%5],W=Q.high,N=Q.low,A=j.high^(W<<1|N>>>31),R=j.low^(N<<1|W>>>31),I=0;I<5;I++){var x=n[C+5*I];x.high^=A,x.low^=R}for(var L=1;L<25;L++){var A,R,x=n[L],M=x.high,F=x.low,s=b[L];s<32?(A=M<<s|F>>>32-s,R=F<<s|M>>>32-s):(A=F<<s-32|M>>>64-s,R=M<<s-32|F>>>64-s);var c=S[B[L]];c.high=A,c.low=R}var u=S[0],i=n[0];u.high=i.high,u.low=i.low;for(var C=0;C<5;C++)for(var I=0;I<5;I++){var L=C+5*I,x=n[L],ot=S[L],rt=S[(C+1)%5+5*I],Dt=S[(C+2)%5+5*I];x.high=ot.high^~rt.high&Dt.high,x.low=ot.low^~rt.low&Dt.low}var x=n[0],qt=w[H];x.high^=qt.high,x.low^=qt.low}},_doFinalize:function(){var f=this._data,d=f.words;this._nDataBytes*8;var n=f.sigBytes*8,l=this.blockSize*32;d[n>>>5]|=1<<24-n%32,d[(r.ceil((n+1)/l)*l>>>5)-1]|=128,f.sigBytes=d.length*4,this._process();for(var v=this._state,p=this.cfg.outputLength/8,_=p/8,x=[],H=0;H<_;H++){var C=v[H],A=C.high,R=C.low;A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,x.push(R),x.push(A)}return new g.init(x,p)},clone:function(){for(var f=E.clone.call(this),d=f._state=this._state.slice(0),n=0;n<25;n++)d[n]=d[n].clone();return f}});h.SHA3=E._createHelper(y),h.HmacSHA3=E._createHmacHelper(y)}(Math),o.SHA3})})(Jt);var Me=Jt.exports;const Yt=kt(Me);var Zt={exports:{}};(function(t,e){(function(o,r){t.exports=r(Ht())})(J,function(o){return function(r){var h=o,m=h.lib,g=m.WordArray,E=m.Hasher,k=h.algo,a=[];(function(){for(var y=0;y<64;y++)a[y]=r.abs(r.sin(y+1))*4294967296|0})();var T=k.MD5=E.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,f){for(var d=0;d<16;d++){var n=f+d,l=y[n];y[n]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}var v=this._hash.words,p=y[f+0],_=y[f+1],x=y[f+2],H=y[f+3],C=y[f+4],A=y[f+5],R=y[f+6],I=y[f+7],G=y[f+8],j=y[f+9],Q=y[f+10],W=y[f+11],N=y[f+12],L=y[f+13],M=y[f+14],F=y[f+15],s=v[0],c=v[1],u=v[2],i=v[3];s=b(s,c,u,i,p,7,a[0]),i=b(i,s,c,u,_,12,a[1]),u=b(u,i,s,c,x,17,a[2]),c=b(c,u,i,s,H,22,a[3]),s=b(s,c,u,i,C,7,a[4]),i=b(i,s,c,u,A,12,a[5]),u=b(u,i,s,c,R,17,a[6]),c=b(c,u,i,s,I,22,a[7]),s=b(s,c,u,i,G,7,a[8]),i=b(i,s,c,u,j,12,a[9]),u=b(u,i,s,c,Q,17,a[10]),c=b(c,u,i,s,W,22,a[11]),s=b(s,c,u,i,N,7,a[12]),i=b(i,s,c,u,L,12,a[13]),u=b(u,i,s,c,M,17,a[14]),c=b(c,u,i,s,F,22,a[15]),s=B(s,c,u,i,_,5,a[16]),i=B(i,s,c,u,R,9,a[17]),u=B(u,i,s,c,W,14,a[18]),c=B(c,u,i,s,p,20,a[19]),s=B(s,c,u,i,A,5,a[20]),i=B(i,s,c,u,Q,9,a[21]),u=B(u,i,s,c,F,14,a[22]),c=B(c,u,i,s,C,20,a[23]),s=B(s,c,u,i,j,5,a[24]),i=B(i,s,c,u,M,9,a[25]),u=B(u,i,s,c,H,14,a[26]),c=B(c,u,i,s,G,20,a[27]),s=B(s,c,u,i,L,5,a[28]),i=B(i,s,c,u,x,9,a[29]),u=B(u,i,s,c,I,14,a[30]),c=B(c,u,i,s,N,20,a[31]),s=w(s,c,u,i,A,4,a[32]),i=w(i,s,c,u,G,11,a[33]),u=w(u,i,s,c,W,16,a[34]),c=w(c,u,i,s,M,23,a[35]),s=w(s,c,u,i,_,4,a[36]),i=w(i,s,c,u,C,11,a[37]),u=w(u,i,s,c,I,16,a[38]),c=w(c,u,i,s,Q,23,a[39]),s=w(s,c,u,i,L,4,a[40]),i=w(i,s,c,u,p,11,a[41]),u=w(u,i,s,c,H,16,a[42]),c=w(c,u,i,s,R,23,a[43]),s=w(s,c,u,i,j,4,a[44]),i=w(i,s,c,u,N,11,a[45]),u=w(u,i,s,c,F,16,a[46]),c=w(c,u,i,s,x,23,a[47]),s=S(s,c,u,i,p,6,a[48]),i=S(i,s,c,u,I,10,a[49]),u=S(u,i,s,c,M,15,a[50]),c=S(c,u,i,s,A,21,a[51]),s=S(s,c,u,i,N,6,a[52]),i=S(i,s,c,u,H,10,a[53]),u=S(u,i,s,c,Q,15,a[54]),c=S(c,u,i,s,_,21,a[55]),s=S(s,c,u,i,G,6,a[56]),i=S(i,s,c,u,F,10,a[57]),u=S(u,i,s,c,R,15,a[58]),c=S(c,u,i,s,L,21,a[59]),s=S(s,c,u,i,C,6,a[60]),i=S(i,s,c,u,W,10,a[61]),u=S(u,i,s,c,x,15,a[62]),c=S(c,u,i,s,j,21,a[63]),v[0]=v[0]+s|0,v[1]=v[1]+c|0,v[2]=v[2]+u|0,v[3]=v[3]+i|0},_doFinalize:function(){var y=this._data,f=y.words,d=this._nDataBytes*8,n=y.sigBytes*8;f[n>>>5]|=128<<24-n%32;var l=r.floor(d/4294967296),v=d;f[(n+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,f[(n+64>>>9<<4)+14]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,y.sigBytes=(f.length+1)*4,this._process();for(var p=this._hash,_=p.words,x=0;x<4;x++){var H=_[x];_[x]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360}return p},clone:function(){var y=E.clone.call(this);return y._hash=this._hash.clone(),y}});function b(y,f,d,n,l,v,p){var _=y+(f&d|~f&n)+l+p;return(_<<v|_>>>32-v)+f}function B(y,f,d,n,l,v,p){var _=y+(f&n|d&~n)+l+p;return(_<<v|_>>>32-v)+f}function w(y,f,d,n,l,v,p){var _=y+(f^d^n)+l+p;return(_<<v|_>>>32-v)+f}function S(y,f,d,n,l,v,p){var _=y+(d^(f|~n))+l+p;return(_<<v|_>>>32-v)+f}h.MD5=E._createHelper(T),h.HmacMD5=E._createHmacHelper(T)}(Math),o.MD5})})(Zt);var Fe=Zt.exports;const Ue=kt(Fe),pt=t=>{try{if((t==null?void 0:t.toString)===void 0)return`${t}`;{const e=t.toString();return e.startsWith("[object ")&&e.endsWith("]")?JSON.stringify(t):e}}catch{return""}},je=t=>pt(t).toLowerCase();function Ge(t){try{return typeof t[Symbol==null?void 0:Symbol.iterator]=="function"}catch{return!1}}function te(t){const e=new Set;return JSON.stringify(t,(r,h)=>{if(typeof h=="object"&&h!==null){if(e.has(h))return;e.add(h),Ge(h)&&(h=[...h])}return h})}const ee="01",re="0123456789",ne="0123456789abcdef",oe="0123456789abcdefghijklmnopqrstuvwxyz",ae="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Bt=t=>{switch(typeof t!="string"&&(t=je(t)),t){case"2":return ee;case"10":return re;case"16":return ne;case"36":return oe;case"62":return ae;case"64":return Y;case"64w":case"64+":return se;default:return t}},Qe=(t,e,o,r=0)=>{typeof t!="string"&&(t=pt(t));let h=BigInt(0);e=Bt(e);const m=e.length;for(let E=0;E<t.length;E++)h+=BigInt(e.indexOf(t[E])*Math.pow(m,t.length-1-E));let g="";if(o=Bt(o),g===""){const E=BigInt(o.length);for(;h>0;)g=o.charAt(+BigInt(h%E).toString())+g,h=BigInt(h/E)}return(g===""?o.charAt(0):g).padStart(r,o[0])},Ve=t=>{const e=t.split("").map(m=>m.charCodeAt(0)),o=[];let r=0;for(;r<e.length;){const[m,g=0,E=0]=e.slice(r,r+=3),k=(m<<16)+(g<<8)+E,a=k>>18,T=k>>12&63,b=k>>6&63,B=k&63;o.push(Y[a],Y[T],Y[b],Y[B])}const h=e.length%3;return o.join("").slice(0,1+o.length-h)+(h===2?"==":h===1?"=":"")},Xe=/[^A-Za-z0-9+/]/g,ie=t=>t.replace(Xe,""),xt=t=>String.fromCharCode(+t),Ke=t=>{const e=ie(t).split(""),o=[];let r=0;for(;r<e.length;){const[h,m,g,E]=e.slice(r,r+=4).map(k=>Y.indexOf(k));o.push(xt(h<<2|m>>4)),g!==64&&o.push(xt((m&15)<<4|g>>2)),E!==64&&o.push(xt((g&3)<<6|E))}return o.join("").replaceAll("\0","")},Z={BASE2_CHARSET:ee,BASE10_CHARSET:re,BASE16_CHARSET:ne,BASE36_CHARSET:oe,BASE62_CHARSET:ae,BASE64_CHARSET:Y,BASE64WEB_CHARSET:se,convert:Qe,getCharset:Bt,secureBase64:ie,textToBase64:Ve,base64ToText:Ke};function Je(...t){return t.reduce((e,o)=>e+o,0)}const Ye=t=>Yt(t,{outputLength:256}).toString(),Ze=/0b[0-1]+/i;function dt(t){if(typeof t=="number")return Math.round(t);if(t instanceof Object&&(t=te(t)),typeof t=="string"){if(Ze.test(t))return parseInt(t.substring(2,t.length-1),2);const e=parseInt(t);return Number.isNaN(e)?e:Je(parseInt(Ye(t),16))}else return Date.now()}const $=624,st=397,tr=2567483615,_t=2147483648,St=2147483647;class er{constructor(e){at(this,"mt",new Array($));at(this,"mti",$+1);at(this,"seed");return this.seed=e=dt(e),Array.isArray(e)?this.init_by_array(e,e.length):this.init_seed(e),this}init_seed(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<$;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}init_by_array(e,o){let r,h,m;for(this.init_seed(19650218),r=1,h=0,m=$>o?$:o;m!==0;m--){const g=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(((g&4294901760)>>>16)*1664525<<16)+(g&65535)*1664525)+e[h]+h,this.mt[r]>>>=0,r++,h++,r>=$&&(this.mt[0]=this.mt[$-1],r=1),h>=o&&(h=0)}for(m=$-1;m!==0;m--){const g=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(((g&4294901760)>>>16)*1566083941<<16)+(g&65535)*1566083941)-r,this.mt[r]>>>=0,r++,r>=$&&(this.mt[0]=this.mt[$-1],r=1)}this.mt[0]=2147483648}random_int(){let e;const o=new Array(0,tr);if(this.mti>=$){let r;for(this.mti===$+1&&this.init_seed(5489),r=0;r<$-st;r++)e=this.mt[r]&_t|this.mt[r+1]&St,this.mt[r]=this.mt[r+st]^e>>>1^o[e&1];for(;r<$-1;r++)e=this.mt[r]&_t|this.mt[r+1]&St,this.mt[r]=this.mt[r+(st-$)]^e>>>1^o[e&1];e=this.mt[$-1]&_t|this.mt[0]&St,this.mt[$-1]=this.mt[st-1]^e>>>1^o[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0}random_int31(){return this.random_int()>>>1}random_incl(){return this.random_int()*(1/4294967295)}random(){return this.random_int()*(1/4294967296)}random_excl(){return(this.random_int()+.5)*(1/4294967296)}random_long(){return((this.random_int()>>>5)*67108864+(this.random_int()>>>6))*(1/9007199254740992)}}function ce(t){return new er(t)}const{BASE10_CHARSET:rr,BASE16_CHARSET:nr,BASE64WEB_CHARSET:or}=Z,ar=ce(),ue=(t=ar)=>t.random(),Rt=(t,e,o)=>((e===void 0||e===0)&&(e=t,t=0),Math.floor(t+ue(o)*e)),le=(t,e)=>t[Rt(0,t.length,e)],fe=(t,e=1,o)=>{const r=[],h=[];for(let m=0;m<e;m++)h.length===0&&h.push(...t),r.push(h.splice(Rt(0,h.length,o),1)[0]);return r},sr=(t,e)=>fe(t,t.length,e),it=(t,e=8,o)=>new Array(e).fill(0).map(r=>le(t,o)).join(""),he={MT:ce,toSeed:dt,rand:ue,randInt:Rt,charset:it,choice:le,choices:fe,shuffle:sr,base10:(t=6,e)=>it(rr,t,e),base16:(t=32,e)=>it(nr,t,e),base64:(t=32,e)=>it(or,t,e),lcg(t){let e=dt(t);return()=>(e=(e*1664525+1013904223)%4294967296)/4294967296}},{MT:Ut,shuffle:ir,randInt:Ct}=he,{convert:cr,getCharset:ur}=Z,lr=(t,e)=>{const o=ir(t,e);return()=>(o.push(o.shift()),o)},ve=(t,e=16,o=1,r)=>{const h=Number.isNaN(+e)?64:+e,m=ur(e),g=dt(r!==void 0?r:Ct(0,h)),E=Ut(g),k=lr(m,Ut(Ct(0,1e6,E))),a=typeof t=="string"?t.split(""):t,T=[r!==void 0?m[Ct(0,h)]:cr(g,10,e),...a.map(b=>k()[m.indexOf(b)])];return--o<1?T.join(""):ve(T,e,o,r)},{textToBase64:fr,base64ToText:Dr,secureBase64:hr}=Z;function vr(t,e=1,o){return typeof t=="object"?t=te(t):typeof t!="string"&&(t=pt(t)),ve(hr(fr(t)),64,e,o)}function dr(t,e=512,o){const r=vr(t,1,o).substring(1);return e==="MD5"?Ue(r).toString():Yt(r,{outputLength:e}).toString()}const pr=new Map([["THINKING","Please wait, I am answering another question..."]]);function mr(t,e){switch(t){case"model":if(["gpt3","gpt4","gpt-web","claude-2-web","gpt3-fga"].includes(e))return!0;break;case"temperature":if(typeof e=="number"&&e>=0&&e<=1)return!0;break;case"context":if(typeof e=="boolean")return!0;break}return!1}function gr(t){try{return JSON.parse(t)}catch{return t}}function de(t){try{const e={};for(const o in t){const r=gr(t[o]);mr(o,r)&&(e[o]=r)}return e}catch{return{}}}function yr(t){try{return de(Kt.parse(t))}catch{return{}}}function wr(t){try{return Kt.stringify(de(t))}catch{return""}}const jt=[{name:"GPT-3.5-Turbo",value:"gpt3",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-4",value:"gpt4",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-Web",value:"gpt-web",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"Claude-2-Web",value:"claude-2-web",isWebBrowsingOptional:!1,isTemperatureOptional:!1,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1},{name:"GPT-3.5-Turbo (stream)",value:"gpt3-fga",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1}];let It,Gt="";const pe=D(),Wt=D(!1),me=D(""),K=D("gpt4"),tt=D(!0),et=D(.5),O=D([]),V=D([]);nt(Wt,t=>{t||U()});const xr=t=>{Wt.value=!0,pe.value=t,me.value=t.Q,setTimeout(()=>ge(),0)};function ge(){try{document.querySelector(".EditMessageInput textarea").focus()}catch{}}const U=()=>{try{{const t=document.querySelector(".InputBox textarea");t.click(),t.focus()}}catch{}},ye=()=>{try{const t=document.getElementById(P()).parentElement,e=document.querySelector(".ConversationList"),o=t.offsetTop-e.offsetTop-t.clientHeight/2,r=o-e.clientHeight+t.clientHeight*2;e.scrollTop>o&&e.scrollTo({left:0,top:o,behavior:"smooth"}),e.scrollTop<r&&e.scrollTo({left:0,top:r,behavior:"smooth"})}catch{}},ct=()=>new Promise((t,e)=>{$fetch("/api/curva/check",{method:"POST"}).then(o=>{V.value=o,ye(),t(!0)}).catch(o=>{q.error("Initialization Failed"),e(o)})}),_r=t=>new Promise(async(e,o)=>{if(t==null)return e([]);const r=await $fetch("/api/curva/history",{method:"POST",body:{id:t}});(!r||r.length===0)&&ht("/c/");try{e(r.map(h=>Xt({...h,t:new Date(h.t),done:!!h.A})))}catch{ht("/c/"),e([])}}),we=async function(t){return[]},Sr=async()=>{try{const t=O.value.at(-1),e=await we(t.Q),o=bt()>=document.body.clientHeight;t.more=e,o&&X()}catch(t){console.error(t)}},Ot=(t=!1)=>{K.value="gpt4",tt.value=!0,et.value=.5,t&&q.success("Conversation settings have been reset.")};Ot();const z=D(!1),$t=D(z.value),Pt=D(z.value);nt($t,t=>{z.value=t});nt(Pt,t=>{z.value=t});nt(z,t=>{const{isMobileScreen:e}=vt();$t.value=e?!1:t,Pt.value=e?t:!1,setTimeout(()=>U(),0)});{let t,e=vt().isMobileScreen?"drawer":"sidebar";window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>{const o=vt().isMobileScreen?"drawer":"sidebar";z.value&&o!=e&&(z.value=!1,setTimeout(()=>{z.value=!0},0),e=o)},100)})}const ut=D(""),Cr=Vt(()=>K.value.startsWith("gpt3")?16e3:32e3),Tr=(()=>{const t=()=>[77,68,53].map(r=>String.fromCharCode(r)).join(""),e=(r,h)=>({hash:dr(r,t(),h),timestamp:pt(h)}),o=(r,h,m,g,E,k,a)=>{let T=P();return T||(T=he.base64(8),V.value.unshift({id:T,name:"",mtime:Date.now(),config:""}),ht(`/c/${T}?feature=new`),_e(T)),{conv:T,messages:r,model:h,temperature:m,t:g,tz:E,id:k,streamId:a}};return async(r,h)=>{const m=new Date,g=m.getTime(),E=m.getTimezoneOffset()/60*-1,k=(()=>{if(!tt.value)return[{role:"user",content:(r==null?void 0:r.Q)||""}];const a=O.value.lastIndexOf(r)+1||O.value.length;let T=O.value.slice(0,a);return T=T.slice(T.length-100),T.map(b=>[{role:"user",content:b.Q},{role:"assistant",content:b.A}].filter(B=>B.content)).flat()})();try{const a=o(k,K.value,et.value,g,E,r==null?void 0:r.id,h),T=e(k,g);return await $fetch("/api/curva/answer",{method:"POST",headers:T,body:a})}catch{return{answer:"",error:"Error while sending request."}}}})(),br=(t="",e="",o=!1)=>Xt({done:o,Q:t,A:e,queries:[],urls:[],dt:void 0,t:new Date}),lt=new Set,Tt=()=>{V.value=[],O.value=[],ht("/c/"),At=!0};let At=!0;function Qt(){{const t=We();t.get("feature")==="new"&&(t.delete("feature"),t.save(),Lt())}}const xe=(t,e)=>{const o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),o.remove()},[Br,P,_e]=(()=>{const t=D("");return[Vt(()=>t.value),()=>t.value,e=>{var o,r;return t.value=e===void 0?(r=(o=It._route)==null?void 0:o.params)==null?void 0:r.conv:e}]})(),ft=()=>{var e;const t=P();return((e=V.value.filter(o=>o.id===t)[0])==null?void 0:e.name)||""};async function Lt(t,e){return t=t||P(),t?await $fetch("/api/curva/conv",{method:"PUT",body:{id:t,name:e||ft(),config:wr({model:K.value,temperature:et.value,context:tt.value})}}):{cancel:!0}}let Et=!1;const Ar=t=>{var r;if(t===void 0&&(t=P()),t==null)return;const e=yr(((r=V.value.find(h=>h.id===t))==null?void 0:r.config)||""),o=Object.keys(e);if(o.length===0)Ot();else{Et=!0;try{for(const h of o){const m=e[h];switch(h){case"model":K.value=m;break;case"temperature":et.value=m;break;case"context":tt.value=m;break}}}finally{Et=!1}}q.info("Conversation settings have been loaded.")};setTimeout(()=>{let t;[K,tt,et].forEach(e=>{nt(e,(o,r)=>{It&&!Et&&o!==r&&lt.size===0&&(clearTimeout(t),t=setTimeout(async()=>{try{const{cancel:h=!1}=await Lt();h||q.info("Conversation settings have been saved.")}catch(h){console.error(h),q.warning("Failed to save conversation settings.")}finally{clearTimeout(t)}},typeof e.value=="number"?500:0))})})},1e3);const Er=t=>{O.value=O.value.filter(e=>e.id!==t),$fetch("/api/curva/answer",{method:"DELETE",body:{conv:P(),id:t}}).then(()=>q.info("The message has been deleted.")).catch(()=>q.error("An error occurred while deleting the message."))},kr=()=>{let t=0;const e=`${Z.convert(P(),"64w",10)}.md`,o=O.value.map(r=>{t++;try{return(r.t?`${new Date(r.t.getTime()-(r.dt||0)).toLocaleString()}${r.dt===void 0?"":" (Δt: "+r.dt.toString()+"ms)"}

`:"")+(r.Q?`QUESTION ${t}:

${r.Q.replaceAll(`
`,`

`)}`:"")+(r.Q&&r.A?`

`:"")+(r.A?`ANSWER ${t}:

${r.A}`:"")}catch{return"(Unknown message)"}}).join(`

---

`)+`

---

`;xe(e,o)},Hr=()=>{xe(`${Z.convert(P(),"64w",10)}.json`,JSON.stringify(O.value.map(t=>({question:t.Q,answer:t.A,created:new Date(t.t.getTime()).toUTCString(),timeUsed:t.dt||void 0,queries:t.queries||void 0,urls:t.urls||void 0})),null,4))};document.addEventListener("keyup",t=>{switch(t.key){case"/":case"Enter":U();break;case"Escape":z.value=!z.value;break}});const Se=D(!1);document.addEventListener("scroll",()=>{Se.value=!ke()});function qr(){const{authEventTarget:t}=Oe(),e=zt("appName").value,o=He();["temperature-suffix","web-browsing","temperature"].forEach(w=>{o.delete(w,{path:"/"}),o.delete(w)}),It=Re();const r=()=>{try{Nt(`${ft()||g("chat.title")} - ${e}`)}catch{Nt(`${g("chat.title")} - ${e}`)}};t.addListener("login",Tt),t.addListener("logout",Tt);const h=async w=>{setTimeout(()=>{vt().isMobileScreen&&(z.value=!1)},0),O.value=[];const S=mt.service({text:g("chat.ldConv")+"...",lock:!0});try{const y=w===null&&V.value.length>0?null:ct(),f=w===null?null:await _r(w);Ar(w),f!==null&&P()===w&&(O.value=f,Sr()),await Promise.all([y,X(1e3)])}finally{S.close(),await X(500),U(),ye(),await X(500)}},m=async(w,S=!1)=>{_e(w||"");const y=Promise.all([...lt]),f=At&&S?new Promise(async d=>{await h(w),Qt(),d(null)}):S?new Promise(d=>d(null)):h(w);At=!1,lt.add(f);try{await y}catch{}try{await f}finally{lt.delete(f)}},g=Ie().t,E=zt("version"),k=async(w,S)=>{if(document.querySelectorAll(".Message.T").length>0)return q.info("Please wait for the completion of the previous question."),U(),!1;const f=(w!==void 0?w:ut.value).trim();if(w===void 0&&(ut.value="",f===""))return U(),!1;const d=(S?O.value.filter(W=>W.id===S).at(-1):void 0)||br(f,"",!1);O.value.includes(d)||O.value.push(d);const n=d.A||"";d.done=!1,d.Q=f,d.A="",d.urls=[],d.queries=[];const l=we(),v=bt()>=document.body.clientHeight,p=P();v&&X().finally(()=>U());const _=await new Promise(async W=>{var u;if(!((u=jt.find(i=>i.value===K.value))!=null&&u.isStreamAvailable))return W(void 0);const N=new AbortController,L=await fetch("/api/curva/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:"{}",signal:N.signal}),M=new TextDecoder,F=L.body.getReader();let s=!1;const c=async()=>{await F.read().then(async({value:i,done:ot})=>{if(ot){d.done=!0;return}const rt=M.decode(i);s?(d.A+=rt,v&&X(0,"instant")):(W(rt),s=!0),c()})};c()}),x=await Tr(d,_);Qt(),Gt!==p&&ct().finally(()=>{Gt=P()});const{id:H,answer:C="",error:A,urls:R=[],queries:I=[],dt:G=0,version:j}=x;d.done=!0,d.t=new Date,d.dt=G||void 0,d.id=H||void 0,d.A!==C&&(d.A=C||""),d.urls=R||[],d.queries=I||[];const Q=(W=>W?(W.type==="warning"?q.warning(W.content):q.error(W.content),d.A="Oops! Something went wrong!",!0):!1)((()=>{if(C===""){if(A){const W=()=>{S?d.A=n:(O.value.pop(),ut.value=f)};if(typeof A=="string"&&A.startsWith("You have tried too many times."))return W(),{type:"warning",content:A};switch(A){case"THINKING":return W(),{type:"warning",content:pr.get(A)};default:return{type:"error",content:A}}}return{type:"error",content:g("error.plzRefresh")}}})());return setTimeout(async()=>{if(!S&&v&&await X(),j&&j!==E.value){const W=setTimeout(()=>location.reload(),3e3);gt.confirm(g("action.newVersion"),g("message.notice"),{confirmButtonText:g("message.ok"),cancelButtonText:g("message.cancel"),type:"warning"}).then(()=>U()).catch(()=>U()).finally(()=>{clearTimeout(W),mt.service({text:"Loading...",lock:!0}),location.reload()})}},0),l.then(W=>{const N=bt()>=document.body.clientHeight;d.more=W,N&&X()}),Q};return{models:jt,showScrollToBottomButton:Se,isEditingMessage:Wt,editingMessage:pe,callEditMessageDialog:xr,editingMessageContent:me,focusEditMessageInput:ge,model:K,conversations:V,messages:O,temperature:et,contextMode:tt,openMenu:z,openSidebarController:$t,openDrawerController:Pt,inputValue:ut,inputMaxLength:Cr,currentConvIdComputed:Br,getCurrentConvId:P,getCurrentConvName:ft,checkTokenAndGetConversations:ct,loadChat:m,sendMessage:k,deleteMessage:Er,regenerateMessage:async w=>{if(O.value.length===0)return;const{Q:S,id:y}=w||O.value.pop();k(S||"",y)},focusInput:U,refreshConversation:()=>{m(P()).finally(()=>U())},renameConversation:(w,S="")=>{w||(w=P(),S=ft()),gt.prompt(g("message.renameConvHint"),g("message.setting"),{confirmButtonText:g("message.ok"),cancelButtonText:g("message.cancel"),inputValue:S,inputPlaceholder:Z.convert(w,"64w",10)}).then(async({value:y})=>{try{await Lt(w,y),q({type:"success",message:g("message.renameSuccess")}),await ct(),r()}catch{q({type:"error",message:"Oops! Something went wrong!"})}}).catch(()=>{})},deleteConversation:w=>{const S=w||P();let y="createNewChat";gt.confirm(g("message.deleteConvConfirm"),g("message.warning"),{confirmButtonText:g("message.ok"),cancelButtonText:g("message.cancel"),type:"warning"}).then(async()=>{var l;const f=mt.service({text:g("chat.dltConv")+"...",lock:!0});try{await $fetch("/api/curva/conv",{method:"DELETE",body:{id:S}})}catch{}f.close();const d=P();w===d&&((l=document.getElementById(y))==null||l.click());const n=V.value.findIndex(v=>v.id===d);n!=-1&&V.value.splice(n,1)})},resetConvConfig:Ot,exportAsMarkdown:kr,exportAsJson:Hr,clear:Tt}}export{Z as b,he as r,pt as s,qr as u};
