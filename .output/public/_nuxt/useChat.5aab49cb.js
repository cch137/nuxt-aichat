var be=Object.defineProperty;var Ae=(t,e,o)=>e in t?be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var ct=(t,e,o)=>(Ae(t,typeof e!="symbol"?e+"":e,o),o);import{O as Ht,cf as Te,cg as Ee,ch as He,ci as ke,cj as J,r as z,V as tt,U as Re,E as N,i as Ot,ck as $e,g as Ie,q as mt,aD as qe,cl as bt,m as pt,h as Vt,cm as We}from"./entry.97b597df.js";import{E as yt}from"./el-overlay.bcefe1da.js";import"./el-button.dc8b7a60.js";import"./el-input.d5155eab.js";import{u as ut}from"./useTitle.1287adce.js";import{l as De,s as kt}from"./str.d457f5f4.js";var Pe=Te,Ne=Ee,ze=He,Oe={formats:ze,parse:Ne,stringify:Pe};const Xt=Ht(Oe);async function X(t=0){return await new Promise((e,o)=>{setTimeout(()=>{try{window.scrollTo(0,document.body.scrollHeight),e(null)}catch(n){o(n)}},+t||0)})}const je={get isMobileScreen(){return window.innerWidth<600},get isTouchScreen(){return"ontouchstart"in document||navigator.maxTouchPoints>0}};function jt(){return je}const Mt="web-browsing",Lt="temperature-suffix",wt="temperature",Kt="01",Jt="0123456789",Zt="0123456789abcdef",Yt="0123456789abcdefghijklmnopqrstuvwxyz",te="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",At=t=>{switch(typeof t!="string"&&(t=De(t)),t){case"2":return Kt;case"10":return Jt;case"16":return Zt;case"36":return Yt;case"62":return te;case"64":return Z;case"64w":case"64+":return ee;default:return t}},Me=(t,e,o,n=0)=>{typeof t!="string"&&(t=kt(t));let c=BigInt(0);e=At(e);const v=e.length;for(let b=0;b<t.length;b++)c+=BigInt(e.indexOf(t[b])*Math.pow(v,t.length-1-b));let x="";if(o=At(o),x===""){const b=BigInt(o.length);for(;c>0;)x=o.charAt(+BigInt(c%b).toString())+x,c=BigInt(c/b)}return(x===""?o.charAt(0):x).padStart(n,o[0])},Le=t=>{const e=t.split("").map(v=>v.charCodeAt(0)),o=[];let n=0;for(;n<e.length;){const[v,x=0,b=0]=e.slice(n,n+=3),H=(v<<16)+(x<<8)+b,a=H>>18,C=H>>12&63,T=H>>6&63,m=H&63;o.push(Z[a],Z[C],Z[T],Z[m])}const c=e.length%3;return o.join("").slice(0,1+o.length-c)+(c===2?"==":c===1?"=":"")},Ue=/[^A-Za-z0-9+/]/g,re=t=>t.replace(Ue,""),_t=t=>String.fromCharCode(+t),Fe=t=>{const e=re(t).split(""),o=[];let n=0;for(;n<e.length;){const[c,v,x,b]=e.slice(n,n+=4).map(H=>Z.indexOf(H));o.push(_t(c<<2|v>>4)),x!==64&&o.push(_t((v&15)<<4|x>>2)),b!==64&&o.push(_t((x&3)<<6|b))}return o.join("").replaceAll("\0","")},et={BASE2_CHARSET:Kt,BASE10_CHARSET:Jt,BASE16_CHARSET:Zt,BASE36_CHARSET:Yt,BASE62_CHARSET:te,BASE64_CHARSET:Z,BASE64WEB_CHARSET:ee,convert:Me,getCharset:At,secureBase64:re,textToBase64:Le,base64ToText:Fe};var ne={exports:{}};function Qe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xt={exports:{}},Ut;function Rt(){return Ut||(Ut=1,function(t,e){(function(o,n){t.exports=n()})(J,function(){var o=o||function(n,c){var v;if(typeof window<"u"&&window.crypto&&(v=window.crypto),typeof self<"u"&&self.crypto&&(v=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(v=globalThis.crypto),!v&&typeof window<"u"&&window.msCrypto&&(v=window.msCrypto),!v&&typeof J<"u"&&J.crypto&&(v=J.crypto),!v&&typeof Qe=="function")try{v=ke}catch{}var x=function(){if(v){if(typeof v.getRandomValues=="function")try{return v.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof v.randomBytes=="function")try{return v.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},b=Object.create||function(){function r(){}return function(u){var d;return r.prototype=u,d=new r,r.prototype=null,d}}(),H={},a=H.lib={},C=a.Base=function(){return{extend:function(r){var u=b(this);return r&&u.mixIn(r),(!u.hasOwnProperty("init")||this.init===u.init)&&(u.init=function(){u.$super.init.apply(this,arguments)}),u.init.prototype=u,u.$super=this,u},create:function(){var r=this.extend();return r.init.apply(r,arguments),r},init:function(){},mixIn:function(r){for(var u in r)r.hasOwnProperty(u)&&(this[u]=r[u]);r.hasOwnProperty("toString")&&(this.toString=r.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),T=a.WordArray=C.extend({init:function(r,u){r=this.words=r||[],u!=c?this.sigBytes=u:this.sigBytes=r.length*4},toString:function(r){return(r||B).stringify(this)},concat:function(r){var u=this.words,d=r.words,p=this.sigBytes,w=r.sigBytes;if(this.clamp(),p%4)for(var y=0;y<w;y++){var k=d[y>>>2]>>>24-y%4*8&255;u[p+y>>>2]|=k<<24-(p+y)%4*8}else for(var A=0;A<w;A+=4)u[p+A>>>2]=d[A>>>2];return this.sigBytes+=w,this},clamp:function(){var r=this.words,u=this.sigBytes;r[u>>>2]&=4294967295<<32-u%4*8,r.length=n.ceil(u/4)},clone:function(){var r=C.clone.call(this);return r.words=this.words.slice(0),r},random:function(r){for(var u=[],d=0;d<r;d+=4)u.push(x());return new T.init(u,r)}}),m=H.enc={},B=m.Hex={stringify:function(r){for(var u=r.words,d=r.sigBytes,p=[],w=0;w<d;w++){var y=u[w>>>2]>>>24-w%4*8&255;p.push((y>>>4).toString(16)),p.push((y&15).toString(16))}return p.join("")},parse:function(r){for(var u=r.length,d=[],p=0;p<u;p+=2)d[p>>>3]|=parseInt(r.substr(p,2),16)<<24-p%8*4;return new T.init(d,u/2)}},S=m.Latin1={stringify:function(r){for(var u=r.words,d=r.sigBytes,p=[],w=0;w<d;w++){var y=u[w>>>2]>>>24-w%4*8&255;p.push(String.fromCharCode(y))}return p.join("")},parse:function(r){for(var u=r.length,d=[],p=0;p<u;p++)d[p>>>2]|=(r.charCodeAt(p)&255)<<24-p%4*8;return new T.init(d,u)}},g=m.Utf8={stringify:function(r){try{return decodeURIComponent(escape(S.stringify(r)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(r){return S.parse(unescape(encodeURIComponent(r)))}},i=a.BufferedBlockAlgorithm=C.extend({reset:function(){this._data=new T.init,this._nDataBytes=0},_append:function(r){typeof r=="string"&&(r=g.parse(r)),this._data.concat(r),this._nDataBytes+=r.sigBytes},_process:function(r){var u,d=this._data,p=d.words,w=d.sigBytes,y=this.blockSize,k=y*4,A=w/k;r?A=n.ceil(A):A=n.max((A|0)-this._minBufferSize,0);var E=A*y,R=n.min(E*4,w);if(E){for(var $=0;$<E;$+=y)this._doProcessBlock(p,$);u=p.splice(0,E),d.sigBytes-=R}return new T.init(u,R)},clone:function(){var r=C.clone.call(this);return r._data=this._data.clone(),r},_minBufferSize:0});a.Hasher=i.extend({cfg:C.extend(),init:function(r){this.cfg=this.cfg.extend(r),this.reset()},reset:function(){i.reset.call(this),this._doReset()},update:function(r){return this._append(r),this._process(),this},finalize:function(r){r&&this._append(r);var u=this._doFinalize();return u},blockSize:16,_createHelper:function(r){return function(u,d){return new r.init(d).finalize(u)}},_createHmacHelper:function(r){return function(u,d){return new _.HMAC.init(r,d).finalize(u)}}});var _=H.algo={};return H}(Math);return o})}(xt)),xt.exports}var St={exports:{}},Ft;function Ge(){return Ft||(Ft=1,function(t,e){(function(o,n){t.exports=n(Rt())})(J,function(o){return function(n){var c=o,v=c.lib,x=v.Base,b=v.WordArray,H=c.x64={};H.Word=x.extend({init:function(a,C){this.high=a,this.low=C}}),H.WordArray=x.extend({init:function(a,C){a=this.words=a||[],C!=n?this.sigBytes=C:this.sigBytes=a.length*8},toX32:function(){for(var a=this.words,C=a.length,T=[],m=0;m<C;m++){var B=a[m];T.push(B.high),T.push(B.low)}return b.create(T,this.sigBytes)},clone:function(){for(var a=x.clone.call(this),C=a.words=this.words.slice(0),T=C.length,m=0;m<T;m++)C[m]=C[m].clone();return a}})}(),o})}(St)),St.exports}(function(t,e){(function(o,n,c){t.exports=n(Rt(),Ge())})(J,function(o){return function(n){var c=o,v=c.lib,x=v.WordArray,b=v.Hasher,H=c.x64,a=H.Word,C=c.algo,T=[],m=[],B=[];(function(){for(var i=1,_=0,r=0;r<24;r++){T[i+5*_]=(r+1)*(r+2)/2%64;var u=_%5,d=(2*i+3*_)%5;i=u,_=d}for(var i=0;i<5;i++)for(var _=0;_<5;_++)m[i+5*_]=_+(2*i+3*_)%5*5;for(var p=1,w=0;w<24;w++){for(var y=0,k=0,A=0;A<7;A++){if(p&1){var E=(1<<A)-1;E<32?k^=1<<E:y^=1<<E-32}p&128?p=p<<1^113:p<<=1}B[w]=a.create(y,k)}})();var S=[];(function(){for(var i=0;i<25;i++)S[i]=a.create()})();var g=C.SHA3=b.extend({cfg:b.cfg.extend({outputLength:512}),_doReset:function(){for(var i=this._state=[],_=0;_<25;_++)i[_]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(i,_){for(var r=this._state,u=this.blockSize/2,d=0;d<u;d++){var p=i[_+2*d],w=i[_+2*d+1];p=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360;var y=r[d];y.high^=w,y.low^=p}for(var k=0;k<24;k++){for(var A=0;A<5;A++){for(var E=0,R=0,$=0;$<5;$++){var y=r[A+5*$];E^=y.high,R^=y.low}var I=S[A];I.high=E,I.low=R}for(var A=0;A<5;A++)for(var O=S[(A+4)%5],Q=S[(A+1)%5],G=Q.high,V=Q.low,E=O.high^(G<<1|V>>>31),R=O.low^(V<<1|G>>>31),$=0;$<5;$++){var y=r[A+5*$];y.high^=E,y.low^=R}for(var P=1;P<25;P++){var E,R,y=r[P],j=y.high,M=y.low,s=T[P];s<32?(E=j<<s|M>>>32-s,R=M<<s|j>>>32-s):(E=M<<s-32|j>>>64-s,R=j<<s-32|M>>>64-s);var f=S[m[P]];f.high=E,f.low=R}var l=S[0],h=r[0];l.high=h.high,l.low=h.low;for(var A=0;A<5;A++)for(var $=0;$<5;$++){var P=A+5*$,y=r[P],Dt=S[P],Pt=S[(A+1)%5+5*$],Nt=S[(A+2)%5+5*$];y.high=Dt.high^~Pt.high&Nt.high,y.low=Dt.low^~Pt.low&Nt.low}var y=r[0],zt=B[k];y.high^=zt.high,y.low^=zt.low}},_doFinalize:function(){var i=this._data,_=i.words;this._nDataBytes*8;var r=i.sigBytes*8,u=this.blockSize*32;_[r>>>5]|=1<<24-r%32,_[(n.ceil((r+1)/u)*u>>>5)-1]|=128,i.sigBytes=_.length*4,this._process();for(var d=this._state,p=this.cfg.outputLength/8,w=p/8,y=[],k=0;k<w;k++){var A=d[k],E=A.high,R=A.low;E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,y.push(R),y.push(E)}return new x.init(y,p)},clone:function(){for(var i=b.clone.call(this),_=i._state=this._state.slice(0),r=0;r<25;r++)_[r]=_[r].clone();return i}});c.SHA3=b._createHelper(g),c.HmacSHA3=b._createHmacHelper(g)}(Math),o.SHA3})})(ne);var Ve=ne.exports;const oe=Ht(Ve);function Xe(...t){return t.reduce((e,o)=>e+o,0)}function Ke(t){try{return typeof t[Symbol==null?void 0:Symbol.iterator]=="function"}catch{return!1}}function ae(t){const e=new Set;return JSON.stringify(t,(n,c)=>{if(typeof c=="object"&&c!==null){if(e.has(c))return;e.add(c),Ke(c)&&(c=[...c])}return c})}const Je=t=>oe(t,{outputLength:256}).toString(),Ze=/0b[0-1]+/i;function it(t){if(typeof t=="number")return Math.round(t);if(t instanceof Object&&(t=ae(t)),typeof t=="string"){if(Ze.test(t))return parseInt(t.substring(2,t.length-1),2);const e=parseInt(t);return Number.isNaN(e)?e:Xe(parseInt(Je(t),16))}else return Date.now()}const W=624,ft=397,Ye=2567483615,Ct=2147483648,Bt=2147483647;class tr{constructor(e){ct(this,"mt",new Array(W));ct(this,"mti",W+1);ct(this,"seed");return this.seed=e=it(e),Array.isArray(e)?this.init_by_array(e,e.length):this.init_seed(e),this}init_seed(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<W;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}init_by_array(e,o){let n,c,v;for(this.init_seed(19650218),n=1,c=0,v=W>o?W:o;v!==0;v--){const x=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((x&4294901760)>>>16)*1664525<<16)+(x&65535)*1664525)+e[c]+c,this.mt[n]>>>=0,n++,c++,n>=W&&(this.mt[0]=this.mt[W-1],n=1),c>=o&&(c=0)}for(v=W-1;v!==0;v--){const x=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((x&4294901760)>>>16)*1566083941<<16)+(x&65535)*1566083941)-n,this.mt[n]>>>=0,n++,n>=W&&(this.mt[0]=this.mt[W-1],n=1)}this.mt[0]=2147483648}random_int(){let e;const o=new Array(0,Ye);if(this.mti>=W){let n;for(this.mti===W+1&&this.init_seed(5489),n=0;n<W-ft;n++)e=this.mt[n]&Ct|this.mt[n+1]&Bt,this.mt[n]=this.mt[n+ft]^e>>>1^o[e&1];for(;n<W-1;n++)e=this.mt[n]&Ct|this.mt[n+1]&Bt,this.mt[n]=this.mt[n+(ft-W)]^e>>>1^o[e&1];e=this.mt[W-1]&Ct|this.mt[0]&Bt,this.mt[W-1]=this.mt[ft-1]^e>>>1^o[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0}random_int31(){return this.random_int()>>>1}random_incl(){return this.random_int()*(1/4294967295)}random(){return this.random_int()*(1/4294967296)}random_excl(){return(this.random_int()+.5)*(1/4294967296)}random_long(){return((this.random_int()>>>5)*67108864+(this.random_int()>>>6))*(1/9007199254740992)}}function se(t){return new tr(t)}const{BASE10_CHARSET:er,BASE16_CHARSET:rr,BASE64WEB_CHARSET:nr}=et,or=se(),ie=(t=or)=>t.random(),$t=(t,e,o)=>((e===void 0||e===0)&&(e=t,t=0),Math.floor(t+ie(o)*e)),ce=(t,e)=>t[$t(0,t.length,e)],ue=(t,e=1,o)=>{const n=[],c=[];for(let v=0;v<e;v++)c.length===0&&c.push(...t),n.push(c.splice($t(0,c.length,o),1)[0]);return n},ar=(t,e)=>ue(t,t.length,e),lt=(t,e=8,o)=>new Array(e).fill(0).map(n=>ce(t,o)).join(""),fe={MT:se,toSeed:it,rand:ie,randInt:$t,charset:lt,choice:ce,choices:ue,shuffle:ar,base10:(t=6,e)=>lt(er,t,e),base16:(t=32,e)=>lt(rr,t,e),base64:(t=32,e)=>lt(nr,t,e),lcg(t){let e=it(t);return()=>(e=(e*1664525+1013904223)%4294967296)/4294967296}};var le={exports:{}};(function(t,e){(function(o,n){t.exports=n(Rt())})(J,function(o){return function(n){var c=o,v=c.lib,x=v.WordArray,b=v.Hasher,H=c.algo,a=[];(function(){for(var g=0;g<64;g++)a[g]=n.abs(n.sin(g+1))*4294967296|0})();var C=H.MD5=b.extend({_doReset:function(){this._hash=new x.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,i){for(var _=0;_<16;_++){var r=i+_,u=g[r];g[r]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360}var d=this._hash.words,p=g[i+0],w=g[i+1],y=g[i+2],k=g[i+3],A=g[i+4],E=g[i+5],R=g[i+6],$=g[i+7],I=g[i+8],O=g[i+9],Q=g[i+10],G=g[i+11],V=g[i+12],P=g[i+13],j=g[i+14],M=g[i+15],s=d[0],f=d[1],l=d[2],h=d[3];s=T(s,f,l,h,p,7,a[0]),h=T(h,s,f,l,w,12,a[1]),l=T(l,h,s,f,y,17,a[2]),f=T(f,l,h,s,k,22,a[3]),s=T(s,f,l,h,A,7,a[4]),h=T(h,s,f,l,E,12,a[5]),l=T(l,h,s,f,R,17,a[6]),f=T(f,l,h,s,$,22,a[7]),s=T(s,f,l,h,I,7,a[8]),h=T(h,s,f,l,O,12,a[9]),l=T(l,h,s,f,Q,17,a[10]),f=T(f,l,h,s,G,22,a[11]),s=T(s,f,l,h,V,7,a[12]),h=T(h,s,f,l,P,12,a[13]),l=T(l,h,s,f,j,17,a[14]),f=T(f,l,h,s,M,22,a[15]),s=m(s,f,l,h,w,5,a[16]),h=m(h,s,f,l,R,9,a[17]),l=m(l,h,s,f,G,14,a[18]),f=m(f,l,h,s,p,20,a[19]),s=m(s,f,l,h,E,5,a[20]),h=m(h,s,f,l,Q,9,a[21]),l=m(l,h,s,f,M,14,a[22]),f=m(f,l,h,s,A,20,a[23]),s=m(s,f,l,h,O,5,a[24]),h=m(h,s,f,l,j,9,a[25]),l=m(l,h,s,f,k,14,a[26]),f=m(f,l,h,s,I,20,a[27]),s=m(s,f,l,h,P,5,a[28]),h=m(h,s,f,l,y,9,a[29]),l=m(l,h,s,f,$,14,a[30]),f=m(f,l,h,s,V,20,a[31]),s=B(s,f,l,h,E,4,a[32]),h=B(h,s,f,l,I,11,a[33]),l=B(l,h,s,f,G,16,a[34]),f=B(f,l,h,s,j,23,a[35]),s=B(s,f,l,h,w,4,a[36]),h=B(h,s,f,l,A,11,a[37]),l=B(l,h,s,f,$,16,a[38]),f=B(f,l,h,s,Q,23,a[39]),s=B(s,f,l,h,P,4,a[40]),h=B(h,s,f,l,p,11,a[41]),l=B(l,h,s,f,k,16,a[42]),f=B(f,l,h,s,R,23,a[43]),s=B(s,f,l,h,O,4,a[44]),h=B(h,s,f,l,V,11,a[45]),l=B(l,h,s,f,M,16,a[46]),f=B(f,l,h,s,y,23,a[47]),s=S(s,f,l,h,p,6,a[48]),h=S(h,s,f,l,$,10,a[49]),l=S(l,h,s,f,j,15,a[50]),f=S(f,l,h,s,E,21,a[51]),s=S(s,f,l,h,V,6,a[52]),h=S(h,s,f,l,k,10,a[53]),l=S(l,h,s,f,Q,15,a[54]),f=S(f,l,h,s,w,21,a[55]),s=S(s,f,l,h,I,6,a[56]),h=S(h,s,f,l,M,10,a[57]),l=S(l,h,s,f,R,15,a[58]),f=S(f,l,h,s,P,21,a[59]),s=S(s,f,l,h,A,6,a[60]),h=S(h,s,f,l,G,10,a[61]),l=S(l,h,s,f,y,15,a[62]),f=S(f,l,h,s,O,21,a[63]),d[0]=d[0]+s|0,d[1]=d[1]+f|0,d[2]=d[2]+l|0,d[3]=d[3]+h|0},_doFinalize:function(){var g=this._data,i=g.words,_=this._nDataBytes*8,r=g.sigBytes*8;i[r>>>5]|=128<<24-r%32;var u=n.floor(_/4294967296),d=_;i[(r+64>>>9<<4)+15]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360,i[(r+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,g.sigBytes=(i.length+1)*4,this._process();for(var p=this._hash,w=p.words,y=0;y<4;y++){var k=w[y];w[y]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return p},clone:function(){var g=b.clone.call(this);return g._hash=this._hash.clone(),g}});function T(g,i,_,r,u,d,p){var w=g+(i&_|~i&r)+u+p;return(w<<d|w>>>32-d)+i}function m(g,i,_,r,u,d,p){var w=g+(i&r|_&~r)+u+p;return(w<<d|w>>>32-d)+i}function B(g,i,_,r,u,d,p){var w=g+(i^_^r)+u+p;return(w<<d|w>>>32-d)+i}function S(g,i,_,r,u,d,p){var w=g+(_^(i|~r))+u+p;return(w<<d|w>>>32-d)+i}c.MD5=b._createHelper(C),c.HmacMD5=b._createHmacHelper(C)}(Math),o.MD5})})(le);var sr=le.exports;const ir=Ht(sr),{MT:gt,shuffle:cr,randInt:vt}=fe,{convert:he,getCharset:ve}=et,de=(t,e)=>{const o=cr(t,e);return()=>(o.push(o.shift()),o)},me=(t,e=16,o=1,n)=>{const c=Number.isNaN(+e)?64:+e,v=ve(e),x=it(n!==void 0?n:vt(0,c)),b=gt(x),H=de(v,gt(vt(0,1e6,b))),a=typeof t=="string"?t.split(""):t,C=[n!==void 0?v[vt(0,c)]:he(x,10,e),...a.map(T=>H()[v.indexOf(T)])];return--o<1?C.join(""):me(C,e,o,n)},ge=(t,e=16,o=1,n)=>{const c=ve(e),v=it(n!==void 0?n:+he(t[0],e,10)),x=gt(v),b=de(c,gt(vt(0,1e6,x))),a=(typeof t=="string"?t.split(""):t).slice(1,t.length).map(C=>c[b().indexOf(C)]);return--o<1?a.join(""):ge(a,e,o,n)},{textToBase64:ur,base64ToText:fr,secureBase64:lr}=et;function pe(t,e=1,o){return typeof t=="object"?t=ae(t):typeof t!="string"&&(t=kt(t)),me(lr(ur(t)),64,e,o)}function hr(t,e=1,o,n=!0){if(t=fr(ge(t,64,e,o)),!n)return t;try{return JSON.parse(t)}catch{return t}}function vr(t,e=512,o){const n=pe(t,1,o).substring(1);return e==="MD5"?ir(n).toString():oe(n,{outputLength:e}).toString()}const dr={e:pe,d:hr,h:vr},mr=new Map([["THINKING","Please wait, I am answering another question..."]]);function gr(t,e){switch(t){case"model":if(["gpt3","gpt4","gpt-web","claude-2-web","gpt3-fga"].includes(e))return!0;break;case"temperature":if(typeof e=="number"&&e>=0&&e<=1)return!0;break;case"context":if(typeof e=="boolean")return!0;break}return!1}function pr(t){try{return JSON.parse(t)}catch{return t}}function ye(t){try{const e={};for(const o in t){const n=pr(t[o]);gr(o,n)&&(e[o]=n)}return e}catch{return{}}}function yr(t){try{return ye(Xt.parse(t))}catch{return{}}}function wr(t){try{return Xt.stringify(ye(t))}catch{return""}}let It,Qt="";const we=z(),qt=z(!1),_e=z(""),Y=z("gpt4"),rt=z(!0),L=z(.5),q=z([]),F=z([]);tt(qt,t=>{t||U()});const _r=t=>{qt.value=!0,we.value=t,_e.value=t.Q,setTimeout(()=>xe(),0)};function xe(){try{document.querySelector(".EditMessageInput textarea").focus()}catch{}}const U=()=>{try{document.querySelector(".InputBox textarea").focus()}catch{}},nt=()=>new Promise((t,e)=>{$fetch("/api/curva/check",{method:"POST"}).then(o=>{const{list:n,saved:c}=o;F.value=n.sort().map(v=>{var x,b,H;return{id:v,name:(x=c[v])==null?void 0:x.name,config:((b=c[v])==null?void 0:b.config)||"",mtime:((H=c[v])==null?void 0:H.mtime)||0}}).sort((v,x)=>v.mtime-x.mtime).reverse(),t(!0)}).catch(o=>{N.error("Initialization Failed"),e(o)})}),xr=t=>new Promise(async(e,o)=>{if(t==null)return e([]);const n=await $fetch("/api/curva/history",{method:"POST",body:{id:t}});(!n||n.length===0)&&mt("/c/");try{e(n.map(c=>Vt({...c,t:new Date(c.t),done:!!c.A})))}catch{mt("/c/"),e([])}}),Se=async function(t){return[]},Sr=async()=>{try{const t=q.value.at(-1),e=await Se(t.Q),o=bt()>=document.body.clientHeight;t.more=e,o&&X()}catch(t){console.error(t)}},Wt=(t=!1)=>{Y.value="gpt4",rt.value=!0,L.value=.5,t&&N.success("Conversation settings have been reset.")};Wt();const K=z(!1),ot=z(K.value),at=z(K.value),ht=z(""),Cr=Re(()=>Y.value.startsWith("gpt3")?16e3:32e3),Br=(()=>{const{h:t}=dr,e=()=>[77,68,53].map(c=>String.fromCharCode(c)).join(""),o=(c,v)=>({hash:t(c,e(),v),timestamp:kt(v)}),n=(c,v,x,b,H,a)=>{let C=D();return C||(C=fe.base64(8),F.value.push({id:C,name:void 0}),mt(`/c/${C}?feature=new`)),{conv:C,messages:c,model:v,temperature:x,t:b,tz:H,id:a}};return async c=>{const v=new Date,x=v.getTime(),b=v.getTimezoneOffset()/60*-1,H=(()=>{if(!rt.value)return[{role:"user",content:(c==null?void 0:c.Q)||""}];const a=q.value.lastIndexOf(c)+1||q.value.length;let C=q.value.slice(0,a);return C=C.slice(C.length-100),C.map(T=>[{role:"user",content:T.Q},{role:"assistant",content:T.A}].filter(m=>m.content)).flat()})();try{const a=n(H,Y.value,L.value,x,b,c==null?void 0:c.id),C=o(H,x);return await $fetch("/api/curva/answer",{method:"POST",headers:C,body:a})}catch{return{answer:"",error:"Error while sending request."}}}})(),br=(t="",e="",o=!1)=>Vt({done:o,Q:t,A:e,queries:[],urls:[],dt:void 0,t:new Date}),dt=new Set,Ar=()=>{F.value=[],q.value=[],mt("/c/"),Tt=!0};let Tt=!0;function Gt(){{const t=We();t.get("feature")==="new"&&(t.delete("feature"),t.save())}}const Ce=(t,e)=>{const o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),o.remove()},D=()=>{var t,e;return(e=(t=It._route)==null?void 0:t.params)==null?void 0:e.conv},st=()=>{var e;const t=D();return((e=F.value.filter(o=>o.id===t)[0])==null?void 0:e.name)||""};async function Be(t,e){return await $fetch("/api/curva/conv",{method:"PUT",body:{id:t||D(),name:e||st(),config:wr({model:Y.value,temperature:L.value,context:rt.value})}})}let Et=!1;const Tr=t=>{var n;if(t===void 0&&(t=D()),t==null)return;const e=yr(((n=F.value.filter(c=>c.id===t)[0])==null?void 0:n.config)||""),o=Object.keys(e);if(o.length===0)Wt();else{Et=!0;try{for(const c of o){const v=e[c];switch(c){case"model":Y.value=v;break;case"temperature":L.value=v;break;case"context":rt.value=v;break}}}finally{Et=!1}}N.info("Conversation settings have been loaded.")};setTimeout(()=>{let t;[Y,rt,L].forEach(e=>{tt(e,(o,n)=>{It&&!Et&&o!==n&&dt.size===0&&(clearTimeout(t),t=setTimeout(async()=>{try{await Be(),N.info("Conversation settings have been saved.")}catch(c){console.error(c),N.warning("Failed to save conversation settings.")}finally{clearTimeout(t)}},typeof e.value=="number"?500:0))})})},1e3);const Er=t=>{q.value=q.value.filter(e=>e.id!==t),$fetch("/api/curva/answer",{method:"DELETE",body:{conv:D(),id:t}}).then(()=>N.info("The message has been deleted.")).catch(()=>N.error("An error occurred while deleting the message."))},Hr=()=>{let t=0;const e=`${et.convert(D(),"64w",10)}.md`,o=q.value.map(n=>{t++;try{return(n.t?`${new Date(n.t.getTime()-(n.dt||0)).toLocaleString()}${n.dt===void 0?"":" (Î”t: "+n.dt.toString()+"ms)"}

`:"")+(n.Q?`QUESTION ${t}:

${n.Q.replaceAll(`
`,`

`)}`:"")+(n.Q&&n.A?`

`:"")+(n.A?`ANSWER ${t}:

${n.A}`:"")}catch{return"(Unknown message)"}}).join(`

---

`)+`

---

`;Ce(e,o)},kr=()=>{Ce(`${et.convert(D(),"64w",10)}.json`,JSON.stringify(q.value.map(t=>({question:t.Q,answer:t.A,created:new Date(t.t.getTime()).toUTCString(),timeUsed:t.dt||void 0,queries:t.queries||void 0,urls:t.urls||void 0})),null,4))};function Nr(){const t=Ot("appName").value,e=$e(),o=+(e.has(wt)?e.get(wt):.5);e.delete(Mt,{path:"/"}),e.delete(Mt),e.delete(Lt,{path:"/"}),e.delete(Lt),o>=0&&o<=1&&(L.value=o),tt(L,m=>{L.value=Math.round(m*10)/10,e.set(wt,`${m}`,{path:"/"})}),It=qe(),tt(K,m=>{jt().isMobileScreen?(ot.value=!1,at.value!==m&&(at.value=m)):(at.value=!1,ot.value!==m&&(ot.value=m)),setTimeout(()=>{try{U()}catch{}},0)}),tt(at,m=>{K.value=m}),tt(ot,m=>{K.value=m});const n=async m=>{jt().isMobileScreen&&(K.value=!1),q.value=[];const B=pt.service();try{const S=await Promise.all([m===null&&F.value.length>0?null:nt(),m===null?null:xr(m)]);Tr(m);const g=S[1];g!==null&&D()===m&&(q.value=g,Sr())}finally{try{ut(`${st()||"Chat"} - ${t}`)}catch{ut(`Chat - ${t}`)}if(X(),B!==null)try{await X(500)}finally{B.close();try{await X(500)}finally{}}}setTimeout(()=>U(),500)},c=async(m,B=!1)=>{const S=Promise.all([...dt]),g=Tt&&B?new Promise(async i=>{await n(m),Gt(),i(null)}):B?new Promise(i=>i(null)):n(m);Tt=!1,dt.add(g);try{await S}catch{}try{await g}finally{dt.delete(g)}},v=Ie().t,x=Ot("version"),b=async(m,B)=>{if(document.querySelectorAll(".Message.T").length>0)return N.info("Please wait for the completion of the previous question."),U(),!1;const g=(m!==void 0?m:ht.value).trim();if(m===void 0&&(ht.value="",g===""))return U(),!1;const i=(B?q.value.filter(I=>I.id===B).at(-1):void 0)||br(g,"",!1);q.value.includes(i)||q.value.push(i),i.done=!1,i.Q=g,i.A="",i.urls=[],i.queries=[];const _=Se(),r=bt()>=document.body.clientHeight,u=D();r&&X().finally(()=>U());const d=await Br(i);Gt(),Qt!==u&&(Qt=u,nt().then(()=>{try{document.querySelector(".ConversationList").scrollTop=0}catch{}}));const{id:p,answer:w="",error:y,urls:k=[],queries:A=[],dt:E=0,version:R}=d;i.done=!0,i.t=new Date,i.dt=E||void 0,i.id=p||void 0,i.A=w||"",i.urls=k||[],i.queries=A||[];const $=(I=>I?(I.type==="warning"?N.warning(I.content):N.error(I.content),i.A="Oops! Something went wrong!",!0):!1)((()=>{if(w===""){if(y){const I=q.value.indexOf(i);switch(y){case"THINKING":return q.value.splice(I,1),ht.value=g,{type:"warning",content:mr.get(y)};default:return{type:"error",content:y}}}return{type:"error",content:v("error.plzRefresh")}}})());return setTimeout(async()=>{!B&&r&&await X(),R&&R!==x.value&&yt.confirm(v("action.newVersion"),v("message.notice"),{confirmButtonText:v("message.ok"),cancelButtonText:v("message.cancel"),type:"warning"}).then(()=>{const I=pt.service();location.reload(),setTimeout(()=>I.close(),3e3)}).catch(()=>U())},0),_.then(I=>{const O=bt()>=document.body.clientHeight;i.more=I,O&&X()}),$};return{isEditingMessage:qt,editingMessage:we,callEditMessageDialog:_r,editingMessageContent:_e,focusEditMessageInput:xe,model:Y,conversations:F,messages:q,temperature:L,contextMode:rt,openMenu:K,openSidebar:ot,openDrawer:at,inputValue:ht,inputMaxLength:Cr,getCurrentConvId:D,getCurrentConvName:st,checkTokenAndGetConversations:nt,loadChat:c,sendMessage:b,deleteMessage:Er,regenerateMessage:async m=>{if(q.value.length===0)return;const{Q:B,id:S}=m||q.value.at(-1);b(B||"",S)},focusInput:U,refreshConversation:()=>{c(D())},renameConversation:(m,B="")=>{m||(m=D(),B=st()),yt.prompt(v("message.renameConvHint"),v("message.setting"),{confirmButtonText:v("message.ok"),cancelButtonText:v("message.cancel"),inputValue:B,inputPlaceholder:et.convert(m,"64w",10)}).then(async({value:S})=>{try{await Be(m,S),N({type:"success",message:v("message.renameSuccess")}),await nt();try{ut(`${st()||"Chat"} - ${t}`)}catch{ut(`Chat - ${t}`)}}catch{N({type:"error",message:"Oops! Something went wrong!"})}}).catch(()=>{})},deleteConversation:m=>{var _,r;const B=m||D(),S=[...F.value];let g=-1,i="createNewChat";for(let u=0;u<S.length;u++)if(S[u].id===B){g=u;break}if(g!==-1){const u=(_=S[g-1])==null?void 0:_.id,d=(r=S[g+1])==null?void 0:r.id;u!==void 0?i=u:d!==void 0&&(i=d)}yt.confirm(v("message.deleteConvConfirm"),v("message.warning"),{confirmButtonText:v("message.ok"),cancelButtonText:v("message.cancel"),type:"warning"}).then(()=>{const u=pt.service();$fetch("/api/curva/conv",{method:"DELETE",body:{id:B}}).finally(async()=>{var d;u.close(),m===D()?(d=document.getElementById(i))==null||d.click():await nt()})})},resetConvConfig:Wt,exportAsMarkdown:Hr,exportAsJson:kr,clear:Ar}}export{X as a,et as b,jt as c,fe as r,Nr as u};
