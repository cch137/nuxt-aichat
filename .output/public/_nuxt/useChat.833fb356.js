var Be=Object.defineProperty;var Ae=(t,e,o)=>e in t?Be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var it=(t,e,o)=>(Ae(t,typeof e!="symbol"?e+"":e,o),o);import{ce as It,cf as Ee,cg as ke,ch as He,ci as Ie,cj as J,r as D,h as st,aa as Xt,W as Re,E as q,i as Nt,ck as We,D as Pe,g as Oe,A as dt,cl as At,V as X,z as yt,l as Kt,cm as $e}from"./entry.ff63ec3d.js";import{E as wt}from"./el-overlay.a7bd9125.js";import"./el-button.b5ba1a02.js";import"./el-input.e7860a8b.js";import{u as Le}from"./useAuth.3e981d6c.js";import{u as Mt}from"./useTitle.5af2f9bf.js";var De=Ee,qe=ke,ze=He,Ne={formats:ze,parse:qe,stringify:De};const Jt=It(Ne),Me={get isMobileScreen(){return window.innerWidth<600},get isTouchScreen(){return"ontouchstart"in document||navigator.maxTouchPoints>0}};function pt(){return Me}var Yt={exports:{}};function Fe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xt={exports:{}},Ft;function Rt(){return Ft||(Ft=1,function(t,e){(function(o,r){t.exports=r()})(J,function(){var o=o||function(r,h){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),typeof self<"u"&&self.crypto&&(m=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(m=globalThis.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof J<"u"&&J.crypto&&(m=J.crypto),!m&&typeof Fe=="function")try{m=Ie}catch{}var y=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},A=Object.create||function(){function n(){}return function(l){var d;return n.prototype=l,d=new n,n.prototype=null,d}}(),I={},a=I.lib={},C=a.Base=function(){return{extend:function(n){var l=A(this);return n&&l.mixIn(n),(!l.hasOwnProperty("init")||this.init===l.init)&&(l.init=function(){l.$super.init.apply(this,arguments)}),l.init.prototype=l,l.$super=this,l},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var l in n)n.hasOwnProperty(l)&&(this[l]=n[l]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),b=a.WordArray=C.extend({init:function(n,l){n=this.words=n||[],l!=h?this.sigBytes=l:this.sigBytes=n.length*4},toString:function(n){return(n||_).stringify(this)},concat:function(n){var l=this.words,d=n.words,p=this.sigBytes,x=n.sigBytes;if(this.clamp(),p%4)for(var g=0;g<x;g++){var W=d[g>>>2]>>>24-g%4*8&255;l[p+g>>>2]|=W<<24-(p+g)%4*8}else for(var T=0;T<x;T+=4)l[p+T>>>2]=d[T>>>2];return this.sigBytes+=x,this},clamp:function(){var n=this.words,l=this.sigBytes;n[l>>>2]&=4294967295<<32-l%4*8,n.length=r.ceil(l/4)},clone:function(){var n=C.clone.call(this);return n.words=this.words.slice(0),n},random:function(n){for(var l=[],d=0;d<n;d+=4)l.push(y());return new b.init(l,n)}}),B=I.enc={},_=B.Hex={stringify:function(n){for(var l=n.words,d=n.sigBytes,p=[],x=0;x<d;x++){var g=l[x>>>2]>>>24-x%4*8&255;p.push((g>>>4).toString(16)),p.push((g&15).toString(16))}return p.join("")},parse:function(n){for(var l=n.length,d=[],p=0;p<l;p+=2)d[p>>>3]|=parseInt(n.substr(p,2),16)<<24-p%8*4;return new b.init(d,l/2)}},S=B.Latin1={stringify:function(n){for(var l=n.words,d=n.sigBytes,p=[],x=0;x<d;x++){var g=l[x>>>2]>>>24-x%4*8&255;p.push(String.fromCharCode(g))}return p.join("")},parse:function(n){for(var l=n.length,d=[],p=0;p<l;p++)d[p>>>2]|=(n.charCodeAt(p)&255)<<24-p%4*8;return new b.init(d,l)}},w=B.Utf8={stringify:function(n){try{return decodeURIComponent(escape(S.stringify(n)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(n){return S.parse(unescape(encodeURIComponent(n)))}},f=a.BufferedBlockAlgorithm=C.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(n){typeof n=="string"&&(n=w.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(n){var l,d=this._data,p=d.words,x=d.sigBytes,g=this.blockSize,W=g*4,T=x/W;n?T=r.ceil(T):T=r.max((T|0)-this._minBufferSize,0);var k=T*g,R=r.min(k*4,x);if(k){for(var H=0;H<k;H+=g)this._doProcessBlock(p,H);l=p.splice(0,k),d.sigBytes-=R}return new b.init(l,R)},clone:function(){var n=C.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0});a.Hasher=f.extend({cfg:C.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){n&&this._append(n);var l=this._doFinalize();return l},blockSize:16,_createHelper:function(n){return function(l,d){return new n.init(d).finalize(l)}},_createHmacHelper:function(n){return function(l,d){return new v.HMAC.init(n,d).finalize(l)}}});var v=I.algo={};return I}(Math);return o})}(xt)),xt.exports}var _t={exports:{}},Ut;function Ue(){return Ut||(Ut=1,function(t,e){(function(o,r){t.exports=r(Rt())})(J,function(o){return function(r){var h=o,m=h.lib,y=m.Base,A=m.WordArray,I=h.x64={};I.Word=y.extend({init:function(a,C){this.high=a,this.low=C}}),I.WordArray=y.extend({init:function(a,C){a=this.words=a||[],C!=r?this.sigBytes=C:this.sigBytes=a.length*8},toX32:function(){for(var a=this.words,C=a.length,b=[],B=0;B<C;B++){var _=a[B];b.push(_.high),b.push(_.low)}return A.create(b,this.sigBytes)},clone:function(){for(var a=y.clone.call(this),C=a.words=this.words.slice(0),b=C.length,B=0;B<b;B++)C[B]=C[B].clone();return a}})}(),o})}(_t)),_t.exports}(function(t,e){(function(o,r,h){t.exports=r(Rt(),Ue())})(J,function(o){return function(r){var h=o,m=h.lib,y=m.WordArray,A=m.Hasher,I=h.x64,a=I.Word,C=h.algo,b=[],B=[],_=[];(function(){for(var f=1,v=0,n=0;n<24;n++){b[f+5*v]=(n+1)*(n+2)/2%64;var l=v%5,d=(2*f+3*v)%5;f=l,v=d}for(var f=0;f<5;f++)for(var v=0;v<5;v++)B[f+5*v]=v+(2*f+3*v)%5*5;for(var p=1,x=0;x<24;x++){for(var g=0,W=0,T=0;T<7;T++){if(p&1){var k=(1<<T)-1;k<32?W^=1<<k:g^=1<<k-32}p&128?p=p<<1^113:p<<=1}_[x]=a.create(g,W)}})();var S=[];(function(){for(var f=0;f<25;f++)S[f]=a.create()})();var w=C.SHA3=A.extend({cfg:A.cfg.extend({outputLength:512}),_doReset:function(){for(var f=this._state=[],v=0;v<25;v++)f[v]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(f,v){for(var n=this._state,l=this.blockSize/2,d=0;d<l;d++){var p=f[v+2*d],x=f[v+2*d+1];p=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360;var g=n[d];g.high^=x,g.low^=p}for(var W=0;W<24;W++){for(var T=0;T<5;T++){for(var k=0,R=0,H=0;H<5;H++){var g=n[T+5*H];k^=g.high,R^=g.low}var U=S[T];U.high=k,U.low=R}for(var T=0;T<5;T++)for(var j=S[(T+4)%5],G=S[(T+1)%5],F=G.high,Q=G.low,k=j.high^(F<<1|Q>>>31),R=j.low^(Q<<1|F>>>31),H=0;H<5;H++){var g=n[T+5*H];g.high^=k,g.low^=R}for(var E=1;E<25;E++){var k,R,g=n[E],O=g.high,N=g.low,s=b[E];s<32?(k=O<<s|N>>>32-s,R=N<<s|O>>>32-s):(k=N<<s-32|O>>>64-s,R=O<<s-32|N>>>64-s);var i=S[B[E]];i.high=k,i.low=R}var c=S[0],u=n[0];c.high=u.high,c.low=u.low;for(var T=0;T<5;T++)for(var H=0;H<5;H++){var E=T+5*H,g=n[E],nt=S[E],ot=S[(T+1)%5+5*H],at=S[(T+2)%5+5*H];g.high=nt.high^~ot.high&at.high,g.low=nt.low^~ot.low&at.low}var g=n[0],Z=_[W];g.high^=Z.high,g.low^=Z.low}},_doFinalize:function(){var f=this._data,v=f.words;this._nDataBytes*8;var n=f.sigBytes*8,l=this.blockSize*32;v[n>>>5]|=1<<24-n%32,v[(r.ceil((n+1)/l)*l>>>5)-1]|=128,f.sigBytes=v.length*4,this._process();for(var d=this._state,p=this.cfg.outputLength/8,x=p/8,g=[],W=0;W<x;W++){var T=d[W],k=T.high,R=T.low;k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,g.push(R),g.push(k)}return new y.init(g,p)},clone:function(){for(var f=A.clone.call(this),v=f._state=this._state.slice(0),n=0;n<25;n++)v[n]=v[n].clone();return f}});h.SHA3=A._createHelper(w),h.HmacSHA3=A._createHmacHelper(w)}(Math),o.SHA3})})(Yt);var je=Yt.exports;const Zt=It(je);var te={exports:{}};(function(t,e){(function(o,r){t.exports=r(Rt())})(J,function(o){return function(r){var h=o,m=h.lib,y=m.WordArray,A=m.Hasher,I=h.algo,a=[];(function(){for(var w=0;w<64;w++)a[w]=r.abs(r.sin(w+1))*4294967296|0})();var C=I.MD5=A.extend({_doReset:function(){this._hash=new y.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(w,f){for(var v=0;v<16;v++){var n=f+v,l=w[n];w[n]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}var d=this._hash.words,p=w[f+0],x=w[f+1],g=w[f+2],W=w[f+3],T=w[f+4],k=w[f+5],R=w[f+6],H=w[f+7],U=w[f+8],j=w[f+9],G=w[f+10],F=w[f+11],Q=w[f+12],E=w[f+13],O=w[f+14],N=w[f+15],s=d[0],i=d[1],c=d[2],u=d[3];s=b(s,i,c,u,p,7,a[0]),u=b(u,s,i,c,x,12,a[1]),c=b(c,u,s,i,g,17,a[2]),i=b(i,c,u,s,W,22,a[3]),s=b(s,i,c,u,T,7,a[4]),u=b(u,s,i,c,k,12,a[5]),c=b(c,u,s,i,R,17,a[6]),i=b(i,c,u,s,H,22,a[7]),s=b(s,i,c,u,U,7,a[8]),u=b(u,s,i,c,j,12,a[9]),c=b(c,u,s,i,G,17,a[10]),i=b(i,c,u,s,F,22,a[11]),s=b(s,i,c,u,Q,7,a[12]),u=b(u,s,i,c,E,12,a[13]),c=b(c,u,s,i,O,17,a[14]),i=b(i,c,u,s,N,22,a[15]),s=B(s,i,c,u,x,5,a[16]),u=B(u,s,i,c,R,9,a[17]),c=B(c,u,s,i,F,14,a[18]),i=B(i,c,u,s,p,20,a[19]),s=B(s,i,c,u,k,5,a[20]),u=B(u,s,i,c,G,9,a[21]),c=B(c,u,s,i,N,14,a[22]),i=B(i,c,u,s,T,20,a[23]),s=B(s,i,c,u,j,5,a[24]),u=B(u,s,i,c,O,9,a[25]),c=B(c,u,s,i,W,14,a[26]),i=B(i,c,u,s,U,20,a[27]),s=B(s,i,c,u,E,5,a[28]),u=B(u,s,i,c,g,9,a[29]),c=B(c,u,s,i,H,14,a[30]),i=B(i,c,u,s,Q,20,a[31]),s=_(s,i,c,u,k,4,a[32]),u=_(u,s,i,c,U,11,a[33]),c=_(c,u,s,i,F,16,a[34]),i=_(i,c,u,s,O,23,a[35]),s=_(s,i,c,u,x,4,a[36]),u=_(u,s,i,c,T,11,a[37]),c=_(c,u,s,i,H,16,a[38]),i=_(i,c,u,s,G,23,a[39]),s=_(s,i,c,u,E,4,a[40]),u=_(u,s,i,c,p,11,a[41]),c=_(c,u,s,i,W,16,a[42]),i=_(i,c,u,s,R,23,a[43]),s=_(s,i,c,u,j,4,a[44]),u=_(u,s,i,c,Q,11,a[45]),c=_(c,u,s,i,N,16,a[46]),i=_(i,c,u,s,g,23,a[47]),s=S(s,i,c,u,p,6,a[48]),u=S(u,s,i,c,H,10,a[49]),c=S(c,u,s,i,O,15,a[50]),i=S(i,c,u,s,k,21,a[51]),s=S(s,i,c,u,Q,6,a[52]),u=S(u,s,i,c,W,10,a[53]),c=S(c,u,s,i,G,15,a[54]),i=S(i,c,u,s,x,21,a[55]),s=S(s,i,c,u,U,6,a[56]),u=S(u,s,i,c,N,10,a[57]),c=S(c,u,s,i,R,15,a[58]),i=S(i,c,u,s,E,21,a[59]),s=S(s,i,c,u,T,6,a[60]),u=S(u,s,i,c,F,10,a[61]),c=S(c,u,s,i,g,15,a[62]),i=S(i,c,u,s,j,21,a[63]),d[0]=d[0]+s|0,d[1]=d[1]+i|0,d[2]=d[2]+c|0,d[3]=d[3]+u|0},_doFinalize:function(){var w=this._data,f=w.words,v=this._nDataBytes*8,n=w.sigBytes*8;f[n>>>5]|=128<<24-n%32;var l=r.floor(v/4294967296),d=v;f[(n+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,f[(n+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,w.sigBytes=(f.length+1)*4,this._process();for(var p=this._hash,x=p.words,g=0;g<4;g++){var W=x[g];x[g]=(W<<8|W>>>24)&16711935|(W<<24|W>>>8)&4278255360}return p},clone:function(){var w=A.clone.call(this);return w._hash=this._hash.clone(),w}});function b(w,f,v,n,l,d,p){var x=w+(f&v|~f&n)+l+p;return(x<<d|x>>>32-d)+f}function B(w,f,v,n,l,d,p){var x=w+(f&n|v&~n)+l+p;return(x<<d|x>>>32-d)+f}function _(w,f,v,n,l,d,p){var x=w+(f^v^n)+l+p;return(x<<d|x>>>32-d)+f}function S(w,f,v,n,l,d,p){var x=w+(v^(f|~n))+l+p;return(x<<d|x>>>32-d)+f}h.MD5=A._createHelper(C),h.HmacMD5=A._createHmacHelper(C)}(Math),o.MD5})})(te);var Ge=te.exports;const Qe=It(Ge),gt=t=>{try{if((t==null?void 0:t.toString)===void 0)return`${t}`;{const e=t.toString();return e.startsWith("[object ")&&e.endsWith("]")?JSON.stringify(t):e}}catch{return""}},Ve=t=>gt(t).toLowerCase();function Xe(t){try{return typeof t[Symbol==null?void 0:Symbol.iterator]=="function"}catch{return!1}}function ee(t){const e=new Set;return JSON.stringify(t,(r,h)=>{if(typeof h=="object"&&h!==null){if(e.has(h))return;e.add(h),Xe(h)&&(h=[...h])}return h})}const re="01",ne="0123456789",oe="0123456789abcdef",ae="0123456789abcdefghijklmnopqrstuvwxyz",se="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Et=t=>{switch(typeof t!="string"&&(t=Ve(t)),t){case"2":return re;case"10":return ne;case"16":return oe;case"36":return ae;case"62":return se;case"64":return Y;case"64w":case"64+":return ie;default:return t}},Ke=(t,e,o,r=0)=>{typeof t!="string"&&(t=gt(t));let h=BigInt(0);e=Et(e);const m=e.length;for(let A=0;A<t.length;A++)h+=BigInt(e.indexOf(t[A])*Math.pow(m,t.length-1-A));let y="";if(o=Et(o),y===""){const A=BigInt(o.length);for(;h>0;)y=o.charAt(+BigInt(h%A).toString())+y,h=BigInt(h/A)}return(y===""?o.charAt(0):y).padStart(r,o[0])},Je=t=>{const e=t.split("").map(m=>m.charCodeAt(0)),o=[];let r=0;for(;r<e.length;){const[m,y=0,A=0]=e.slice(r,r+=3),I=(m<<16)+(y<<8)+A,a=I>>18,C=I>>12&63,b=I>>6&63,B=I&63;o.push(Y[a],Y[C],Y[b],Y[B])}const h=e.length%3;return o.join("").slice(0,1+o.length-h)+(h===2?"==":h===1?"=":"")},Ye=/[^A-Za-z0-9+/]/g,ce=t=>t.replace(Ye,""),St=t=>String.fromCharCode(+t),Ze=t=>{const e=ce(t).split(""),o=[];let r=0;for(;r<e.length;){const[h,m,y,A]=e.slice(r,r+=4).map(I=>Y.indexOf(I));o.push(St(h<<2|m>>4)),y!==64&&o.push(St((m&15)<<4|y>>2)),A!==64&&o.push(St((y&3)<<6|A))}return o.join("").replaceAll("\0","")},tt={BASE2_CHARSET:re,BASE10_CHARSET:ne,BASE16_CHARSET:oe,BASE36_CHARSET:ae,BASE62_CHARSET:se,BASE64_CHARSET:Y,BASE64WEB_CHARSET:ie,convert:Ke,getCharset:Et,secureBase64:ce,textToBase64:Je,base64ToText:Ze};function tr(...t){return t.reduce((e,o)=>e+o,0)}const er=t=>Zt(t,{outputLength:256}).toString(),rr=/0b[0-1]+/i;function mt(t){if(typeof t=="number")return Math.round(t);if(t instanceof Object&&(t=ee(t)),typeof t=="string"){if(rr.test(t))return parseInt(t.substring(2,t.length-1),2);const e=parseInt(t);return Number.isNaN(e)?e:tr(parseInt(er(t),16))}else return Date.now()}const $=624,ct=397,nr=2567483615,Ct=2147483648,Tt=2147483647;class or{constructor(e){it(this,"mt",new Array($));it(this,"mti",$+1);it(this,"seed");return this.seed=e=mt(e),Array.isArray(e)?this.init_by_array(e,e.length):this.init_seed(e),this}init_seed(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<$;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}init_by_array(e,o){let r,h,m;for(this.init_seed(19650218),r=1,h=0,m=$>o?$:o;m!==0;m--){const y=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(((y&4294901760)>>>16)*1664525<<16)+(y&65535)*1664525)+e[h]+h,this.mt[r]>>>=0,r++,h++,r>=$&&(this.mt[0]=this.mt[$-1],r=1),h>=o&&(h=0)}for(m=$-1;m!==0;m--){const y=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(((y&4294901760)>>>16)*1566083941<<16)+(y&65535)*1566083941)-r,this.mt[r]>>>=0,r++,r>=$&&(this.mt[0]=this.mt[$-1],r=1)}this.mt[0]=2147483648}random_int(){let e;const o=new Array(0,nr);if(this.mti>=$){let r;for(this.mti===$+1&&this.init_seed(5489),r=0;r<$-ct;r++)e=this.mt[r]&Ct|this.mt[r+1]&Tt,this.mt[r]=this.mt[r+ct]^e>>>1^o[e&1];for(;r<$-1;r++)e=this.mt[r]&Ct|this.mt[r+1]&Tt,this.mt[r]=this.mt[r+(ct-$)]^e>>>1^o[e&1];e=this.mt[$-1]&Ct|this.mt[0]&Tt,this.mt[$-1]=this.mt[ct-1]^e>>>1^o[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0}random_int31(){return this.random_int()>>>1}random_incl(){return this.random_int()*(1/4294967295)}random(){return this.random_int()*(1/4294967296)}random_excl(){return(this.random_int()+.5)*(1/4294967296)}random_long(){return((this.random_int()>>>5)*67108864+(this.random_int()>>>6))*(1/9007199254740992)}}function ue(t){return new or(t)}const{BASE10_CHARSET:ar,BASE16_CHARSET:sr,BASE64WEB_CHARSET:ir}=tt,cr=ue(),le=(t=cr)=>t.random(),Wt=(t,e,o)=>((e===void 0||e===0)&&(e=t,t=0),Math.floor(t+le(o)*e)),fe=(t,e)=>t[Wt(0,t.length,e)],he=(t,e=1,o)=>{const r=[],h=[];for(let m=0;m<e;m++)h.length===0&&h.push(...t),r.push(h.splice(Wt(0,h.length,o),1)[0]);return r},ur=(t,e)=>he(t,t.length,e),ut=(t,e=8,o)=>new Array(e).fill(0).map(r=>fe(t,o)).join(""),ve={MT:ue,toSeed:mt,rand:le,randInt:Wt,charset:ut,choice:fe,choices:he,shuffle:ur,base10:(t=6,e)=>ut(ar,t,e),base16:(t=32,e)=>ut(sr,t,e),base64:(t=32,e)=>ut(ir,t,e),lcg(t){let e=mt(t);return()=>(e=(e*1664525+1013904223)%4294967296)/4294967296}},{MT:jt,shuffle:lr,randInt:bt}=ve,{convert:fr,getCharset:hr}=tt,vr=(t,e)=>{const o=lr(t,e);return()=>(o.push(o.shift()),o)},de=(t,e=16,o=1,r)=>{const h=Number.isNaN(+e)?64:+e,m=hr(e),y=mt(r!==void 0?r:bt(0,h)),A=jt(y),I=vr(m,jt(bt(0,1e6,A))),a=typeof t=="string"?t.split(""):t,C=[r!==void 0?m[bt(0,h)]:fr(y,10,e),...a.map(b=>I()[m.indexOf(b)])];return--o<1?C.join(""):de(C,e,o,r)},{textToBase64:dr,base64ToText:Nr,secureBase64:pr}=tt;function mr(t,e=1,o){return typeof t=="object"?t=ee(t):typeof t!="string"&&(t=gt(t)),de(pr(dr(t)),64,e,o)}function gr(t,e=512,o){const r=mr(t,1,o).substring(1);return e==="MD5"?Qe(r).toString():Zt(r,{outputLength:e}).toString()}const yr=new Map([["THINKING","Please wait, I am answering another question..."]]);function wr(t,e){switch(t){case"model":if(["gpt3","gpt4","gpt-web","claude-2-web","gpt3-fga"].includes(e))return!0;break;case"temperature":if(typeof e=="number"&&e>=0&&e<=1)return!0;break;case"context":if(typeof e=="boolean")return!0;break}return!1}function xr(t){try{return JSON.parse(t)}catch{return t}}function pe(t){try{const e={};for(const o in t){const r=xr(t[o]);wr(o,r)&&(e[o]=r)}return e}catch{return{}}}function _r(t){try{return pe(Jt.parse(t))}catch{return{}}}function Sr(t){try{return Jt.stringify(pe(t))}catch{return""}}const Gt=[{name:"GPT-3.5-Turbo",value:"gpt3",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-4",value:"gpt4",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-Web",value:"gpt-web",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"Claude-2-Web",value:"claude-2-web",isWebBrowsingOptional:!1,isTemperatureOptional:!1,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1},{name:"GPT-3.5-Turbo (stream)",value:"gpt3-fga",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1}];let Pt,Qt="";const me=D(),Ot=D(!1),ge=D(""),K=D("gpt4"),et=D(!0),rt=D(.5),P=D([]),V=D([]);st(Ot,t=>{t||M()});const Cr=t=>{Ot.value=!0,me.value=t,ge.value=t.Q,setTimeout(()=>ye(),0)};function ye(){try{document.querySelector(".EditMessageInput textarea").focus()}catch{}}const M=()=>{try{{const t=document.querySelector(".InputBox textarea");t.click(),t.focus()}}catch{}},we=()=>{try{const t=document.getElementById(L()).parentElement,e=document.querySelector(".ConversationList"),o=t.offsetTop-e.offsetTop-t.clientHeight/2,r=o-e.clientHeight+t.clientHeight*2;e.scrollTop>o&&e.scrollTo({left:0,top:o,behavior:"smooth"}),e.scrollTop<r&&e.scrollTo({left:0,top:r,behavior:"smooth"})}catch{}},lt=()=>new Promise((t,e)=>{$fetch("/api/curva/check",{method:"POST"}).then(o=>{V.value=o,we(),t(!0)}).catch(o=>{q.error("Initialization Failed"),e(o)})}),Tr=t=>new Promise(async(e,o)=>{if(t==null)return e([]);const r=await $fetch("/api/curva/history",{method:"POST",body:{id:t}});(!r||r.length===0)&&dt("/c/");try{e(r.map(h=>Kt({...h,t:new Date(h.t),done:!!h.A})))}catch{dt("/c/"),e([])}}),xe=async function(t){return[]},br=async()=>{try{const t=P.value.at(-1),e=await xe(t.Q),o=At()>=document.body.clientHeight;t.more=e,o&&X()}catch(t){console.error(t)}},$t=(t=!1)=>{K.value="gpt4",et.value=!0,rt.value=.5,t&&q.success("Conversation settings have been reset.")};$t();const z=D(!1),Lt=D(z.value),Dt=D(z.value);st(Lt,t=>{z.value=t});st(Dt,t=>{z.value=t});st(z,t=>{const{isMobileScreen:e}=pt();Lt.value=e?!1:t,Dt.value=e?t:!1,setTimeout(()=>M(),0)});{let t,e=pt().isMobileScreen?"drawer":"sidebar";window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>{const o=pt().isMobileScreen?"drawer":"sidebar";z.value&&o!=e&&(z.value=!1,setTimeout(()=>{z.value=!0},0),e=o)},100)})}const ft=D(""),Br=Xt(()=>K.value.startsWith("gpt3")?16e3:32e3),Ar=(()=>{const t=()=>[77,68,53].map(r=>String.fromCharCode(r)).join(""),e=(r,h)=>({hash:gr(r,t(),h),timestamp:gt(h)}),o=(r,h,m,y,A,I,a)=>{let C=L();return C||(C=ve.base64(8),V.value.unshift({id:C,name:"",mtime:Date.now(),config:""}),dt(`/c/${C}?feature=new`),Se(C)),{conv:C,messages:r,model:h,temperature:m,t:y,tz:A,id:I,streamId:a}};return async(r,h)=>{const m=new Date,y=m.getTime(),A=m.getTimezoneOffset()/60*-1,I=(()=>{if(!et.value)return[{role:"user",content:(r==null?void 0:r.Q)||""}];const a=P.value.lastIndexOf(r)+1||P.value.length;let C=P.value.slice(0,a);return C=C.slice(C.length-100),C.map(b=>[{role:"user",content:b.Q},{role:"assistant",content:b.A}].filter(B=>B.content)).flat()})();try{const a=o(I,K.value,rt.value,y,A,r==null?void 0:r.id,h),C=e(I,y);return await $fetch("/api/curva/answer",{method:"POST",headers:C,body:a})}catch{return{answer:"",error:"Error while sending request."}}}})(),Er=(t="",e="",o=!1)=>Kt({done:o,Q:t,A:e,queries:[],urls:[],dt:void 0,t:new Date}),ht=new Set,Bt=()=>{V.value=[],P.value=[],dt("/c/"),kt=!0};let kt=!0;function Vt(){{const t=$e();t.get("feature")==="new"&&(t.delete("feature"),t.save(),qt())}}const _e=(t,e)=>{const o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),o.remove()},[kr,L,Se]=(()=>{const t=D("");return[Xt(()=>t.value),()=>t.value,e=>{var o,r;return t.value=e===void 0?(r=(o=Pt._route)==null?void 0:o.params)==null?void 0:r.conv:e}]})(),vt=()=>{var e;const t=L();return((e=V.value.filter(o=>o.id===t)[0])==null?void 0:e.name)||""};async function qt(t,e){return t=t||L(),t?await $fetch("/api/curva/conv",{method:"PUT",body:{id:t,name:e||vt(),config:Sr({model:K.value,temperature:rt.value,context:et.value})}}):{cancel:!0}}let Ht=!1;const Hr=t=>{var r;if(t===void 0&&(t=L()),t==null)return;const e=_r(((r=V.value.find(h=>h.id===t))==null?void 0:r.config)||""),o=Object.keys(e);if(o.length===0)$t();else{Ht=!0;try{for(const h of o){const m=e[h];switch(h){case"model":K.value=m;break;case"temperature":rt.value=m;break;case"context":et.value=m;break}}}finally{Ht=!1}}q.info("Conversation settings have been loaded.")};setTimeout(()=>{let t;[K,et,rt].forEach(e=>{st(e,(o,r)=>{Pt&&!Ht&&o!==r&&ht.size===0&&(clearTimeout(t),t=setTimeout(async()=>{try{const{cancel:h=!1}=await qt();h||q.info("Conversation settings have been saved.")}catch(h){console.error(h),q.warning("Failed to save conversation settings.")}finally{clearTimeout(t)}},typeof e.value=="number"?500:0))})})},1e3);const Ir=t=>{P.value=P.value.filter(e=>e.id!==t),$fetch("/api/curva/answer",{method:"DELETE",body:{conv:L(),id:t}}).then(()=>q.info("The message has been deleted.")).catch(()=>q.error("An error occurred while deleting the message."))},Rr=()=>{let t=0;const e=`${tt.convert(L(),"64w",10)}.md`,o=P.value.map(r=>{t++;try{return(r.t?`${new Date(r.t.getTime()-(r.dt||0)).toLocaleString()}${r.dt===void 0?"":" (Δt: "+r.dt.toString()+"ms)"}

`:"")+(r.Q?`QUESTION ${t}:

${r.Q.replaceAll(`
`,`

`)}`:"")+(r.Q&&r.A?`

`:"")+(r.A?`ANSWER ${t}:

${r.A}`:"")}catch{return"(Unknown message)"}}).join(`

---

`)+`

---

`;_e(e,o)},Wr=()=>{_e(`${tt.convert(L(),"64w",10)}.json`,JSON.stringify(P.value.map(t=>({question:t.Q,answer:t.A,created:new Date(t.t.getTime()).toUTCString(),timeUsed:t.dt||void 0,queries:t.queries||void 0,urls:t.urls||void 0})),null,4))};document.addEventListener("keyup",t=>{switch(t.key){case"/":case"Enter":M();break;case"Escape":z.value=!z.value;break}});const Ce=D(!1);document.addEventListener("scroll",()=>{Ce.value=!Re()});function Mr(){const{authEventTarget:t}=Le(),e=Nt("appName").value,o=We();["temperature-suffix","web-browsing","temperature"].forEach(_=>{o.delete(_,{path:"/"}),o.delete(_)}),Pt=Pe();const r=()=>{try{Mt(`${vt()||y("chat.title")} - ${e}`)}catch{Mt(`${y("chat.title")} - ${e}`)}};t.addListener("login",Bt),t.addListener("logout",Bt);const h=async _=>{setTimeout(()=>{pt().isMobileScreen&&(z.value=!1)},0),P.value=[];const S=yt.service({text:y("chat.ldConv")+"...",lock:!0});try{const w=_===null&&V.value.length>0?null:lt(),f=_===null?null:await Tr(_);Hr(_),f!==null&&L()===_&&(P.value=f,br()),await Promise.all([w,X(1e3)])}finally{S.close(),await X(500),M(),we(),await X(500)}},m=async(_,S=!1)=>{Se(_||"");const w=Promise.all([...ht]),f=kt&&S?new Promise(async v=>{await h(_),Vt(),v(null)}):S?new Promise(v=>v(null)):h(_);kt=!1,ht.add(f);try{await w}catch{}try{await f}finally{ht.delete(f)}},y=Oe().t,A=Nt("version"),I=async(_,S)=>{if(document.querySelectorAll(".Message.T").length>0)return q.info("Please wait for the completion of the previous question."),M(),!1;const f=(_!==void 0?_:ft.value).trim();if(_===void 0&&(ft.value="",f===""))return M(),!1;const v=(S?P.value.filter(E=>E.id===S).at(-1):void 0)||Er(f,"",!1);P.value.includes(v)||P.value.push(v);const n=v.A||"";v.done=!1,v.Q=f,v.A="",v.urls=[],v.queries=[],v.dt&&(v.dt=void 0);const l=xe(),d=At()>=document.body.clientHeight,p=L();d&&X().finally(()=>M());const x=1;let g=!1;const W=await new Promise(async E=>{var at;if(!((at=Gt.find(Z=>Z.value===K.value))!=null&&at.isStreamAvailable))return E(void 0);const O=[],N=setInterval(()=>{O.length?(v.A+=O.shift(),d&&X(0,"instant")):v.done&&clearInterval(N)},x),s=new AbortController,i=await fetch("/api/curva/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:"{}",signal:s.signal}),c=new TextDecoder,u=i.body.getReader();let nt=!1;const ot=async()=>{await u.read().then(async({value:Z,done:Te})=>{if(Te){if(O.length===0){v.done=!0;return}g=!0;const be=setInterval(()=>{O.length===0&&(v.done=!0,g=!1,clearInterval(be))},x);return}const zt=c.decode(Z);nt?O.push(zt):(E(zt),nt=!0),ot()})};ot()}),T=await Ar(v,W);Vt(),Qt!==p&&lt().finally(()=>{Qt=L()});const{id:k,answer:R="",error:H,urls:U=[],queries:j=[],dt:G=0,version:F}=T;if(g){const E=setInterval(()=>{g||(v.done=!0,v.A!==R&&(v.A=R||""),clearInterval(E))},x)}v.t=new Date,v.dt=G||void 0,v.id=k||void 0,v.urls=U||[],v.queries=j||[];const Q=(E=>E?(E.type==="warning"?q.warning(E.content):q.error(E.content),v.A="Oops! Something went wrong!",!0):!1)((()=>{if(R===""){if(H){const E=()=>{S?v.A=n:(P.value.pop(),ft.value=f)};if(typeof H=="string"&&H.startsWith("You have tried too many times."))return E(),{type:"warning",content:H};switch(H){case"THINKING":return E(),{type:"warning",content:yr.get(H)};default:return{type:"error",content:H}}}return{type:"error",content:y("error.plzRefresh")}}})());return setTimeout(async()=>{if(!S&&d&&await X(),F&&F!==A.value){const E=setTimeout(()=>location.reload(),3e3);wt.confirm(y("action.newVersion"),y("message.notice"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),type:"warning"}).then(()=>M()).catch(()=>M()).finally(()=>{clearTimeout(E),yt.service({text:"Loading...",lock:!0}),location.reload()})}},0),l.then(E=>{const O=At()>=document.body.clientHeight;v.more=E,O&&X()}),Q};return{models:Gt,showScrollToBottomButton:Ce,isEditingMessage:Ot,editingMessage:me,callEditMessageDialog:Cr,editingMessageContent:ge,focusEditMessageInput:ye,model:K,conversations:V,messages:P,temperature:rt,contextMode:et,openMenu:z,openSidebarController:Lt,openDrawerController:Dt,inputValue:ft,inputMaxLength:Br,currentConvIdComputed:kr,getCurrentConvId:L,getCurrentConvName:vt,checkTokenAndGetConversations:lt,loadChat:m,sendMessage:I,deleteMessage:Ir,regenerateMessage:async _=>{if(P.value.length===0)return;const{Q:S,id:w}=_||P.value.pop();I(S||"",w)},focusInput:M,refreshConversation:()=>{m(L()).finally(()=>M())},renameConversation:(_,S="")=>{_||(_=L(),S=vt()),wt.prompt(y("message.renameConvHint"),y("message.setting"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),inputValue:S,inputPlaceholder:tt.convert(_,"64w",10)}).then(async({value:w})=>{try{await qt(_,w),q({type:"success",message:y("message.renameSuccess")}),await lt(),r()}catch{q({type:"error",message:"Oops! Something went wrong!"})}}).catch(()=>{})},deleteConversation:_=>{const S=_||L();let w="createNewChat";wt.confirm(y("message.deleteConvConfirm"),y("message.warning"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),type:"warning"}).then(async()=>{var l;const f=yt.service({text:y("chat.dltConv")+"...",lock:!0});try{await $fetch("/api/curva/conv",{method:"DELETE",body:{id:S}})}catch{}f.close();const v=L();_===v&&((l=document.getElementById(w))==null||l.click());const n=V.value.findIndex(d=>d.id===v);n!=-1&&V.value.splice(n,1)})},resetConvConfig:$t,exportAsMarkdown:Rr,exportAsJson:Wr,clear:Bt}}export{tt as b,ve as r,gt as s,Mr as u};
