var Be=Object.defineProperty;var Ae=(t,e,o)=>e in t?Be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var it=(t,e,o)=>(Ae(t,typeof e!="symbol"?e+"":e,o),o);import{ce as It,cf as Ee,cg as ke,ch as He,ci as Ie,cj as J,r as D,h as st,aa as Xt,W as Re,E as q,i as Nt,ck as We,D as Pe,g as Oe,A as dt,cl as At,V as X,z as yt,l as Kt,cm as $e}from"./entry.d1e3684b.js";import{E as wt}from"./el-overlay.1ebd4c33.js";import"./el-button.eb1997dd.js";import"./el-input.e0400057.js";import{u as Le}from"./useAuth.28693f52.js";import{u as Mt}from"./useTitle.dc0e9d98.js";var De=Ee,qe=ke,ze=He,Ne={formats:ze,parse:qe,stringify:De};const Jt=It(Ne),Me={get isMobileScreen(){return window.innerWidth<600},get isTouchScreen(){return"ontouchstart"in document||navigator.maxTouchPoints>0}};function pt(){return Me}var Yt={exports:{}};function Fe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xt={exports:{}},Ft;function Rt(){return Ft||(Ft=1,function(t,e){(function(o,r){t.exports=r()})(J,function(){var o=o||function(r,v){var m;if(typeof window<"u"&&window.crypto&&(m=window.crypto),typeof self<"u"&&self.crypto&&(m=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(m=globalThis.crypto),!m&&typeof window<"u"&&window.msCrypto&&(m=window.msCrypto),!m&&typeof J<"u"&&J.crypto&&(m=J.crypto),!m&&typeof Fe=="function")try{m=Ie}catch{}var y=function(){if(m){if(typeof m.getRandomValues=="function")try{return m.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof m.randomBytes=="function")try{return m.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},A=Object.create||function(){function n(){}return function(f){var d;return n.prototype=f,d=new n,n.prototype=null,d}}(),R={},a=R.lib={},C=a.Base=function(){return{extend:function(n){var f=A(this);return n&&f.mixIn(n),(!f.hasOwnProperty("init")||this.init===f.init)&&(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var f in n)n.hasOwnProperty(f)&&(this[f]=n[f]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),b=a.WordArray=C.extend({init:function(n,f){n=this.words=n||[],f!=v?this.sigBytes=f:this.sigBytes=n.length*4},toString:function(n){return(n||_).stringify(this)},concat:function(n){var f=this.words,d=n.words,p=this.sigBytes,x=n.sigBytes;if(this.clamp(),p%4)for(var g=0;g<x;g++){var W=d[g>>>2]>>>24-g%4*8&255;f[p+g>>>2]|=W<<24-(p+g)%4*8}else for(var T=0;T<x;T+=4)f[p+T>>>2]=d[T>>>2];return this.sigBytes+=x,this},clamp:function(){var n=this.words,f=this.sigBytes;n[f>>>2]&=4294967295<<32-f%4*8,n.length=r.ceil(f/4)},clone:function(){var n=C.clone.call(this);return n.words=this.words.slice(0),n},random:function(n){for(var f=[],d=0;d<n;d+=4)f.push(y());return new b.init(f,n)}}),B=R.enc={},_=B.Hex={stringify:function(n){for(var f=n.words,d=n.sigBytes,p=[],x=0;x<d;x++){var g=f[x>>>2]>>>24-x%4*8&255;p.push((g>>>4).toString(16)),p.push((g&15).toString(16))}return p.join("")},parse:function(n){for(var f=n.length,d=[],p=0;p<f;p+=2)d[p>>>3]|=parseInt(n.substr(p,2),16)<<24-p%8*4;return new b.init(d,f/2)}},S=B.Latin1={stringify:function(n){for(var f=n.words,d=n.sigBytes,p=[],x=0;x<d;x++){var g=f[x>>>2]>>>24-x%4*8&255;p.push(String.fromCharCode(g))}return p.join("")},parse:function(n){for(var f=n.length,d=[],p=0;p<f;p++)d[p>>>2]|=(n.charCodeAt(p)&255)<<24-p%4*8;return new b.init(d,f)}},w=B.Utf8={stringify:function(n){try{return decodeURIComponent(escape(S.stringify(n)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(n){return S.parse(unescape(encodeURIComponent(n)))}},h=a.BufferedBlockAlgorithm=C.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(n){typeof n=="string"&&(n=w.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(n){var f,d=this._data,p=d.words,x=d.sigBytes,g=this.blockSize,W=g*4,T=x/W;n?T=r.ceil(T):T=r.max((T|0)-this._minBufferSize,0);var k=T*g,I=r.min(k*4,x);if(k){for(var H=0;H<k;H+=g)this._doProcessBlock(p,H);f=p.splice(0,k),d.sigBytes-=I}return new b.init(f,I)},clone:function(){var n=C.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0});a.Hasher=h.extend({cfg:C.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){n&&this._append(n);var f=this._doFinalize();return f},blockSize:16,_createHelper:function(n){return function(f,d){return new n.init(d).finalize(f)}},_createHmacHelper:function(n){return function(f,d){return new l.HMAC.init(n,d).finalize(f)}}});var l=R.algo={};return R}(Math);return o})}(xt)),xt.exports}var _t={exports:{}},Ut;function Ue(){return Ut||(Ut=1,function(t,e){(function(o,r){t.exports=r(Rt())})(J,function(o){return function(r){var v=o,m=v.lib,y=m.Base,A=m.WordArray,R=v.x64={};R.Word=y.extend({init:function(a,C){this.high=a,this.low=C}}),R.WordArray=y.extend({init:function(a,C){a=this.words=a||[],C!=r?this.sigBytes=C:this.sigBytes=a.length*8},toX32:function(){for(var a=this.words,C=a.length,b=[],B=0;B<C;B++){var _=a[B];b.push(_.high),b.push(_.low)}return A.create(b,this.sigBytes)},clone:function(){for(var a=y.clone.call(this),C=a.words=this.words.slice(0),b=C.length,B=0;B<b;B++)C[B]=C[B].clone();return a}})}(),o})}(_t)),_t.exports}(function(t,e){(function(o,r,v){t.exports=r(Rt(),Ue())})(J,function(o){return function(r){var v=o,m=v.lib,y=m.WordArray,A=m.Hasher,R=v.x64,a=R.Word,C=v.algo,b=[],B=[],_=[];(function(){for(var h=1,l=0,n=0;n<24;n++){b[h+5*l]=(n+1)*(n+2)/2%64;var f=l%5,d=(2*h+3*l)%5;h=f,l=d}for(var h=0;h<5;h++)for(var l=0;l<5;l++)B[h+5*l]=l+(2*h+3*l)%5*5;for(var p=1,x=0;x<24;x++){for(var g=0,W=0,T=0;T<7;T++){if(p&1){var k=(1<<T)-1;k<32?W^=1<<k:g^=1<<k-32}p&128?p=p<<1^113:p<<=1}_[x]=a.create(g,W)}})();var S=[];(function(){for(var h=0;h<25;h++)S[h]=a.create()})();var w=C.SHA3=A.extend({cfg:A.cfg.extend({outputLength:512}),_doReset:function(){for(var h=this._state=[],l=0;l<25;l++)h[l]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(h,l){for(var n=this._state,f=this.blockSize/2,d=0;d<f;d++){var p=h[l+2*d],x=h[l+2*d+1];p=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360;var g=n[d];g.high^=x,g.low^=p}for(var W=0;W<24;W++){for(var T=0;T<5;T++){for(var k=0,I=0,H=0;H<5;H++){var g=n[T+5*H];k^=g.high,I^=g.low}var U=S[T];U.high=k,U.low=I}for(var T=0;T<5;T++)for(var j=S[(T+4)%5],G=S[(T+1)%5],F=G.high,Q=G.low,k=j.high^(F<<1|Q>>>31),I=j.low^(Q<<1|F>>>31),H=0;H<5;H++){var g=n[T+5*H];g.high^=k,g.low^=I}for(var E=1;E<25;E++){var k,I,g=n[E],O=g.high,N=g.low,s=b[E];s<32?(k=O<<s|N>>>32-s,I=N<<s|O>>>32-s):(k=N<<s-32|O>>>64-s,I=O<<s-32|N>>>64-s);var i=S[B[E]];i.high=k,i.low=I}var c=S[0],u=n[0];c.high=u.high,c.low=u.low;for(var T=0;T<5;T++)for(var H=0;H<5;H++){var E=T+5*H,g=n[E],nt=S[E],ot=S[(T+1)%5+5*H],at=S[(T+2)%5+5*H];g.high=nt.high^~ot.high&at.high,g.low=nt.low^~ot.low&at.low}var g=n[0],Z=_[W];g.high^=Z.high,g.low^=Z.low}},_doFinalize:function(){var h=this._data,l=h.words;this._nDataBytes*8;var n=h.sigBytes*8,f=this.blockSize*32;l[n>>>5]|=1<<24-n%32,l[(r.ceil((n+1)/f)*f>>>5)-1]|=128,h.sigBytes=l.length*4,this._process();for(var d=this._state,p=this.cfg.outputLength/8,x=p/8,g=[],W=0;W<x;W++){var T=d[W],k=T.high,I=T.low;k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,g.push(I),g.push(k)}return new y.init(g,p)},clone:function(){for(var h=A.clone.call(this),l=h._state=this._state.slice(0),n=0;n<25;n++)l[n]=l[n].clone();return h}});v.SHA3=A._createHelper(w),v.HmacSHA3=A._createHmacHelper(w)}(Math),o.SHA3})})(Yt);var je=Yt.exports;const Zt=It(je);var te={exports:{}};(function(t,e){(function(o,r){t.exports=r(Rt())})(J,function(o){return function(r){var v=o,m=v.lib,y=m.WordArray,A=m.Hasher,R=v.algo,a=[];(function(){for(var w=0;w<64;w++)a[w]=r.abs(r.sin(w+1))*4294967296|0})();var C=R.MD5=A.extend({_doReset:function(){this._hash=new y.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(w,h){for(var l=0;l<16;l++){var n=h+l,f=w[n];w[n]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var d=this._hash.words,p=w[h+0],x=w[h+1],g=w[h+2],W=w[h+3],T=w[h+4],k=w[h+5],I=w[h+6],H=w[h+7],U=w[h+8],j=w[h+9],G=w[h+10],F=w[h+11],Q=w[h+12],E=w[h+13],O=w[h+14],N=w[h+15],s=d[0],i=d[1],c=d[2],u=d[3];s=b(s,i,c,u,p,7,a[0]),u=b(u,s,i,c,x,12,a[1]),c=b(c,u,s,i,g,17,a[2]),i=b(i,c,u,s,W,22,a[3]),s=b(s,i,c,u,T,7,a[4]),u=b(u,s,i,c,k,12,a[5]),c=b(c,u,s,i,I,17,a[6]),i=b(i,c,u,s,H,22,a[7]),s=b(s,i,c,u,U,7,a[8]),u=b(u,s,i,c,j,12,a[9]),c=b(c,u,s,i,G,17,a[10]),i=b(i,c,u,s,F,22,a[11]),s=b(s,i,c,u,Q,7,a[12]),u=b(u,s,i,c,E,12,a[13]),c=b(c,u,s,i,O,17,a[14]),i=b(i,c,u,s,N,22,a[15]),s=B(s,i,c,u,x,5,a[16]),u=B(u,s,i,c,I,9,a[17]),c=B(c,u,s,i,F,14,a[18]),i=B(i,c,u,s,p,20,a[19]),s=B(s,i,c,u,k,5,a[20]),u=B(u,s,i,c,G,9,a[21]),c=B(c,u,s,i,N,14,a[22]),i=B(i,c,u,s,T,20,a[23]),s=B(s,i,c,u,j,5,a[24]),u=B(u,s,i,c,O,9,a[25]),c=B(c,u,s,i,W,14,a[26]),i=B(i,c,u,s,U,20,a[27]),s=B(s,i,c,u,E,5,a[28]),u=B(u,s,i,c,g,9,a[29]),c=B(c,u,s,i,H,14,a[30]),i=B(i,c,u,s,Q,20,a[31]),s=_(s,i,c,u,k,4,a[32]),u=_(u,s,i,c,U,11,a[33]),c=_(c,u,s,i,F,16,a[34]),i=_(i,c,u,s,O,23,a[35]),s=_(s,i,c,u,x,4,a[36]),u=_(u,s,i,c,T,11,a[37]),c=_(c,u,s,i,H,16,a[38]),i=_(i,c,u,s,G,23,a[39]),s=_(s,i,c,u,E,4,a[40]),u=_(u,s,i,c,p,11,a[41]),c=_(c,u,s,i,W,16,a[42]),i=_(i,c,u,s,I,23,a[43]),s=_(s,i,c,u,j,4,a[44]),u=_(u,s,i,c,Q,11,a[45]),c=_(c,u,s,i,N,16,a[46]),i=_(i,c,u,s,g,23,a[47]),s=S(s,i,c,u,p,6,a[48]),u=S(u,s,i,c,H,10,a[49]),c=S(c,u,s,i,O,15,a[50]),i=S(i,c,u,s,k,21,a[51]),s=S(s,i,c,u,Q,6,a[52]),u=S(u,s,i,c,W,10,a[53]),c=S(c,u,s,i,G,15,a[54]),i=S(i,c,u,s,x,21,a[55]),s=S(s,i,c,u,U,6,a[56]),u=S(u,s,i,c,N,10,a[57]),c=S(c,u,s,i,I,15,a[58]),i=S(i,c,u,s,E,21,a[59]),s=S(s,i,c,u,T,6,a[60]),u=S(u,s,i,c,F,10,a[61]),c=S(c,u,s,i,g,15,a[62]),i=S(i,c,u,s,j,21,a[63]),d[0]=d[0]+s|0,d[1]=d[1]+i|0,d[2]=d[2]+c|0,d[3]=d[3]+u|0},_doFinalize:function(){var w=this._data,h=w.words,l=this._nDataBytes*8,n=w.sigBytes*8;h[n>>>5]|=128<<24-n%32;var f=r.floor(l/4294967296),d=l;h[(n+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,h[(n+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,w.sigBytes=(h.length+1)*4,this._process();for(var p=this._hash,x=p.words,g=0;g<4;g++){var W=x[g];x[g]=(W<<8|W>>>24)&16711935|(W<<24|W>>>8)&4278255360}return p},clone:function(){var w=A.clone.call(this);return w._hash=this._hash.clone(),w}});function b(w,h,l,n,f,d,p){var x=w+(h&l|~h&n)+f+p;return(x<<d|x>>>32-d)+h}function B(w,h,l,n,f,d,p){var x=w+(h&n|l&~n)+f+p;return(x<<d|x>>>32-d)+h}function _(w,h,l,n,f,d,p){var x=w+(h^l^n)+f+p;return(x<<d|x>>>32-d)+h}function S(w,h,l,n,f,d,p){var x=w+(l^(h|~n))+f+p;return(x<<d|x>>>32-d)+h}v.MD5=A._createHelper(C),v.HmacMD5=A._createHmacHelper(C)}(Math),o.MD5})})(te);var Ge=te.exports;const Qe=It(Ge),gt=t=>{try{if((t==null?void 0:t.toString)===void 0)return`${t}`;{const e=t.toString();return e.startsWith("[object ")&&e.endsWith("]")?JSON.stringify(t):e}}catch{return""}},Ve=t=>gt(t).toLowerCase();function Xe(t){try{return typeof t[Symbol==null?void 0:Symbol.iterator]=="function"}catch{return!1}}function ee(t){const e=new Set;return JSON.stringify(t,(r,v)=>{if(typeof v=="object"&&v!==null){if(e.has(v))return;e.add(v),Xe(v)&&(v=[...v])}return v})}const re="01",ne="0123456789",oe="0123456789abcdef",ae="0123456789abcdefghijklmnopqrstuvwxyz",se="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Et=t=>{switch(typeof t!="string"&&(t=Ve(t)),t){case"2":return re;case"10":return ne;case"16":return oe;case"36":return ae;case"62":return se;case"64":return Y;case"64w":case"64+":return ie;default:return t}},Ke=(t,e,o,r=0)=>{typeof t!="string"&&(t=gt(t));let v=BigInt(0);e=Et(e);const m=e.length;for(let A=0;A<t.length;A++)v+=BigInt(e.indexOf(t[A])*Math.pow(m,t.length-1-A));let y="";if(o=Et(o),y===""){const A=BigInt(o.length);for(;v>0;)y=o.charAt(+BigInt(v%A).toString())+y,v=BigInt(v/A)}return(y===""?o.charAt(0):y).padStart(r,o[0])},Je=t=>{const e=t.split("").map(m=>m.charCodeAt(0)),o=[];let r=0;for(;r<e.length;){const[m,y=0,A=0]=e.slice(r,r+=3),R=(m<<16)+(y<<8)+A,a=R>>18,C=R>>12&63,b=R>>6&63,B=R&63;o.push(Y[a],Y[C],Y[b],Y[B])}const v=e.length%3;return o.join("").slice(0,1+o.length-v)+(v===2?"==":v===1?"=":"")},Ye=/[^A-Za-z0-9+/]/g,ce=t=>t.replace(Ye,""),St=t=>String.fromCharCode(+t),Ze=t=>{const e=ce(t).split(""),o=[];let r=0;for(;r<e.length;){const[v,m,y,A]=e.slice(r,r+=4).map(R=>Y.indexOf(R));o.push(St(v<<2|m>>4)),y!==64&&o.push(St((m&15)<<4|y>>2)),A!==64&&o.push(St((y&3)<<6|A))}return o.join("").replaceAll("\0","")},tt={BASE2_CHARSET:re,BASE10_CHARSET:ne,BASE16_CHARSET:oe,BASE36_CHARSET:ae,BASE62_CHARSET:se,BASE64_CHARSET:Y,BASE64WEB_CHARSET:ie,convert:Ke,getCharset:Et,secureBase64:ce,textToBase64:Je,base64ToText:Ze};function tr(...t){return t.reduce((e,o)=>e+o,0)}const er=t=>Zt(t,{outputLength:256}).toString(),rr=/0b[0-1]+/i;function mt(t){if(typeof t=="number")return Math.round(t);if(t instanceof Object&&(t=ee(t)),typeof t=="string"){if(rr.test(t))return parseInt(t.substring(2,t.length-1),2);const e=parseInt(t);return Number.isNaN(e)?e:tr(parseInt(er(t),16))}else return Date.now()}const $=624,ct=397,nr=2567483615,Ct=2147483648,Tt=2147483647;class or{constructor(e){it(this,"mt",new Array($));it(this,"mti",$+1);it(this,"seed");return this.seed=e=mt(e),Array.isArray(e)?this.init_by_array(e,e.length):this.init_seed(e),this}init_seed(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<$;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}init_by_array(e,o){let r,v,m;for(this.init_seed(19650218),r=1,v=0,m=$>o?$:o;m!==0;m--){const y=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(((y&4294901760)>>>16)*1664525<<16)+(y&65535)*1664525)+e[v]+v,this.mt[r]>>>=0,r++,v++,r>=$&&(this.mt[0]=this.mt[$-1],r=1),v>=o&&(v=0)}for(m=$-1;m!==0;m--){const y=this.mt[r-1]^this.mt[r-1]>>>30;this.mt[r]=(this.mt[r]^(((y&4294901760)>>>16)*1566083941<<16)+(y&65535)*1566083941)-r,this.mt[r]>>>=0,r++,r>=$&&(this.mt[0]=this.mt[$-1],r=1)}this.mt[0]=2147483648}random_int(){let e;const o=new Array(0,nr);if(this.mti>=$){let r;for(this.mti===$+1&&this.init_seed(5489),r=0;r<$-ct;r++)e=this.mt[r]&Ct|this.mt[r+1]&Tt,this.mt[r]=this.mt[r+ct]^e>>>1^o[e&1];for(;r<$-1;r++)e=this.mt[r]&Ct|this.mt[r+1]&Tt,this.mt[r]=this.mt[r+(ct-$)]^e>>>1^o[e&1];e=this.mt[$-1]&Ct|this.mt[0]&Tt,this.mt[$-1]=this.mt[ct-1]^e>>>1^o[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0}random_int31(){return this.random_int()>>>1}random_incl(){return this.random_int()*(1/4294967295)}random(){return this.random_int()*(1/4294967296)}random_excl(){return(this.random_int()+.5)*(1/4294967296)}random_long(){return((this.random_int()>>>5)*67108864+(this.random_int()>>>6))*(1/9007199254740992)}}function ue(t){return new or(t)}const{BASE10_CHARSET:ar,BASE16_CHARSET:sr,BASE64WEB_CHARSET:ir}=tt,cr=ue(),le=(t=cr)=>t.random(),Wt=(t,e,o)=>((e===void 0||e===0)&&(e=t,t=0),Math.floor(t+le(o)*e)),fe=(t,e)=>t[Wt(0,t.length,e)],he=(t,e=1,o)=>{const r=[],v=[];for(let m=0;m<e;m++)v.length===0&&v.push(...t),r.push(v.splice(Wt(0,v.length,o),1)[0]);return r},ur=(t,e)=>he(t,t.length,e),ut=(t,e=8,o)=>new Array(e).fill(0).map(r=>fe(t,o)).join(""),ve={MT:ue,toSeed:mt,rand:le,randInt:Wt,charset:ut,choice:fe,choices:he,shuffle:ur,base10:(t=6,e)=>ut(ar,t,e),base16:(t=32,e)=>ut(sr,t,e),base64:(t=32,e)=>ut(ir,t,e),lcg(t){let e=mt(t);return()=>(e=(e*1664525+1013904223)%4294967296)/4294967296}},{MT:jt,shuffle:lr,randInt:bt}=ve,{convert:fr,getCharset:hr}=tt,vr=(t,e)=>{const o=lr(t,e);return()=>(o.push(o.shift()),o)},de=(t,e=16,o=1,r)=>{const v=Number.isNaN(+e)?64:+e,m=hr(e),y=mt(r!==void 0?r:bt(0,v)),A=jt(y),R=vr(m,jt(bt(0,1e6,A))),a=typeof t=="string"?t.split(""):t,C=[r!==void 0?m[bt(0,v)]:fr(y,10,e),...a.map(b=>R()[m.indexOf(b)])];return--o<1?C.join(""):de(C,e,o,r)},{textToBase64:dr,base64ToText:Nr,secureBase64:pr}=tt;function mr(t,e=1,o){return typeof t=="object"?t=ee(t):typeof t!="string"&&(t=gt(t)),de(pr(dr(t)),64,e,o)}function gr(t,e=512,o){const r=mr(t,1,o).substring(1);return e==="MD5"?Qe(r).toString():Zt(r,{outputLength:e}).toString()}const yr=new Map([["THINKING","Please wait, I am answering another question..."]]);function wr(t,e){switch(t){case"model":if(["gpt3","gpt4","gpt-web","claude-2-web","gpt3-fga"].includes(e))return!0;break;case"temperature":if(typeof e=="number"&&e>=0&&e<=1)return!0;break;case"context":if(typeof e=="boolean")return!0;break}return!1}function xr(t){try{return JSON.parse(t)}catch{return t}}function pe(t){try{const e={};for(const o in t){const r=xr(t[o]);wr(o,r)&&(e[o]=r)}return e}catch{return{}}}function _r(t){try{return pe(Jt.parse(t))}catch{return{}}}function Sr(t){try{return Jt.stringify(pe(t))}catch{return""}}const Gt=[{name:"GPT-3.5-Turbo",value:"gpt3",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-4",value:"gpt4",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-Web",value:"gpt-web",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"Claude-2-Web",value:"claude-2-web",isWebBrowsingOptional:!1,isTemperatureOptional:!1,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1},{name:"GPT-3.5-Turbo (stream)",value:"gpt3-fga",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1}];let Pt,Qt="";const me=D(),Ot=D(!1),ge=D(""),K=D("gpt4"),et=D(!0),rt=D(.5),P=D([]),V=D([]);st(Ot,t=>{t||M()});const Cr=t=>{Ot.value=!0,me.value=t,ge.value=t.Q,setTimeout(()=>ye(),0)};function ye(){try{document.querySelector(".EditMessageInput textarea").focus()}catch{}}const M=()=>{try{{const t=document.querySelector(".InputBox textarea");t.click(),t.focus()}}catch{}},we=()=>{try{const t=document.getElementById(L()).parentElement,e=document.querySelector(".ConversationList"),o=t.offsetTop-e.offsetTop-t.clientHeight/2,r=o-e.clientHeight+t.clientHeight*2;e.scrollTop>o&&e.scrollTo({left:0,top:o,behavior:"smooth"}),e.scrollTop<r&&e.scrollTo({left:0,top:r,behavior:"smooth"})}catch{}},lt=()=>new Promise((t,e)=>{$fetch("/api/curva/check",{method:"POST"}).then(o=>{V.value=o,we(),t(!0)}).catch(o=>{q.error("Initialization Failed"),e(o)})}),Tr=t=>new Promise(async(e,o)=>{if(t==null)return e([]);const r=await $fetch("/api/curva/history",{method:"POST",body:{id:t}});(!r||r.length===0)&&dt("/c/");try{e(r.map(v=>Kt({...v,t:new Date(v.t),done:!!v.A})))}catch{dt("/c/"),e([])}}),xe=async function(t){return[]},br=async()=>{try{const t=P.value.at(-1),e=await xe(t.Q),o=At()>=document.body.clientHeight;t.more=e,o&&X()}catch(t){console.error(t)}},$t=(t=!1)=>{K.value="gpt4",et.value=!0,rt.value=.5,t&&q.success("Conversation settings have been reset.")};$t();const z=D(!1),Lt=D(z.value),Dt=D(z.value);st(Lt,t=>{z.value=t});st(Dt,t=>{z.value=t});st(z,t=>{const{isMobileScreen:e}=pt();Lt.value=e?!1:t,Dt.value=e?t:!1,setTimeout(()=>M(),0)});{let t,e=pt().isMobileScreen?"drawer":"sidebar";window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>{const o=pt().isMobileScreen?"drawer":"sidebar";z.value&&o!=e&&(z.value=!1,setTimeout(()=>{z.value=!0},0),e=o)},100)})}const ft=D(""),Br=Xt(()=>K.value.startsWith("gpt3")?16e3:32e3),Ar=(()=>{const t=()=>[77,68,53].map(r=>String.fromCharCode(r)).join(""),e=(r,v)=>({hash:gr(r,t(),v),timestamp:gt(v)}),o=(r,v,m,y,A,R,a)=>{let C=L();return C||(C=ve.base64(8),V.value.unshift({id:C,name:"",mtime:Date.now(),config:""}),dt(`/c/${C}?feature=new`),Se(C)),{conv:C,messages:r,model:v,temperature:m,t:y,tz:A,id:R,streamId:a}};return async(r,v)=>{const m=new Date,y=m.getTime(),A=m.getTimezoneOffset()/60*-1,R=(()=>{if(!et.value)return[{role:"user",content:(r==null?void 0:r.Q)||""}];const a=P.value.lastIndexOf(r)+1||P.value.length;let C=P.value.slice(0,a);return C=C.slice(C.length-100),C.map(b=>[{role:"user",content:b.Q},{role:"assistant",content:b.A}].filter(B=>B.content)).flat()})();try{const a=o(R,K.value,rt.value,y,A,r==null?void 0:r.id,v),C=e(R,y);return await $fetch("/api/curva/answer",{method:"POST",headers:C,body:a})}catch{return{answer:"",error:"Error while sending request."}}}})(),Er=(t="",e="",o=!1)=>Kt({done:o,Q:t,A:e,queries:[],urls:[],dt:void 0,t:new Date}),ht=new Set,Bt=()=>{V.value=[],P.value=[],dt("/c/"),kt=!0};let kt=!0;function Vt(){{const t=$e();t.get("feature")==="new"&&(t.delete("feature"),t.save(),qt())}}const _e=(t,e)=>{const o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),o.remove()},[kr,L,Se]=(()=>{const t=D("");return[Xt(()=>t.value),()=>t.value,e=>{var o,r;return t.value=e===void 0?(r=(o=Pt._route)==null?void 0:o.params)==null?void 0:r.conv:e}]})(),vt=()=>{var e;const t=L();return((e=V.value.filter(o=>o.id===t)[0])==null?void 0:e.name)||""};async function qt(t,e){return t=t||L(),t?await $fetch("/api/curva/conv",{method:"PUT",body:{id:t,name:e||vt(),config:Sr({model:K.value,temperature:rt.value,context:et.value})}}):{cancel:!0}}let Ht=!1;const Hr=t=>{var r;if(t===void 0&&(t=L()),t==null)return;const e=_r(((r=V.value.find(v=>v.id===t))==null?void 0:r.config)||""),o=Object.keys(e);if(o.length===0)$t();else{Ht=!0;try{for(const v of o){const m=e[v];switch(v){case"model":K.value=m;break;case"temperature":rt.value=m;break;case"context":et.value=m;break}}}finally{Ht=!1}}q.info("Conversation settings have been loaded.")};setTimeout(()=>{let t;[K,et,rt].forEach(e=>{st(e,(o,r)=>{Pt&&!Ht&&o!==r&&ht.size===0&&(clearTimeout(t),t=setTimeout(async()=>{try{const{cancel:v=!1}=await qt();v||q.info("Conversation settings have been saved.")}catch(v){console.error(v),q.warning("Failed to save conversation settings.")}finally{clearTimeout(t)}},typeof e.value=="number"?500:0))})})},1e3);const Ir=t=>{P.value=P.value.filter(e=>e.id!==t),$fetch("/api/curva/answer",{method:"DELETE",body:{conv:L(),id:t}}).then(()=>q.info("The message has been deleted.")).catch(()=>q.error("An error occurred while deleting the message."))},Rr=()=>{let t=0;const e=`${tt.convert(L(),"64w",10)}.md`,o=P.value.map(r=>{t++;try{return(r.t?`${new Date(r.t.getTime()-(r.dt||0)).toLocaleString()}${r.dt===void 0?"":" (Δt: "+r.dt.toString()+"ms)"}

`:"")+(r.Q?`QUESTION ${t}:

${r.Q.replaceAll(`
`,`

`)}`:"")+(r.Q&&r.A?`

`:"")+(r.A?`ANSWER ${t}:

${r.A}`:"")}catch{return"(Unknown message)"}}).join(`

---

`)+`

---

`;_e(e,o)},Wr=()=>{_e(`${tt.convert(L(),"64w",10)}.json`,JSON.stringify(P.value.map(t=>({question:t.Q,answer:t.A,created:new Date(t.t.getTime()).toUTCString(),timeUsed:t.dt||void 0,queries:t.queries||void 0,urls:t.urls||void 0})),null,4))};document.addEventListener("keyup",t=>{switch(t.key){case"/":case"Enter":M();break;case"Escape":z.value=!z.value;break}});const Ce=D(!1);document.addEventListener("scroll",()=>{Ce.value=!Re()});function Mr(){const{authEventTarget:t}=Le(),e=Nt("appName").value,o=We();["temperature-suffix","web-browsing","temperature"].forEach(_=>{o.delete(_,{path:"/"}),o.delete(_)}),Pt=Pe();const r=()=>{try{Mt(`${vt()||y("chat.title")} - ${e}`)}catch{Mt(`${y("chat.title")} - ${e}`)}};t.addListener("login",Bt),t.addListener("logout",Bt);const v=async _=>{setTimeout(()=>{pt().isMobileScreen&&(z.value=!1)},0),P.value=[];const S=yt.service({text:y("chat.ldConv")+"...",lock:!0});try{const w=_===null&&V.value.length>0?null:lt(),h=_===null?null:await Tr(_);Hr(_),h!==null&&L()===_&&(P.value=h,br()),await Promise.all([w,X(1e3)])}finally{S.close(),await X(500),M(),we(),await X(500)}},m=async(_,S=!1)=>{Se(_||"");const w=Promise.all([...ht]),h=kt&&S?new Promise(async l=>{await v(_),Vt(),l(null)}):S?new Promise(l=>l(null)):v(_);kt=!1,ht.add(h);try{await w}catch{}try{await h}finally{ht.delete(h)}},y=Oe().t,A=Nt("version"),R=async(_,S)=>{if(document.querySelectorAll(".Message.T").length>0)return q.info("Please wait for the completion of the previous question."),M(),!1;const h=(_!==void 0?_:ft.value).trim();if(_===void 0&&(ft.value="",h===""))return M(),!1;const l=(S?P.value.filter(E=>E.id===S).at(-1):void 0)||Er(h,"",!1);P.value.includes(l)||P.value.push(l);const n=l.A||"";l.done=!1,l.Q=h,l.A="",l.urls=[],l.queries=[],l.dt&&(l.dt=void 0);const f=xe(),d=At()>=document.body.clientHeight,p=L();d&&X().finally(()=>M());const x=1;let g=!1;const W=await new Promise(async E=>{var at;if(!((at=Gt.find(Z=>Z.value===K.value))!=null&&at.isStreamAvailable))return E(void 0);const O=[],N=setInterval(()=>{O.length&&(l.A+=O.shift(),d&&X(0,"instant")),l.done&&(clearInterval(N),s.abort())},x),s=new AbortController,i=await fetch("/api/curva/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:"{}",signal:s.signal}),c=new TextDecoder,u=i.body.getReader();let nt=!1;const ot=async()=>{await u.read().then(async({value:Z,done:Te})=>{if(Te){if(O.length===0){l.done=!0;return}g=!0;const be=setInterval(()=>{O.length===0&&(l.done=!0,g=!1,clearInterval(be))},x);return}const zt=c.decode(Z);nt?O.push(zt):(E(zt),nt=!0),ot()})};ot()}),T=await Ar(l,W);Vt(),Qt!==p&&lt().finally(()=>{Qt=L()});const{id:k,answer:I="",error:H,urls:U=[],queries:j=[],dt:G=0,version:F}=T;if(g){const E=setInterval(()=>{g||(l.done=!0,l.A!==I&&(l.A=I||""),clearInterval(E))},x)}else l.done=!0,l.A!==I&&(l.A=I||"");l.t=new Date,l.dt=G||void 0,l.id=k||void 0,l.urls=U||[],l.queries=j||[];const Q=(E=>E?(E.type==="warning"?q.warning(E.content):q.error(E.content),l.A="Oops! Something went wrong!",!0):!1)((()=>{if(I===""){if(H){const E=()=>{S?l.A=n:(P.value.pop(),ft.value=h)};if(typeof H=="string"&&H.startsWith("You have tried too many times."))return E(),{type:"warning",content:H};switch(H){case"THINKING":return E(),{type:"warning",content:yr.get(H)};default:return{type:"error",content:H}}}return{type:"error",content:y("error.plzRefresh")}}})());return setTimeout(async()=>{if(!S&&d&&await X(),F&&F!==A.value){const E=setTimeout(()=>location.reload(),3e3);wt.confirm(y("action.newVersion"),y("message.notice"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),type:"warning"}).then(()=>M()).catch(()=>M()).finally(()=>{clearTimeout(E),yt.service({text:"Loading...",lock:!0}),location.reload()})}},0),f.then(E=>{const O=At()>=document.body.clientHeight;l.more=E,O&&X()}),Q};return{models:Gt,showScrollToBottomButton:Ce,isEditingMessage:Ot,editingMessage:me,callEditMessageDialog:Cr,editingMessageContent:ge,focusEditMessageInput:ye,model:K,conversations:V,messages:P,temperature:rt,contextMode:et,openMenu:z,openSidebarController:Lt,openDrawerController:Dt,inputValue:ft,inputMaxLength:Br,currentConvIdComputed:kr,getCurrentConvId:L,getCurrentConvName:vt,checkTokenAndGetConversations:lt,loadChat:m,sendMessage:R,deleteMessage:Ir,regenerateMessage:async _=>{if(P.value.length===0)return;const{Q:S,id:w}=_||P.value.pop();R(S||"",w)},focusInput:M,refreshConversation:()=>{m(L()).finally(()=>M())},renameConversation:(_,S="")=>{_||(_=L(),S=vt()),wt.prompt(y("message.renameConvHint"),y("message.setting"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),inputValue:S,inputPlaceholder:tt.convert(_,"64w",10)}).then(async({value:w})=>{try{await qt(_,w),q({type:"success",message:y("message.renameSuccess")}),await lt(),r()}catch{q({type:"error",message:"Oops! Something went wrong!"})}}).catch(()=>{})},deleteConversation:_=>{const S=_||L();let w="createNewChat";wt.confirm(y("message.deleteConvConfirm"),y("message.warning"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),type:"warning"}).then(async()=>{var f;const h=yt.service({text:y("chat.dltConv")+"...",lock:!0});try{await $fetch("/api/curva/conv",{method:"DELETE",body:{id:S}})}catch{}h.close();const l=L();_===l&&((f=document.getElementById(w))==null||f.click());const n=V.value.findIndex(d=>d.id===l);n!=-1&&V.value.splice(n,1)})},resetConvConfig:$t,exportAsMarkdown:Rr,exportAsJson:Wr,clear:Bt}}export{tt as b,ve as r,gt as s,Mr as u};
