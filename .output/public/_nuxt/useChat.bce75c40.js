var Be=Object.defineProperty;var Ee=(t,e,o)=>e in t?Be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var ct=(t,e,o)=>(Ee(t,typeof e!="symbol"?e+"":e,o),o);import{ce as kt,cf as Ie,cg as ke,ch as He,ci as Re,cj as K,r as L,h as et,aa as Jt,W as We,E as z,i as Mt,ck as $e,D as Pe,g as Oe,A as pt,V as F,z as yt,l as Kt,cl as De}from"./entry.d60a59af.js";import{E as wt}from"./el-overlay.20c98010.js";import"./el-button.88ff9037.js";import"./el-input.a2b25608.js";import{u as Le}from"./useAuth.c5c00c76.js";import{u as Qt}from"./useTitle.fbc07ced.js";var qe=Ie,ze=ke,Ne=He,Me={formats:Ne,parse:ze,stringify:qe};const Yt=kt(Me),Qe={get isMobileScreen(){return window.innerWidth<600},get isTouchScreen(){return"ontouchstart"in document||navigator.maxTouchPoints>0}};function it(){return Qe}var Zt={exports:{}};function Fe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xt={exports:{}},Ft;function Ht(){return Ft||(Ft=1,function(t,e){(function(o,n){t.exports=n()})(K,function(){var o=o||function(n,v){var p;if(typeof window<"u"&&window.crypto&&(p=window.crypto),typeof self<"u"&&self.crypto&&(p=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(p=globalThis.crypto),!p&&typeof window<"u"&&window.msCrypto&&(p=window.msCrypto),!p&&typeof K<"u"&&K.crypto&&(p=K.crypto),!p&&typeof Fe=="function")try{p=Re}catch{}var y=function(){if(p){if(typeof p.getRandomValues=="function")try{return p.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof p.randomBytes=="function")try{return p.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},B=Object.create||function(){function r(){}return function(f){var d;return r.prototype=f,d=new r,r.prototype=null,d}}(),R={},s=R.lib={},A=s.Base=function(){return{extend:function(r){var f=B(this);return r&&f.mixIn(r),(!f.hasOwnProperty("init")||this.init===f.init)&&(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var r=this.extend();return r.init.apply(r,arguments),r},init:function(){},mixIn:function(r){for(var f in r)r.hasOwnProperty(f)&&(this[f]=r[f]);r.hasOwnProperty("toString")&&(this.toString=r.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),b=s.WordArray=A.extend({init:function(r,f){r=this.words=r||[],f!=v?this.sigBytes=f:this.sigBytes=r.length*4},toString:function(r){return(r||_).stringify(this)},concat:function(r){var f=this.words,d=r.words,m=this.sigBytes,x=r.sigBytes;if(this.clamp(),m%4)for(var g=0;g<x;g++){var W=d[g>>>2]>>>24-g%4*8&255;f[m+g>>>2]|=W<<24-(m+g)%4*8}else for(var C=0;C<x;C+=4)f[m+C>>>2]=d[C>>>2];return this.sigBytes+=x,this},clamp:function(){var r=this.words,f=this.sigBytes;r[f>>>2]&=4294967295<<32-f%4*8,r.length=n.ceil(f/4)},clone:function(){var r=A.clone.call(this);return r.words=this.words.slice(0),r},random:function(r){for(var f=[],d=0;d<r;d+=4)f.push(y());return new b.init(f,r)}}),T=R.enc={},_=T.Hex={stringify:function(r){for(var f=r.words,d=r.sigBytes,m=[],x=0;x<d;x++){var g=f[x>>>2]>>>24-x%4*8&255;m.push((g>>>4).toString(16)),m.push((g&15).toString(16))}return m.join("")},parse:function(r){for(var f=r.length,d=[],m=0;m<f;m+=2)d[m>>>3]|=parseInt(r.substr(m,2),16)<<24-m%8*4;return new b.init(d,f/2)}},S=T.Latin1={stringify:function(r){for(var f=r.words,d=r.sigBytes,m=[],x=0;x<d;x++){var g=f[x>>>2]>>>24-x%4*8&255;m.push(String.fromCharCode(g))}return m.join("")},parse:function(r){for(var f=r.length,d=[],m=0;m<f;m++)d[m>>>2]|=(r.charCodeAt(m)&255)<<24-m%4*8;return new b.init(d,f)}},w=T.Utf8={stringify:function(r){try{return decodeURIComponent(escape(S.stringify(r)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(r){return S.parse(unescape(encodeURIComponent(r)))}},h=s.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(r){typeof r=="string"&&(r=w.parse(r)),this._data.concat(r),this._nDataBytes+=r.sigBytes},_process:function(r){var f,d=this._data,m=d.words,x=d.sigBytes,g=this.blockSize,W=g*4,C=x/W;r?C=n.ceil(C):C=n.max((C|0)-this._minBufferSize,0);var I=C*g,H=n.min(I*4,x);if(I){for(var k=0;k<I;k+=g)this._doProcessBlock(m,k);f=m.splice(0,I),d.sigBytes-=H}return new b.init(f,H)},clone:function(){var r=A.clone.call(this);return r._data=this._data.clone(),r},_minBufferSize:0});s.Hasher=h.extend({cfg:A.extend(),init:function(r){this.cfg=this.cfg.extend(r),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(r){return this._append(r),this._process(),this},finalize:function(r){r&&this._append(r);var f=this._doFinalize();return f},blockSize:16,_createHelper:function(r){return function(f,d){return new r.init(d).finalize(f)}},_createHmacHelper:function(r){return function(f,d){return new l.HMAC.init(r,d).finalize(f)}}});var l=R.algo={};return R}(Math);return o})}(xt)),xt.exports}var _t={exports:{}},Ut;function Ue(){return Ut||(Ut=1,function(t,e){(function(o,n){t.exports=n(Ht())})(K,function(o){return function(n){var v=o,p=v.lib,y=p.Base,B=p.WordArray,R=v.x64={};R.Word=y.extend({init:function(s,A){this.high=s,this.low=A}}),R.WordArray=y.extend({init:function(s,A){s=this.words=s||[],A!=n?this.sigBytes=A:this.sigBytes=s.length*8},toX32:function(){for(var s=this.words,A=s.length,b=[],T=0;T<A;T++){var _=s[T];b.push(_.high),b.push(_.low)}return B.create(b,this.sigBytes)},clone:function(){for(var s=y.clone.call(this),A=s.words=this.words.slice(0),b=A.length,T=0;T<b;T++)A[T]=A[T].clone();return s}})}(),o})}(_t)),_t.exports}(function(t,e){(function(o,n,v){t.exports=n(Ht(),Ue())})(K,function(o){return function(n){var v=o,p=v.lib,y=p.WordArray,B=p.Hasher,R=v.x64,s=R.Word,A=v.algo,b=[],T=[],_=[];(function(){for(var h=1,l=0,r=0;r<24;r++){b[h+5*l]=(r+1)*(r+2)/2%64;var f=l%5,d=(2*h+3*l)%5;h=f,l=d}for(var h=0;h<5;h++)for(var l=0;l<5;l++)T[h+5*l]=l+(2*h+3*l)%5*5;for(var m=1,x=0;x<24;x++){for(var g=0,W=0,C=0;C<7;C++){if(m&1){var I=(1<<C)-1;I<32?W^=1<<I:g^=1<<I-32}m&128?m=m<<1^113:m<<=1}_[x]=s.create(g,W)}})();var S=[];(function(){for(var h=0;h<25;h++)S[h]=s.create()})();var w=A.SHA3=B.extend({cfg:B.cfg.extend({outputLength:512}),_doReset:function(){for(var h=this._state=[],l=0;l<25;l++)h[l]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(h,l){for(var r=this._state,f=this.blockSize/2,d=0;d<f;d++){var m=h[l+2*d],x=h[l+2*d+1];m=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,x=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360;var g=r[d];g.high^=x,g.low^=m}for(var W=0;W<24;W++){for(var C=0;C<5;C++){for(var I=0,H=0,k=0;k<5;k++){var g=r[C+5*k];I^=g.high,H^=g.low}var U=S[C];U.high=I,U.low=H}for(var C=0;C<5;C++)for(var j=S[(C+4)%5],G=S[(C+1)%5],Q=G.high,V=G.low,I=j.high^(Q<<1|V>>>31),H=j.low^(V<<1|Q>>>31),k=0;k<5;k++){var g=r[C+5*k];g.high^=I,g.low^=H}for(var E=1;E<25;E++){var I,H,g=r[E],P=g.high,M=g.low,a=b[E];a<32?(I=P<<a|M>>>32-a,H=M<<a|P>>>32-a):(I=M<<a-32|P>>>64-a,H=P<<a-32|M>>>64-a);var i=S[T[E]];i.high=I,i.low=H}var c=S[0],u=r[0];c.high=u.high,c.low=u.low;for(var C=0;C<5;C++)for(var k=0;k<5;k++){var E=C+5*k,g=r[E],ot=S[E],st=S[(C+1)%5+5*k],at=S[(C+2)%5+5*k];g.high=ot.high^~st.high&at.high,g.low=ot.low^~st.low&at.low}var g=r[0],tt=_[W];g.high^=tt.high,g.low^=tt.low}},_doFinalize:function(){var h=this._data,l=h.words;this._nDataBytes*8;var r=h.sigBytes*8,f=this.blockSize*32;l[r>>>5]|=1<<24-r%32,l[(n.ceil((r+1)/f)*f>>>5)-1]|=128,h.sigBytes=l.length*4,this._process();for(var d=this._state,m=this.cfg.outputLength/8,x=m/8,g=[],W=0;W<x;W++){var C=d[W],I=C.high,H=C.low;I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,H=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,g.push(H),g.push(I)}return new y.init(g,m)},clone:function(){for(var h=B.clone.call(this),l=h._state=this._state.slice(0),r=0;r<25;r++)l[r]=l[r].clone();return h}});v.SHA3=B._createHelper(w),v.HmacSHA3=B._createHmacHelper(w)}(Math),o.SHA3})})(Zt);var je=Zt.exports;const te=kt(je);var ee={exports:{}};(function(t,e){(function(o,n){t.exports=n(Ht())})(K,function(o){return function(n){var v=o,p=v.lib,y=p.WordArray,B=p.Hasher,R=v.algo,s=[];(function(){for(var w=0;w<64;w++)s[w]=n.abs(n.sin(w+1))*4294967296|0})();var A=R.MD5=B.extend({_doReset:function(){this._hash=new y.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(w,h){for(var l=0;l<16;l++){var r=h+l,f=w[r];w[r]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var d=this._hash.words,m=w[h+0],x=w[h+1],g=w[h+2],W=w[h+3],C=w[h+4],I=w[h+5],H=w[h+6],k=w[h+7],U=w[h+8],j=w[h+9],G=w[h+10],Q=w[h+11],V=w[h+12],E=w[h+13],P=w[h+14],M=w[h+15],a=d[0],i=d[1],c=d[2],u=d[3];a=b(a,i,c,u,m,7,s[0]),u=b(u,a,i,c,x,12,s[1]),c=b(c,u,a,i,g,17,s[2]),i=b(i,c,u,a,W,22,s[3]),a=b(a,i,c,u,C,7,s[4]),u=b(u,a,i,c,I,12,s[5]),c=b(c,u,a,i,H,17,s[6]),i=b(i,c,u,a,k,22,s[7]),a=b(a,i,c,u,U,7,s[8]),u=b(u,a,i,c,j,12,s[9]),c=b(c,u,a,i,G,17,s[10]),i=b(i,c,u,a,Q,22,s[11]),a=b(a,i,c,u,V,7,s[12]),u=b(u,a,i,c,E,12,s[13]),c=b(c,u,a,i,P,17,s[14]),i=b(i,c,u,a,M,22,s[15]),a=T(a,i,c,u,x,5,s[16]),u=T(u,a,i,c,H,9,s[17]),c=T(c,u,a,i,Q,14,s[18]),i=T(i,c,u,a,m,20,s[19]),a=T(a,i,c,u,I,5,s[20]),u=T(u,a,i,c,G,9,s[21]),c=T(c,u,a,i,M,14,s[22]),i=T(i,c,u,a,C,20,s[23]),a=T(a,i,c,u,j,5,s[24]),u=T(u,a,i,c,P,9,s[25]),c=T(c,u,a,i,W,14,s[26]),i=T(i,c,u,a,U,20,s[27]),a=T(a,i,c,u,E,5,s[28]),u=T(u,a,i,c,g,9,s[29]),c=T(c,u,a,i,k,14,s[30]),i=T(i,c,u,a,V,20,s[31]),a=_(a,i,c,u,I,4,s[32]),u=_(u,a,i,c,U,11,s[33]),c=_(c,u,a,i,Q,16,s[34]),i=_(i,c,u,a,P,23,s[35]),a=_(a,i,c,u,x,4,s[36]),u=_(u,a,i,c,C,11,s[37]),c=_(c,u,a,i,k,16,s[38]),i=_(i,c,u,a,G,23,s[39]),a=_(a,i,c,u,E,4,s[40]),u=_(u,a,i,c,m,11,s[41]),c=_(c,u,a,i,W,16,s[42]),i=_(i,c,u,a,H,23,s[43]),a=_(a,i,c,u,j,4,s[44]),u=_(u,a,i,c,V,11,s[45]),c=_(c,u,a,i,M,16,s[46]),i=_(i,c,u,a,g,23,s[47]),a=S(a,i,c,u,m,6,s[48]),u=S(u,a,i,c,k,10,s[49]),c=S(c,u,a,i,P,15,s[50]),i=S(i,c,u,a,I,21,s[51]),a=S(a,i,c,u,V,6,s[52]),u=S(u,a,i,c,W,10,s[53]),c=S(c,u,a,i,G,15,s[54]),i=S(i,c,u,a,x,21,s[55]),a=S(a,i,c,u,U,6,s[56]),u=S(u,a,i,c,M,10,s[57]),c=S(c,u,a,i,H,15,s[58]),i=S(i,c,u,a,E,21,s[59]),a=S(a,i,c,u,C,6,s[60]),u=S(u,a,i,c,Q,10,s[61]),c=S(c,u,a,i,g,15,s[62]),i=S(i,c,u,a,j,21,s[63]),d[0]=d[0]+a|0,d[1]=d[1]+i|0,d[2]=d[2]+c|0,d[3]=d[3]+u|0},_doFinalize:function(){var w=this._data,h=w.words,l=this._nDataBytes*8,r=w.sigBytes*8;h[r>>>5]|=128<<24-r%32;var f=n.floor(l/4294967296),d=l;h[(r+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,h[(r+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,w.sigBytes=(h.length+1)*4,this._process();for(var m=this._hash,x=m.words,g=0;g<4;g++){var W=x[g];x[g]=(W<<8|W>>>24)&16711935|(W<<24|W>>>8)&4278255360}return m},clone:function(){var w=B.clone.call(this);return w._hash=this._hash.clone(),w}});function b(w,h,l,r,f,d,m){var x=w+(h&l|~h&r)+f+m;return(x<<d|x>>>32-d)+h}function T(w,h,l,r,f,d,m){var x=w+(h&r|l&~r)+f+m;return(x<<d|x>>>32-d)+h}function _(w,h,l,r,f,d,m){var x=w+(h^l^r)+f+m;return(x<<d|x>>>32-d)+h}function S(w,h,l,r,f,d,m){var x=w+(l^(h|~r))+f+m;return(x<<d|x>>>32-d)+h}v.MD5=B._createHelper(A),v.HmacMD5=B._createHmacHelper(A)}(Math),o.MD5})})(ee);var Ge=ee.exports;const Ve=kt(Ge),gt=t=>{try{if((t==null?void 0:t.toString)===void 0)return`${t}`;{const e=t.toString();return e.startsWith("[object ")&&e.endsWith("]")?JSON.stringify(t):e}}catch{return""}},Xe=t=>gt(t).toLowerCase();function Je(t){try{return typeof t[Symbol==null?void 0:Symbol.iterator]=="function"}catch{return!1}}function ne(t){const e=new Set;return JSON.stringify(t,(n,v)=>{if(typeof v=="object"&&v!==null){if(e.has(v))return;e.add(v),Je(v)&&(v=[...v])}return v})}const re="01",oe="0123456789",se="0123456789abcdef",ae="0123456789abcdefghijklmnopqrstuvwxyz",ie="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Bt=t=>{switch(typeof t!="string"&&(t=Xe(t)),t){case"2":return re;case"10":return oe;case"16":return se;case"36":return ae;case"62":return ie;case"64":return Y;case"64w":case"64+":return ce;default:return t}},Ke=(t,e,o,n=0)=>{typeof t!="string"&&(t=gt(t));let v=BigInt(0);e=Bt(e);const p=e.length;for(let B=0;B<t.length;B++)v+=BigInt(e.indexOf(t[B])*Math.pow(p,t.length-1-B));let y="";if(o=Bt(o),y===""){const B=BigInt(o.length);for(;v>0;)y=o.charAt(+BigInt(v%B).toString())+y,v=BigInt(v/B)}return(y===""?o.charAt(0):y).padStart(n,o[0])},Ye=t=>{const e=t.split("").map(p=>p.charCodeAt(0)),o=[];let n=0;for(;n<e.length;){const[p,y=0,B=0]=e.slice(n,n+=3),R=(p<<16)+(y<<8)+B,s=R>>18,A=R>>12&63,b=R>>6&63,T=R&63;o.push(Y[s],Y[A],Y[b],Y[T])}const v=e.length%3;return o.join("").slice(0,1+o.length-v)+(v===2?"==":v===1?"=":"")},Ze=/[^A-Za-z0-9+/]/g,ue=t=>t.replace(Ze,""),St=t=>String.fromCharCode(+t),tn=t=>{const e=ue(t).split(""),o=[];let n=0;for(;n<e.length;){const[v,p,y,B]=e.slice(n,n+=4).map(R=>Y.indexOf(R));o.push(St(v<<2|p>>4)),y!==64&&o.push(St((p&15)<<4|y>>2)),B!==64&&o.push(St((y&3)<<6|B))}return o.join("").replaceAll("\0","")},Z={BASE2_CHARSET:re,BASE10_CHARSET:oe,BASE16_CHARSET:se,BASE36_CHARSET:ae,BASE62_CHARSET:ie,BASE64_CHARSET:Y,BASE64WEB_CHARSET:ce,convert:Ke,getCharset:Bt,secureBase64:ue,textToBase64:Ye,base64ToText:tn};function en(...t){return t.reduce((e,o)=>e+o,0)}const nn=t=>te(t,{outputLength:256}).toString(),rn=/0b[0-1]+/i;function mt(t){if(typeof t=="number")return Math.round(t);if(t instanceof Object&&(t=ne(t)),typeof t=="string"){if(rn.test(t))return parseInt(t.substring(2,t.length-1),2);const e=parseInt(t);return Number.isNaN(e)?e:en(parseInt(nn(t),16))}else return Date.now()}const O=624,ut=397,on=2567483615,At=2147483648,Ct=2147483647;class sn{constructor(e){ct(this,"mt",new Array(O));ct(this,"mti",O+1);ct(this,"seed");return this.seed=e=mt(e),Array.isArray(e)?this.init_by_array(e,e.length):this.init_seed(e),this}init_seed(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<O;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}init_by_array(e,o){let n,v,p;for(this.init_seed(19650218),n=1,v=0,p=O>o?O:o;p!==0;p--){const y=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((y&4294901760)>>>16)*1664525<<16)+(y&65535)*1664525)+e[v]+v,this.mt[n]>>>=0,n++,v++,n>=O&&(this.mt[0]=this.mt[O-1],n=1),v>=o&&(v=0)}for(p=O-1;p!==0;p--){const y=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((y&4294901760)>>>16)*1566083941<<16)+(y&65535)*1566083941)-n,this.mt[n]>>>=0,n++,n>=O&&(this.mt[0]=this.mt[O-1],n=1)}this.mt[0]=2147483648}random_int(){let e;const o=new Array(0,on);if(this.mti>=O){let n;for(this.mti===O+1&&this.init_seed(5489),n=0;n<O-ut;n++)e=this.mt[n]&At|this.mt[n+1]&Ct,this.mt[n]=this.mt[n+ut]^e>>>1^o[e&1];for(;n<O-1;n++)e=this.mt[n]&At|this.mt[n+1]&Ct,this.mt[n]=this.mt[n+(ut-O)]^e>>>1^o[e&1];e=this.mt[O-1]&At|this.mt[0]&Ct,this.mt[O-1]=this.mt[ut-1]^e>>>1^o[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0}random_int31(){return this.random_int()>>>1}random_incl(){return this.random_int()*(1/4294967295)}random(){return this.random_int()*(1/4294967296)}random_excl(){return(this.random_int()+.5)*(1/4294967296)}random_long(){return((this.random_int()>>>5)*67108864+(this.random_int()>>>6))*(1/9007199254740992)}}function le(t){return new sn(t)}const{BASE10_CHARSET:an,BASE16_CHARSET:cn,BASE64WEB_CHARSET:un}=Z,ln=le(),fe=(t=ln)=>t.random(),Rt=(t,e,o)=>((e===void 0||e===0)&&(e=t,t=0),Math.floor(t+fe(o)*e)),he=(t,e)=>t[Rt(0,t.length,e)],ve=(t,e=1,o)=>{const n=[],v=[];for(let p=0;p<e;p++)v.length===0&&v.push(...t),n.push(v.splice(Rt(0,v.length,o),1)[0]);return n},fn=(t,e)=>ve(t,t.length,e),lt=(t,e=8,o)=>new Array(e).fill(0).map(n=>he(t,o)).join(""),de={MT:le,toSeed:mt,rand:fe,randInt:Rt,charset:lt,choice:he,choices:ve,shuffle:fn,base10:(t=6,e)=>lt(an,t,e),base16:(t=32,e)=>lt(cn,t,e),base64:(t=32,e)=>lt(un,t,e),lcg(t){let e=mt(t);return()=>(e=(e*1664525+1013904223)%4294967296)/4294967296}},{MT:jt,shuffle:hn,randInt:bt}=de,{convert:vn,getCharset:dn}=Z,pn=(t,e)=>{const o=hn(t,e);return()=>(o.push(o.shift()),o)},pe=(t,e=16,o=1,n)=>{const v=Number.isNaN(+e)?64:+e,p=dn(e),y=mt(n!==void 0?n:bt(0,v)),B=jt(y),R=pn(p,jt(bt(0,1e6,B))),s=typeof t=="string"?t.split(""):t,A=[n!==void 0?p[bt(0,v)]:vn(y,10,e),...s.map(b=>R()[p.indexOf(b)])];return--o<1?A.join(""):pe(A,e,o,n)},{textToBase64:mn,base64ToText:Gn,secureBase64:gn}=Z;function yn(t,e=1,o){return typeof t=="object"?t=ne(t):typeof t!="string"&&(t=gt(t)),pe(gn(mn(t)),64,e,o)}function wn(t,e=512,o){const n=yn(t,1,o).substring(1);return e==="MD5"?Ve(n).toString():te(n,{outputLength:e}).toString()}const xn=new Map([["THINKING","Please wait, I am answering another question..."]]);function _n(t,e){switch(t){case"model":if(["gpt3","gpt4","gpt-web","claude-2-web","gpt3-fga"].includes(e))return!0;break;case"temperature":if(typeof e=="number"&&e>=0&&e<=1)return!0;break;case"context":if(typeof e=="boolean")return!0;break}return!1}function Sn(t){try{return JSON.parse(t)}catch{return t}}function me(t){try{const e={};for(const o in t){const n=Sn(t[o]);_n(o,n)&&(e[o]=n)}return e}catch{return{}}}function An(t){try{return me(Yt.parse(t))}catch{return{}}}function Cn(t){try{return Yt.stringify(me(t))}catch{return""}}const Gt=[{name:"GPT-3.5-Turbo",value:"gpt3",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-4",value:"gpt4",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"GPT-Web",value:"gpt-web",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!1,permissionLevel:1},{name:"Claude-2-Web",value:"claude-2-web",isWebBrowsingOptional:!1,isTemperatureOptional:!1,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1},{name:"GPT-3.5-Turbo (stream)",value:"gpt3-fga",isWebBrowsingOptional:!1,isTemperatureOptional:!0,isContextOptional:!0,isStreamAvailable:!0,permissionLevel:1}];let Wt,Vt="";const J=L("gpt4"),nt=L(!0),rt=L(.5),$=L([]),X=L([]),ge=L(),$t=L(!1),ye=L("");function bn(t){$t.value=!0,ge.value=t,ye.value=t.Q,setTimeout(()=>Tn(),0)}function Tn(){try{document.querySelector(".EditQuestionInput textarea").focus()}catch{}}et($t,t=>t?null:q());const we=L(),Pt=L(!1),xe=L("");function Bn(t){Pt.value=!0,we.value=t,xe.value=t.A,setTimeout(()=>En(),0)}function En(){try{document.querySelector(".EditAnswerInput textarea").focus()}catch{}}et(Pt,t=>t?null:q());const q=()=>{try{{if(it().isMobileScreen)return;const t=document.querySelector(".InputBox textarea");t.click(),t.focus()}}catch{}},_e=()=>{try{const t=document.getElementById(D()).parentElement,e=document.querySelector(".ConversationList"),o=t.offsetTop-e.offsetTop-t.clientHeight/2,n=o-e.clientHeight+t.clientHeight*2;e.scrollTop>o&&e.scrollTo({left:0,top:o,behavior:"smooth"}),e.scrollTop<n&&e.scrollTo({left:0,top:n,behavior:"smooth"})}catch{}},ft=()=>new Promise((t,e)=>{$fetch("/api/curva/check",{method:"POST"}).then(o=>{X.value=o,_e(),t(!0)}).catch(o=>{z.error("Initialization Failed"),e(o)})}),In=t=>new Promise(async(e,o)=>{if(t==null)return e([]);const n=await $fetch("/api/curva/history",{method:"POST",body:{id:t}});(!n||n.length===0)&&pt("/c/");try{e(n.map(v=>Kt({...v,t:new Date(v.t),done:!0})))}catch{pt("/c/"),e([])}}),Se=async function(t){return[]},kn=async()=>{try{const t=$.value.at(-1),e=await Se(t.Q),o=F.isAtBottom();t.more=e,o&&F()}catch(t){console.error(t)}},Ot=(t=!1)=>{J.value="gpt4",nt.value=!0,rt.value=.5,t&&z.success("Conversation settings have been reset.")};Ot();const N=L(!1),Dt=L(N.value),Lt=L(N.value);et(Dt,t=>{N.value=t});et(Lt,t=>{N.value=t});et(N,t=>{const{isMobileScreen:e}=it();Dt.value=e?!1:t,Lt.value=e?t:!1,setTimeout(()=>q(),0)});{let t,e=it().isMobileScreen?"drawer":"sidebar";window.addEventListener("resize",()=>{clearTimeout(t),t=setTimeout(()=>{const o=it().isMobileScreen?"drawer":"sidebar";N.value&&o!=e&&(N.value=!1,setTimeout(()=>{N.value=!0},0),e=o)},100)})}const ht=L(""),Hn=Jt(()=>J.value.startsWith("gpt3")?16e3:32e3),Rn=(()=>{const t=()=>[77,68,53].map(n=>String.fromCharCode(n)).join(""),e=(n,v)=>({hash:wn(n,t(),v),timestamp:gt(v)}),o=(n,v,p,y,B,R,s)=>{let A=D();return A||(A=de.base64(8),X.value.unshift({id:A,name:"",mtime:Date.now(),config:""}),pt(`/c/${A}?feature=new`),Ae(A)),{conv:A,messages:n,model:v,temperature:p,t:y,tz:B,id:R,streamId:s}};return async(n,v)=>{const p=new Date,y=p.getTime(),B=p.getTimezoneOffset()/60*-1,R=(()=>{if(!nt.value)return[{role:"user",content:(n==null?void 0:n.Q)||""}];const s=$.value.lastIndexOf(n)+1||$.value.length;let A=$.value.slice(0,s);return A=A.slice(A.length-100),A.map(b=>[{role:"user",content:b.Q},{role:"assistant",content:b.A}].filter(T=>T.content)).flat()})();try{const s=o(R,J.value,rt.value,y,B,n==null?void 0:n.id,v),A=e(R,y);return await $fetch("/api/curva/answer",{method:"POST",headers:A,body:s})}catch{return{answer:"",error:"Error while sending request."}}}})(),Wn=(t="",e="",o=!1)=>Kt({done:o,Q:t,A:e,queries:[],urls:[],dt:void 0,t:new Date}),vt=new Set,Tt=()=>{X.value=[],$.value=[],pt("/c/"),Et=!0};let Et=!0;function Xt(){{const t=De();t.get("feature")==="new"&&(t.delete("feature"),t.save(),zt())}}const qt=(t,e)=>{const o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),o.remove()},[$n,D,Ae]=(()=>{const t=L("");return[Jt(()=>t.value),()=>t.value,e=>{var o,n;return t.value=e===void 0?(n=(o=Wt._route)==null?void 0:o.params)==null?void 0:n.conv:e}]})(),dt=()=>{var e;const t=D();return((e=X.value.filter(o=>o.id===t)[0])==null?void 0:e.name)||""};async function zt(t,e){return t=t||D(),t?await $fetch("/api/curva/conv",{method:"PUT",body:{id:t,name:e||dt(),config:Cn({model:J.value,temperature:rt.value,context:nt.value})}}):{cancel:!0}}let It=!1;const Pn=t=>{var n;if(t===void 0&&(t=D()),t==null)return;const e=An(((n=X.value.find(v=>v.id===t))==null?void 0:n.config)||""),o=Object.keys(e);if(o.length===0)Ot();else{It=!0;try{for(const v of o){const p=e[v];switch(v){case"model":J.value=p;break;case"temperature":rt.value=p;break;case"context":nt.value=p;break}}}finally{It=!1}}z.info("Conversation settings have been loaded.")};setTimeout(()=>{let t;[J,nt,rt].forEach(e=>{et(e,(o,n)=>{Wt&&!It&&o!==n&&vt.size===0&&(clearTimeout(t),t=setTimeout(async()=>{try{const{cancel:v=!1}=await zt();v||z.info("Conversation settings have been saved.")}catch(v){console.error(v),z.warning("Failed to save conversation settings.")}finally{clearTimeout(t)}},typeof e.value=="number"?500:0))})})},1e3);const On=(t,e)=>{e!==void 0&&(t[e]="");const{id:o,Q:n,A:v}=t;$.value=$.value.filter(p=>p.Q||p.A),$fetch("/api/curva/message",{method:"PUT",body:{conv:D(),id:o,Q:n,A:v}}).then(()=>z.info(`The message has been ${e?"deleted":"saved"}.`)).catch(()=>z.error(`An error occurred while ${e?"deleting":"saving"} the message.`))},Dn=()=>{let t=0;const e=`${Z.convert(D(),"64w",10)}.md`,o=$.value.map(n=>{t++;try{return(n.t?`${new Date(n.t.getTime()-(n.dt||0)).toLocaleString()}${n.dt===void 0?"":" (Î”t: "+n.dt.toString()+"ms)"}

`:"")+(n.Q?`QUESTION ${t}:

${n.Q.replaceAll(`
`,`

`)}`:"")+(n.Q&&n.A?`

`:"")+(n.A?`ANSWER ${t}:

${n.A}`:"")}catch{return"(Unknown message)"}}).join(`

---

`)+`

---

`;qt(e,o)},Ln=()=>{const t=$.value.map(e=>[{role:"user",content:e.Q},{role:"assistant",content:e.A}]).flat().filter(e=>e.content);qt(`${Z.convert(D(),"64w",10)}.json`,JSON.stringify(t,null,4))},qn=()=>{const t=$.value.map(e=>{var o,n;return[{role:"user",content:e.Q},{role:"assistant",content:e.A,queries:(o=e.queries)!=null&&o.length?e.queries:void 0,urls:(n=e.urls)!=null&&n.length?e.urls:void 0,createdAt:new Date(e.t.getTime()).toUTCString(),timeUsed:e.dt||void 0}]}).flat().filter(e=>e.content);qt(`${Z.convert(D(),"64w",10)}.json`,JSON.stringify(t,null,4))};document.addEventListener("keyup",t=>{switch(t.key){case"/":case"Enter":q();break;case"Escape":N.value=!N.value;break}});const Ce=L(!1);document.addEventListener("scroll",()=>{Ce.value=!We()});function Vn(){const{authEventTarget:t}=Le(),e=Mt("appName").value,o=$e();["temperature-suffix","web-browsing","temperature"].forEach(_=>{o.delete(_,{path:"/"}),o.delete(_)}),Wt=Pe();const n=()=>{try{Qt(`${dt()||y("chat.title")} - ${e}`)}catch{Qt(`${y("chat.title")} - ${e}`)}};t.addListener("login",Tt),t.addListener("logout",Tt);const v=async _=>{setTimeout(()=>{it().isMobileScreen&&(N.value=!1)},0),$.value=[];const S=yt.service({text:y("chat.ldConv")+"...",lock:!0});try{const w=_===null&&X.value.length>0?null:ft(),h=_===null?null:await In(_);h!==null&&D()===_&&($.value=h,kn()),await Promise.all([w,F(1e3)]),Pn(_)}finally{S.close(),await F(500),q(),_e(),await F(500)}},p=async(_,S=!1)=>{Ae(_||"");const w=Promise.all([...vt]),h=Et&&S?new Promise(async l=>{await v(_),Xt(),l(null)}):S?new Promise(l=>l(null)):v(_);Et=!1,vt.add(h);try{await w}catch{}try{await h}finally{vt.delete(h)}},y=Oe().t,B=Mt("version"),R=async(_,S)=>{if(document.querySelectorAll(".Message.T").length>0)return z.info("Please wait for the completion of the previous question."),q(),!1;const h=(_!==void 0?_:ht.value).trim();if(_===void 0&&(ht.value="",h===""))return q(),!1;const l=(S?$.value.filter(E=>E.id===S).at(-1):void 0)||Wn(h,"",!1);$.value.includes(l)||$.value.push(l);const r=l.A||"";l.done=!1,l.Q=h,l.A="",l.urls=[],l.queries=[],l.dt&&(l.dt=void 0);const f=Se(),d=F.isAtBottom(),m=D();d&&F(),q();const x=1;let g=!1;const W=await new Promise(async E=>{var at;if(!((at=Gt.find(tt=>tt.value===J.value))!=null&&at.isStreamAvailable))return E(void 0);const P=[],M=setInterval(()=>{P.length&&(l.A+=P.shift(),F.keepAtBottom()),l.done&&(clearInterval(M),a.abort())},x),a=new AbortController,i=await fetch("/api/curva/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:"{}",signal:a.signal}),c=new TextDecoder,u=i.body.getReader();let ot=!1;const st=async()=>{await u.read().then(async({value:tt,done:be})=>{if(be){if(P.length===0){l.done=!0;return}g=!0;const Te=setInterval(()=>{P.length===0&&(l.done=!0,g=!1,clearInterval(Te))},x);return}const Nt=c.decode(tt);ot?P.push(Nt):(E(Nt),ot=!0),st()})};st()}),C=await Rn(l,W);Xt(),Vt!==m&&ft().finally(()=>{Vt=D()});const{id:I,answer:H="",error:k,urls:U=[],queries:j=[],dt:G=0,version:Q}=C;if(g){const E=setInterval(()=>{g||(l.done=!0,l.A!==H&&(l.A=H||""),clearInterval(E))},x)}else l.done=!0,l.A!==H&&(l.A=H||"");l.t=new Date,l.dt=G||void 0,l.id=I||void 0,l.urls=U||[],l.queries=j||[];const V=(E=>E?(E.type==="warning"?z.warning(E.content):z.error(E.content),l.A="Oops! Something went wrong!",!0):!1)((()=>{if(H===""){if(k){const E=()=>{S?l.A=r:($.value.pop(),ht.value=h)};if(typeof k=="string"&&k.startsWith("You have tried too many times."))return E(),{type:"warning",content:k};switch(k){case"THINKING":return E(),{type:"warning",content:xn.get(k)};default:return{type:"error",content:k}}}return{type:"error",content:y("error.plzRefresh")}}})());return setTimeout(async()=>{if(Q&&Q!==B.value){const E=setTimeout(()=>location.reload(),3e3);wt.confirm(y("action.newVersion"),y("message.notice"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),type:"warning"}).then(()=>q()).catch(()=>q()).finally(()=>{clearTimeout(E),yt.service({text:"Loading...",lock:!0}),location.reload()})}},0),f.then(E=>{const P=F.isAtBottom();l.more=E,P&&F()}),V};return{models:Gt,showScrollToBottomButton:Ce,isEditingQuestion:$t,editingQuestion:ge,editingQuestionContent:ye,callEditQuestionDialog:bn,isEditingAnswer:Pt,editingAnswer:we,editingAnswerContent:xe,callEditAnswerDialog:Bn,model:J,conversations:X,messages:$,temperature:rt,contextMode:nt,openMenu:N,openSidebarController:Dt,openDrawerController:Lt,inputValue:ht,inputMaxLength:Hn,currentConvIdComputed:$n,getCurrentConvId:D,getCurrentConvName:dt,checkTokenAndGetConversations:ft,loadChat:p,sendMessage:R,updateMessage:On,regenerateMessage:async _=>{if($.value.length===0)return;const{Q:S,id:w}=_||$.value.pop();R(S||"",w)},focusInput:q,refreshConversation:()=>{p(D()).finally(()=>q())},renameConversation:(_,S="")=>{_||(_=D(),S=dt()),wt.prompt(y("message.renameConvHint"),y("message.setting"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),inputValue:S,inputPlaceholder:Z.convert(_,"64w",10)}).then(async({value:w})=>{try{await zt(_,w),z({type:"success",message:y("message.renameSuccess")}),await ft(),n()}catch{z({type:"error",message:"Oops! Something went wrong!"})}}).catch(()=>{})},deleteConversation:_=>{const S=_||D();let w="createNewChat";wt.confirm(y("message.deleteConvConfirm"),y("message.warning"),{confirmButtonText:y("message.ok"),cancelButtonText:y("message.cancel"),type:"warning"}).then(async()=>{var f;const h=yt.service({text:y("chat.dltConv")+"...",lock:!0});try{await $fetch("/api/curva/conv",{method:"DELETE",body:{id:S}})}catch{}h.close();const l=D();_===l&&((f=document.getElementById(w))==null||f.click());const r=X.value.findIndex(d=>d.id===l);r!=-1&&X.value.splice(r,1)})},resetConvConfig:Ot,exportAsMarkdown:Dn,exportAsJson:Ln,exportAsJsonDetailed:qn,clear:Tt}}export{Z as b,de as r,gt as s,Vn as u};
