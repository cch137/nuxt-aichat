var Se=Object.defineProperty;var Be=(t,e,o)=>e in t?Se(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var st=(t,e,o)=>(Be(t,typeof e!="symbol"?e+"":e,o),o);import{Q as Et,ch as Ce,ci as Ae,cj as be,ck as Te,cl as K,r as z,h as ot,W as Ee,E as N,i as Ot,cm as He,g as ke,v as dt,aD as Re,cn as Bt,s as mt,m as Qt,co as Ie}from"./entry.c8d59687.js";import{E as pt}from"./el-overlay.d4b13c41.js";import"./el-button.9cf1b9e4.js";import"./el-input.8c6d3326.js";import{u as jt}from"./useTitle.22e79668.js";import{l as $e,s as Ht}from"./str.d457f5f4.js";var We=Ce,qe=Ae,De=be,Pe={formats:De,parse:qe,stringify:We};const Gt=Et(Pe);async function V(t=0){return await new Promise((e,o)=>{setTimeout(()=>{try{window.scrollTo(0,document.body.scrollHeight),e(null)}catch(n){o(n)}},+t||0)})}const Ne={get isMobileScreen(){return window.innerWidth<600},get isTouchScreen(){return"ontouchstart"in document||navigator.maxTouchPoints>0}};function Lt(){return Ne}const Vt="01",Xt="0123456789",Kt="0123456789abcdef",Jt="0123456789abcdefghijklmnopqrstuvwxyz",Zt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Ct=t=>{switch(typeof t!="string"&&(t=$e(t)),t){case"2":return Vt;case"10":return Xt;case"16":return Kt;case"36":return Jt;case"62":return Zt;case"64":return J;case"64w":case"64+":return Yt;default:return t}},ze=(t,e,o,n=0)=>{typeof t!="string"&&(t=Ht(t));let c=BigInt(0);e=Ct(e);const h=e.length;for(let T=0;T<t.length;T++)c+=BigInt(e.indexOf(t[T])*Math.pow(h,t.length-1-T));let A="";if(o=Ct(o),A===""){const T=BigInt(o.length);for(;c>0;)A=o.charAt(+BigInt(c%T).toString())+A,c=BigInt(c/T)}return(A===""?o.charAt(0):A).padStart(n,o[0])},Oe=t=>{const e=t.split("").map(h=>h.charCodeAt(0)),o=[];let n=0;for(;n<e.length;){const[h,A=0,T=0]=e.slice(n,n+=3),H=(h<<16)+(A<<8)+T,a=H>>18,x=H>>12&63,b=H>>6&63,d=H&63;o.push(J[a],J[x],J[b],J[d])}const c=e.length%3;return o.join("").slice(0,1+o.length-c)+(c===2?"==":c===1?"=":"")},je=/[^A-Za-z0-9+/]/g,te=t=>t.replace(je,""),yt=t=>String.fromCharCode(+t),Le=t=>{const e=te(t).split(""),o=[];let n=0;for(;n<e.length;){const[c,h,A,T]=e.slice(n,n+=4).map(H=>J.indexOf(H));o.push(yt(c<<2|h>>4)),A!==64&&o.push(yt((h&15)<<4|A>>2)),T!==64&&o.push(yt((A&3)<<6|T))}return o.join("").replaceAll("\0","")},Y={BASE2_CHARSET:Vt,BASE10_CHARSET:Xt,BASE16_CHARSET:Kt,BASE36_CHARSET:Jt,BASE62_CHARSET:Zt,BASE64_CHARSET:J,BASE64WEB_CHARSET:Yt,convert:ze,getCharset:Ct,secureBase64:te,textToBase64:Oe,base64ToText:Le};var ee={exports:{}};function Me(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wt={exports:{}},Mt;function kt(){return Mt||(Mt=1,function(t,e){(function(o,n){t.exports=n()})(K,function(){var o=o||function(n,c){var h;if(typeof window<"u"&&window.crypto&&(h=window.crypto),typeof self<"u"&&self.crypto&&(h=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(h=globalThis.crypto),!h&&typeof window<"u"&&window.msCrypto&&(h=window.msCrypto),!h&&typeof K<"u"&&K.crypto&&(h=K.crypto),!h&&typeof Me=="function")try{h=Te}catch{}var A=function(){if(h){if(typeof h.getRandomValues=="function")try{return h.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof h.randomBytes=="function")try{return h.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},T=Object.create||function(){function r(){}return function(v){var g;return r.prototype=v,g=new r,r.prototype=null,g}}(),H={},a=H.lib={},x=a.Base=function(){return{extend:function(r){var v=T(this);return r&&v.mixIn(r),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var r=this.extend();return r.init.apply(r,arguments),r},init:function(){},mixIn:function(r){for(var v in r)r.hasOwnProperty(v)&&(this[v]=r[v]);r.hasOwnProperty("toString")&&(this.toString=r.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),b=a.WordArray=x.extend({init:function(r,v){r=this.words=r||[],v!=c?this.sigBytes=v:this.sigBytes=r.length*4},toString:function(r){return(r||S).stringify(this)},concat:function(r){var v=this.words,g=r.words,m=this.sigBytes,w=r.sigBytes;if(this.clamp(),m%4)for(var y=0;y<w;y++){var k=g[y>>>2]>>>24-y%4*8&255;v[m+y>>>2]|=k<<24-(m+y)%4*8}else for(var B=0;B<w;B+=4)v[m+B>>>2]=g[B>>>2];return this.sigBytes+=w,this},clamp:function(){var r=this.words,v=this.sigBytes;r[v>>>2]&=4294967295<<32-v%4*8,r.length=n.ceil(v/4)},clone:function(){var r=x.clone.call(this);return r.words=this.words.slice(0),r},random:function(r){for(var v=[],g=0;g<r;g+=4)v.push(A());return new b.init(v,r)}}),d=H.enc={},S=d.Hex={stringify:function(r){for(var v=r.words,g=r.sigBytes,m=[],w=0;w<g;w++){var y=v[w>>>2]>>>24-w%4*8&255;m.push((y>>>4).toString(16)),m.push((y&15).toString(16))}return m.join("")},parse:function(r){for(var v=r.length,g=[],m=0;m<v;m+=2)g[m>>>3]|=parseInt(r.substr(m,2),16)<<24-m%8*4;return new b.init(g,v/2)}},C=d.Latin1={stringify:function(r){for(var v=r.words,g=r.sigBytes,m=[],w=0;w<g;w++){var y=v[w>>>2]>>>24-w%4*8&255;m.push(String.fromCharCode(y))}return m.join("")},parse:function(r){for(var v=r.length,g=[],m=0;m<v;m++)g[m>>>2]|=(r.charCodeAt(m)&255)<<24-m%4*8;return new b.init(g,v)}},p=d.Utf8={stringify:function(r){try{return decodeURIComponent(escape(C.stringify(r)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(r){return C.parse(unescape(encodeURIComponent(r)))}},i=a.BufferedBlockAlgorithm=x.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(r){typeof r=="string"&&(r=p.parse(r)),this._data.concat(r),this._nDataBytes+=r.sigBytes},_process:function(r){var v,g=this._data,m=g.words,w=g.sigBytes,y=this.blockSize,k=y*4,B=w/k;r?B=n.ceil(B):B=n.max((B|0)-this._minBufferSize,0);var E=B*y,R=n.min(E*4,w);if(E){for(var I=0;I<E;I+=y)this._doProcessBlock(m,I);v=m.splice(0,E),g.sigBytes-=R}return new b.init(v,R)},clone:function(){var r=x.clone.call(this);return r._data=this._data.clone(),r},_minBufferSize:0});a.Hasher=i.extend({cfg:x.extend(),init:function(r){this.cfg=this.cfg.extend(r),this.reset()},reset:function(){i.reset.call(this),this._doReset()},update:function(r){return this._append(r),this._process(),this},finalize:function(r){r&&this._append(r);var v=this._doFinalize();return v},blockSize:16,_createHelper:function(r){return function(v,g){return new r.init(g).finalize(v)}},_createHmacHelper:function(r){return function(v,g){return new _.HMAC.init(r,g).finalize(v)}}});var _=H.algo={};return H}(Math);return o})}(wt)),wt.exports}var _t={exports:{}},Ft;function Fe(){return Ft||(Ft=1,function(t,e){(function(o,n){t.exports=n(kt())})(K,function(o){return function(n){var c=o,h=c.lib,A=h.Base,T=h.WordArray,H=c.x64={};H.Word=A.extend({init:function(a,x){this.high=a,this.low=x}}),H.WordArray=A.extend({init:function(a,x){a=this.words=a||[],x!=n?this.sigBytes=x:this.sigBytes=a.length*8},toX32:function(){for(var a=this.words,x=a.length,b=[],d=0;d<x;d++){var S=a[d];b.push(S.high),b.push(S.low)}return T.create(b,this.sigBytes)},clone:function(){for(var a=A.clone.call(this),x=a.words=this.words.slice(0),b=x.length,d=0;d<b;d++)x[d]=x[d].clone();return a}})}(),o})}(_t)),_t.exports}(function(t,e){(function(o,n,c){t.exports=n(kt(),Fe())})(K,function(o){return function(n){var c=o,h=c.lib,A=h.WordArray,T=h.Hasher,H=c.x64,a=H.Word,x=c.algo,b=[],d=[],S=[];(function(){for(var i=1,_=0,r=0;r<24;r++){b[i+5*_]=(r+1)*(r+2)/2%64;var v=_%5,g=(2*i+3*_)%5;i=v,_=g}for(var i=0;i<5;i++)for(var _=0;_<5;_++)d[i+5*_]=_+(2*i+3*_)%5*5;for(var m=1,w=0;w<24;w++){for(var y=0,k=0,B=0;B<7;B++){if(m&1){var E=(1<<B)-1;E<32?k^=1<<E:y^=1<<E-32}m&128?m=m<<1^113:m<<=1}S[w]=a.create(y,k)}})();var C=[];(function(){for(var i=0;i<25;i++)C[i]=a.create()})();var p=x.SHA3=T.extend({cfg:T.cfg.extend({outputLength:512}),_doReset:function(){for(var i=this._state=[],_=0;_<25;_++)i[_]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(i,_){for(var r=this._state,v=this.blockSize/2,g=0;g<v;g++){var m=i[_+2*g],w=i[_+2*g+1];m=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360;var y=r[g];y.high^=w,y.low^=m}for(var k=0;k<24;k++){for(var B=0;B<5;B++){for(var E=0,R=0,I=0;I<5;I++){var y=r[B+5*I];E^=y.high,R^=y.low}var $=C[B];$.high=E,$.low=R}for(var B=0;B<5;B++)for(var O=C[(B+4)%5],U=C[(B+1)%5],Q=U.high,G=U.low,E=O.high^(Q<<1|G>>>31),R=O.low^(G<<1|Q>>>31),I=0;I<5;I++){var y=r[B+5*I];y.high^=E,y.low^=R}for(var P=1;P<25;P++){var E,R,y=r[P],j=y.high,L=y.low,s=b[P];s<32?(E=j<<s|L>>>32-s,R=L<<s|j>>>32-s):(E=L<<s-32|j>>>64-s,R=j<<s-32|L>>>64-s);var u=C[d[P]];u.high=E,u.low=R}var l=C[0],f=r[0];l.high=f.high,l.low=f.low;for(var B=0;B<5;B++)for(var I=0;I<5;I++){var P=B+5*I,y=r[P],Dt=C[P],Pt=C[(B+1)%5+5*I],Nt=C[(B+2)%5+5*I];y.high=Dt.high^~Pt.high&Nt.high,y.low=Dt.low^~Pt.low&Nt.low}var y=r[0],zt=S[k];y.high^=zt.high,y.low^=zt.low}},_doFinalize:function(){var i=this._data,_=i.words;this._nDataBytes*8;var r=i.sigBytes*8,v=this.blockSize*32;_[r>>>5]|=1<<24-r%32,_[(n.ceil((r+1)/v)*v>>>5)-1]|=128,i.sigBytes=_.length*4,this._process();for(var g=this._state,m=this.cfg.outputLength/8,w=m/8,y=[],k=0;k<w;k++){var B=g[k],E=B.high,R=B.low;E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,y.push(R),y.push(E)}return new A.init(y,m)},clone:function(){for(var i=T.clone.call(this),_=i._state=this._state.slice(0),r=0;r<25;r++)_[r]=_[r].clone();return i}});c.SHA3=T._createHelper(p),c.HmacSHA3=T._createHmacHelper(p)}(Math),o.SHA3})})(ee);var Ue=ee.exports;const re=Et(Ue);function Qe(...t){return t.reduce((e,o)=>e+o,0)}function Ge(t){try{return typeof t[Symbol==null?void 0:Symbol.iterator]=="function"}catch{return!1}}function ne(t){const e=new Set;return JSON.stringify(t,(n,c)=>{if(typeof c=="object"&&c!==null){if(e.has(c))return;e.add(c),Ge(c)&&(c=[...c])}return c})}const Ve=t=>re(t,{outputLength:256}).toString(),Xe=/0b[0-1]+/i;function at(t){if(typeof t=="number")return Math.round(t);if(t instanceof Object&&(t=ne(t)),typeof t=="string"){if(Xe.test(t))return parseInt(t.substring(2,t.length-1),2);const e=parseInt(t);return Number.isNaN(e)?e:Qe(parseInt(Ve(t),16))}else return Date.now()}const q=624,it=397,Ke=2567483615,xt=2147483648,St=2147483647;class Je{constructor(e){st(this,"mt",new Array(q));st(this,"mti",q+1);st(this,"seed");return this.seed=e=at(e),Array.isArray(e)?this.init_by_array(e,e.length):this.init_seed(e),this}init_seed(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<q;this.mti++)e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(((e&4294901760)>>>16)*1812433253<<16)+(e&65535)*1812433253+this.mti,this.mt[this.mti]>>>=0}init_by_array(e,o){let n,c,h;for(this.init_seed(19650218),n=1,c=0,h=q>o?q:o;h!==0;h--){const A=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((A&4294901760)>>>16)*1664525<<16)+(A&65535)*1664525)+e[c]+c,this.mt[n]>>>=0,n++,c++,n>=q&&(this.mt[0]=this.mt[q-1],n=1),c>=o&&(c=0)}for(h=q-1;h!==0;h--){const A=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(((A&4294901760)>>>16)*1566083941<<16)+(A&65535)*1566083941)-n,this.mt[n]>>>=0,n++,n>=q&&(this.mt[0]=this.mt[q-1],n=1)}this.mt[0]=2147483648}random_int(){let e;const o=new Array(0,Ke);if(this.mti>=q){let n;for(this.mti===q+1&&this.init_seed(5489),n=0;n<q-it;n++)e=this.mt[n]&xt|this.mt[n+1]&St,this.mt[n]=this.mt[n+it]^e>>>1^o[e&1];for(;n<q-1;n++)e=this.mt[n]&xt|this.mt[n+1]&St,this.mt[n]=this.mt[n+(it-q)]^e>>>1^o[e&1];e=this.mt[q-1]&xt|this.mt[0]&St,this.mt[q-1]=this.mt[it-1]^e>>>1^o[e&1],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>0}random_int31(){return this.random_int()>>>1}random_incl(){return this.random_int()*(1/4294967295)}random(){return this.random_int()*(1/4294967296)}random_excl(){return(this.random_int()+.5)*(1/4294967296)}random_long(){return((this.random_int()>>>5)*67108864+(this.random_int()>>>6))*(1/9007199254740992)}}function oe(t){return new Je(t)}const{BASE10_CHARSET:Ze,BASE16_CHARSET:Ye,BASE64WEB_CHARSET:tr}=Y,er=oe(),ae=(t=er)=>t.random(),Rt=(t,e,o)=>((e===void 0||e===0)&&(e=t,t=0),Math.floor(t+ae(o)*e)),se=(t,e)=>t[Rt(0,t.length,e)],ie=(t,e=1,o)=>{const n=[],c=[];for(let h=0;h<e;h++)c.length===0&&c.push(...t),n.push(c.splice(Rt(0,c.length,o),1)[0]);return n},rr=(t,e)=>ie(t,t.length,e),ct=(t,e=8,o)=>new Array(e).fill(0).map(n=>se(t,o)).join(""),ce={MT:oe,toSeed:at,rand:ae,randInt:Rt,charset:ct,choice:se,choices:ie,shuffle:rr,base10:(t=6,e)=>ct(Ze,t,e),base16:(t=32,e)=>ct(Ye,t,e),base64:(t=32,e)=>ct(tr,t,e),lcg(t){let e=at(t);return()=>(e=(e*1664525+1013904223)%4294967296)/4294967296}};var ue={exports:{}};(function(t,e){(function(o,n){t.exports=n(kt())})(K,function(o){return function(n){var c=o,h=c.lib,A=h.WordArray,T=h.Hasher,H=c.algo,a=[];(function(){for(var p=0;p<64;p++)a[p]=n.abs(n.sin(p+1))*4294967296|0})();var x=H.MD5=T.extend({_doReset:function(){this._hash=new A.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,i){for(var _=0;_<16;_++){var r=i+_,v=p[r];p[r]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}var g=this._hash.words,m=p[i+0],w=p[i+1],y=p[i+2],k=p[i+3],B=p[i+4],E=p[i+5],R=p[i+6],I=p[i+7],$=p[i+8],O=p[i+9],U=p[i+10],Q=p[i+11],G=p[i+12],P=p[i+13],j=p[i+14],L=p[i+15],s=g[0],u=g[1],l=g[2],f=g[3];s=b(s,u,l,f,m,7,a[0]),f=b(f,s,u,l,w,12,a[1]),l=b(l,f,s,u,y,17,a[2]),u=b(u,l,f,s,k,22,a[3]),s=b(s,u,l,f,B,7,a[4]),f=b(f,s,u,l,E,12,a[5]),l=b(l,f,s,u,R,17,a[6]),u=b(u,l,f,s,I,22,a[7]),s=b(s,u,l,f,$,7,a[8]),f=b(f,s,u,l,O,12,a[9]),l=b(l,f,s,u,U,17,a[10]),u=b(u,l,f,s,Q,22,a[11]),s=b(s,u,l,f,G,7,a[12]),f=b(f,s,u,l,P,12,a[13]),l=b(l,f,s,u,j,17,a[14]),u=b(u,l,f,s,L,22,a[15]),s=d(s,u,l,f,w,5,a[16]),f=d(f,s,u,l,R,9,a[17]),l=d(l,f,s,u,Q,14,a[18]),u=d(u,l,f,s,m,20,a[19]),s=d(s,u,l,f,E,5,a[20]),f=d(f,s,u,l,U,9,a[21]),l=d(l,f,s,u,L,14,a[22]),u=d(u,l,f,s,B,20,a[23]),s=d(s,u,l,f,O,5,a[24]),f=d(f,s,u,l,j,9,a[25]),l=d(l,f,s,u,k,14,a[26]),u=d(u,l,f,s,$,20,a[27]),s=d(s,u,l,f,P,5,a[28]),f=d(f,s,u,l,y,9,a[29]),l=d(l,f,s,u,I,14,a[30]),u=d(u,l,f,s,G,20,a[31]),s=S(s,u,l,f,E,4,a[32]),f=S(f,s,u,l,$,11,a[33]),l=S(l,f,s,u,Q,16,a[34]),u=S(u,l,f,s,j,23,a[35]),s=S(s,u,l,f,w,4,a[36]),f=S(f,s,u,l,B,11,a[37]),l=S(l,f,s,u,I,16,a[38]),u=S(u,l,f,s,U,23,a[39]),s=S(s,u,l,f,P,4,a[40]),f=S(f,s,u,l,m,11,a[41]),l=S(l,f,s,u,k,16,a[42]),u=S(u,l,f,s,R,23,a[43]),s=S(s,u,l,f,O,4,a[44]),f=S(f,s,u,l,G,11,a[45]),l=S(l,f,s,u,L,16,a[46]),u=S(u,l,f,s,y,23,a[47]),s=C(s,u,l,f,m,6,a[48]),f=C(f,s,u,l,I,10,a[49]),l=C(l,f,s,u,j,15,a[50]),u=C(u,l,f,s,E,21,a[51]),s=C(s,u,l,f,G,6,a[52]),f=C(f,s,u,l,k,10,a[53]),l=C(l,f,s,u,U,15,a[54]),u=C(u,l,f,s,w,21,a[55]),s=C(s,u,l,f,$,6,a[56]),f=C(f,s,u,l,L,10,a[57]),l=C(l,f,s,u,R,15,a[58]),u=C(u,l,f,s,P,21,a[59]),s=C(s,u,l,f,B,6,a[60]),f=C(f,s,u,l,Q,10,a[61]),l=C(l,f,s,u,y,15,a[62]),u=C(u,l,f,s,O,21,a[63]),g[0]=g[0]+s|0,g[1]=g[1]+u|0,g[2]=g[2]+l|0,g[3]=g[3]+f|0},_doFinalize:function(){var p=this._data,i=p.words,_=this._nDataBytes*8,r=p.sigBytes*8;i[r>>>5]|=128<<24-r%32;var v=n.floor(_/4294967296),g=_;i[(r+64>>>9<<4)+15]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,i[(r+64>>>9<<4)+14]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,p.sigBytes=(i.length+1)*4,this._process();for(var m=this._hash,w=m.words,y=0;y<4;y++){var k=w[y];w[y]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return m},clone:function(){var p=T.clone.call(this);return p._hash=this._hash.clone(),p}});function b(p,i,_,r,v,g,m){var w=p+(i&_|~i&r)+v+m;return(w<<g|w>>>32-g)+i}function d(p,i,_,r,v,g,m){var w=p+(i&r|_&~r)+v+m;return(w<<g|w>>>32-g)+i}function S(p,i,_,r,v,g,m){var w=p+(i^_^r)+v+m;return(w<<g|w>>>32-g)+i}function C(p,i,_,r,v,g,m){var w=p+(_^(i|~r))+v+m;return(w<<g|w>>>32-g)+i}c.MD5=T._createHelper(x),c.HmacMD5=T._createHmacHelper(x)}(Math),o.MD5})})(ue);var nr=ue.exports;const or=Et(nr),{MT:gt,shuffle:ar,randInt:ft}=ce,{convert:le,getCharset:fe}=Y,he=(t,e)=>{const o=ar(t,e);return()=>(o.push(o.shift()),o)},ve=(t,e=16,o=1,n)=>{const c=Number.isNaN(+e)?64:+e,h=fe(e),A=at(n!==void 0?n:ft(0,c)),T=gt(A),H=he(h,gt(ft(0,1e6,T))),a=typeof t=="string"?t.split(""):t,x=[n!==void 0?h[ft(0,c)]:le(A,10,e),...a.map(b=>H()[h.indexOf(b)])];return--o<1?x.join(""):ve(x,e,o,n)},de=(t,e=16,o=1,n)=>{const c=fe(e),h=at(n!==void 0?n:+le(t[0],e,10)),A=gt(h),T=he(c,gt(ft(0,1e6,A))),a=(typeof t=="string"?t.split(""):t).slice(1,t.length).map(x=>c[T().indexOf(x)]);return--o<1?a.join(""):de(a,e,o,n)},{textToBase64:sr,base64ToText:ir,secureBase64:cr}=Y;function ge(t,e=1,o){return typeof t=="object"?t=ne(t):typeof t!="string"&&(t=Ht(t)),ve(cr(sr(t)),64,e,o)}function ur(t,e=1,o,n=!0){if(t=ir(de(t,64,e,o)),!n)return t;try{return JSON.parse(t)}catch{return t}}function lr(t,e=512,o){const n=ge(t,1,o).substring(1);return e==="MD5"?or(n).toString():re(n,{outputLength:e}).toString()}const fr={e:ge,d:ur,h:lr},hr=new Map([["THINKING","Please wait, I am answering another question..."]]);function vr(t,e){switch(t){case"model":if(["gpt3","gpt4","gpt-web","claude-2-web","gpt3-fga"].includes(e))return!0;break;case"temperature":if(typeof e=="number"&&e>=0&&e<=1)return!0;break;case"context":if(typeof e=="boolean")return!0;break}return!1}function dr(t){try{return JSON.parse(t)}catch{return t}}function me(t){try{const e={};for(const o in t){const n=dr(t[o]);vr(o,n)&&(e[o]=n)}return e}catch{return{}}}function gr(t){try{return me(Gt.parse(t))}catch{return{}}}function mr(t){try{return Gt.stringify(me(t))}catch{return""}}let It,At="";const pe=z(),$t=z(!1),ye=z(""),Z=z("gpt4"),tt=z(!0),et=z(.5),W=z([]),F=z([]);ot($t,t=>{t||M()});const pr=t=>{$t.value=!0,pe.value=t,ye.value=t.Q,setTimeout(()=>we(),0)};function we(){try{document.querySelector(".EditMessageInput textarea").focus()}catch{}}const M=()=>{try{const t=document.querySelector(".InputBox textarea");t.click(),t.focus()}catch{}},ut=()=>new Promise((t,e)=>{$fetch("/api/curva/check",{method:"POST"}).then(o=>{F.value=o;const n=D();if(At!=n)try{At=n,document.querySelector(".ConversationList").scrollTop=0}catch{}t(!0)}).catch(o=>{N.error("Initialization Failed"),e(o)})}),yr=t=>new Promise(async(e,o)=>{if(t==null)return e([]);const n=await $fetch("/api/curva/history",{method:"POST",body:{id:t}});(!n||n.length===0)&&dt("/c/");try{e(n.map(c=>Qt({...c,t:new Date(c.t),done:!!c.A})))}catch{dt("/c/"),e([])}}),_e=async function(t){return[]},wr=async()=>{try{const t=W.value.at(-1),e=await _e(t.Q),o=Bt()>=document.body.clientHeight;t.more=e,o&&V()}catch(t){console.error(t)}},Wt=(t=!1)=>{Z.value="gpt4",tt.value=!0,et.value=.5,t&&N.success("Conversation settings have been reset.")};Wt();const X=z(!1),rt=z(X.value),nt=z(X.value),lt=z(""),_r=Ee(()=>Z.value.startsWith("gpt3")?16e3:32e3),xr=(()=>{const{h:t}=fr,e=()=>[77,68,53].map(c=>String.fromCharCode(c)).join(""),o=(c,h)=>({hash:t(c,e(),h),timestamp:Ht(h)}),n=(c,h,A,T,H,a)=>{let x=D();return x||(x=ce.base64(8),F.value.unshift({id:x,name:"",mtime:Date.now(),config:""}),dt(`/c/${x}?feature=new`)),{conv:x,messages:c,model:h,temperature:A,t:T,tz:H,id:a}};return async c=>{const h=new Date,A=h.getTime(),T=h.getTimezoneOffset()/60*-1,H=(()=>{if(!tt.value)return[{role:"user",content:(c==null?void 0:c.Q)||""}];const a=W.value.lastIndexOf(c)+1||W.value.length;let x=W.value.slice(0,a);return x=x.slice(x.length-100),x.map(b=>[{role:"user",content:b.Q},{role:"assistant",content:b.A}].filter(d=>d.content)).flat()})();try{const a=n(H,Z.value,et.value,A,T,c==null?void 0:c.id),x=o(H,A);return await $fetch("/api/curva/answer",{method:"POST",headers:x,body:a})}catch{return{answer:"",error:"Error while sending request."}}}})(),Sr=(t="",e="",o=!1)=>Qt({done:o,Q:t,A:e,queries:[],urls:[],dt:void 0,t:new Date}),ht=new Set,Br=()=>{F.value=[],W.value=[],dt("/c/"),bt=!0};let bt=!0;function Ut(){{const t=Ie();t.get("feature")==="new"&&(t.delete("feature"),t.save(),qt())}}const xe=(t,e)=>{const o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),o.remove()},D=()=>{var t,e;return(e=(t=It._route)==null?void 0:t.params)==null?void 0:e.conv},vt=()=>{var e;const t=D();return((e=F.value.filter(o=>o.id===t)[0])==null?void 0:e.name)||""};async function qt(t,e){return t=t||D(),t?await $fetch("/api/curva/conv",{method:"PUT",body:{id:t,name:e||vt(),config:mr({model:Z.value,temperature:et.value,context:tt.value})}}):{cancel:!0}}let Tt=!1;const Cr=t=>{var n;if(t===void 0&&(t=D()),t==null)return;const e=gr(((n=F.value.find(c=>c.id===t))==null?void 0:n.config)||""),o=Object.keys(e);if(o.length===0)Wt();else{Tt=!0;try{for(const c of o){const h=e[c];switch(c){case"model":Z.value=h;break;case"temperature":et.value=h;break;case"context":tt.value=h;break}}}finally{Tt=!1}}N.info("Conversation settings have been loaded.")};setTimeout(()=>{let t;[Z,tt,et].forEach(e=>{ot(e,(o,n)=>{It&&!Tt&&o!==n&&ht.size===0&&(clearTimeout(t),t=setTimeout(async()=>{try{const{cancel:c=!1}=await qt();c||N.info("Conversation settings have been saved.")}catch(c){console.error(c),N.warning("Failed to save conversation settings.")}finally{clearTimeout(t)}},typeof e.value=="number"?500:0))})})},1e3);const Ar=t=>{W.value=W.value.filter(e=>e.id!==t),$fetch("/api/curva/answer",{method:"DELETE",body:{conv:D(),id:t}}).then(()=>N.info("The message has been deleted.")).catch(()=>N.error("An error occurred while deleting the message."))},br=()=>{let t=0;const e=`${Y.convert(D(),"64w",10)}.md`,o=W.value.map(n=>{t++;try{return(n.t?`${new Date(n.t.getTime()-(n.dt||0)).toLocaleString()}${n.dt===void 0?"":" (Î”t: "+n.dt.toString()+"ms)"}

`:"")+(n.Q?`QUESTION ${t}:

${n.Q.replaceAll(`
`,`

`)}`:"")+(n.Q&&n.A?`

`:"")+(n.A?`ANSWER ${t}:

${n.A}`:"")}catch{return"(Unknown message)"}}).join(`

---

`)+`

---

`;xe(e,o)},Tr=()=>{xe(`${Y.convert(D(),"64w",10)}.json`,JSON.stringify(W.value.map(t=>({question:t.Q,answer:t.A,created:new Date(t.t.getTime()).toUTCString(),timeUsed:t.dt||void 0,queries:t.queries||void 0,urls:t.urls||void 0})),null,4))};function qr(){const t=Ot("appName").value,e=He();e.delete("temperature",{path:"/"}),e.delete("temperature"),It=Re(),ot(X,d=>{Lt().isMobileScreen?(rt.value=!1,nt.value!==d&&(nt.value=d)):(nt.value=!1,rt.value!==d&&(rt.value=d)),setTimeout(()=>{try{M()}catch{}},0)}),ot(nt,d=>{X.value=d}),ot(rt,d=>{X.value=d});const o=()=>{try{jt(`${vt()||h("chat.title")} - ${t}`)}catch{jt(`${h("chat.title")} - ${t}`)}},n=async d=>{Lt().isMobileScreen&&(X.value=!1),W.value=[];const S=mt.service({text:h("chat.ldConv")+"...",lock:!0});try{const C=await Promise.all([d===null&&F.value.length>0?null:ut(),d===null?null:yr(d)]);Cr(d);const p=C[1];p!==null&&D()===d&&(W.value=p,wr())}finally{if(V(),S!==null)try{await V(500)}finally{S.close();try{await V(500)}finally{}}}setTimeout(()=>M(),500)},c=async(d,S=!1)=>{const C=Promise.all([...ht]),p=bt&&S?new Promise(async i=>{await n(d),Ut(),i(null)}):S?new Promise(i=>i(null)):n(d);bt=!1,ht.add(p);try{await C}catch{}try{await p}finally{ht.delete(p)}},h=ke().t,A=Ot("version"),T=async(d,S)=>{if(document.querySelectorAll(".Message.T").length>0)return N.info("Please wait for the completion of the previous question."),M(),!1;const p=(d!==void 0?d:lt.value).trim();if(d===void 0&&(lt.value="",p===""))return M(),!1;const i=(S?W.value.filter($=>$.id===S).at(-1):void 0)||Sr(p,"",!1);W.value.includes(i)||W.value.push(i),i.done=!1,i.Q=p,i.A="",i.urls=[],i.queries=[];const _=_e(),r=Bt()>=document.body.clientHeight,v=D();r&&V().finally(()=>M());const g=await xr(i);Ut(),At!==v&&ut();const{id:m,answer:w="",error:y,urls:k=[],queries:B=[],dt:E=0,version:R}=g;i.done=!0,i.t=new Date,i.dt=E||void 0,i.id=m||void 0,i.A=w||"",i.urls=k||[],i.queries=B||[];const I=($=>$?($.type==="warning"?N.warning($.content):N.error($.content),i.A="Oops! Something went wrong!",!0):!1)((()=>{if(w===""){if(y){const $=W.value.indexOf(i);switch(y){case"THINKING":return W.value.splice($,1),lt.value=p,{type:"warning",content:hr.get(y)};default:return{type:"error",content:y}}}return{type:"error",content:h("error.plzRefresh")}}})());return setTimeout(async()=>{!S&&r&&await V(),R&&R!==A.value&&pt.confirm(h("action.newVersion"),h("message.notice"),{confirmButtonText:h("message.ok"),cancelButtonText:h("message.cancel"),type:"warning"}).then(()=>{const $=mt.service({text:"Loading...",lock:!0});location.reload(),setTimeout(()=>$.close(),3e3)}).catch(()=>M())},0),_.then($=>{const O=Bt()>=document.body.clientHeight;i.more=$,O&&V()}),I};return{isEditingMessage:$t,editingMessage:pe,callEditMessageDialog:pr,editingMessageContent:ye,focusEditMessageInput:we,model:Z,conversations:F,messages:W,temperature:et,contextMode:tt,openMenu:X,openSidebar:rt,openDrawer:nt,inputValue:lt,inputMaxLength:_r,getCurrentConvId:D,getCurrentConvName:vt,checkTokenAndGetConversations:ut,loadChat:c,sendMessage:T,deleteMessage:Ar,regenerateMessage:async d=>{if(W.value.length===0)return;const{Q:S,id:C}=d||W.value.pop();T(S||"",C)},focusInput:M,refreshConversation:()=>{c(D()).finally(()=>M())},renameConversation:(d,S="")=>{d||(d=D(),S=vt()),pt.prompt(h("message.renameConvHint"),h("message.setting"),{confirmButtonText:h("message.ok"),cancelButtonText:h("message.cancel"),inputValue:S,inputPlaceholder:Y.convert(d,"64w",10)}).then(async({value:C})=>{try{await qt(d,C),N({type:"success",message:h("message.renameSuccess")}),await ut(),o()}catch{N({type:"error",message:"Oops! Something went wrong!"})}}).catch(()=>{})},deleteConversation:d=>{const S=d||D();let C="createNewChat";pt.confirm(h("message.deleteConvConfirm"),h("message.warning"),{confirmButtonText:h("message.ok"),cancelButtonText:h("message.cancel"),type:"warning"}).then(()=>{const p=mt.service({text:h("chat.dltConv")+"...",lock:!0});$fetch("/api/curva/conv",{method:"DELETE",body:{id:S}}).finally(async()=>{var _;p.close();const i=D();if(d===i){(_=document.getElementById(C))==null||_.click();const r=F.value.findIndex(v=>v.id===i);r!=-1&&F.value.splice(r,1)}})})},resetConvConfig:Wt,exportAsMarkdown:br,exportAsJson:Tr,clear:Br}}export{V as a,Y as b,Lt as c,ce as r,qr as u};
