import{a as V,E as q}from"./el-select.18895457.js";import{E as F}from"./el-link.0c2d5aa1.js";import{_ as N}from"./client-only.39d42521.js";import{f as P,r as f,ac as O,aR as C,h as R,c as i,b as k,w as m,aS as A,o as n,a as c,i as p,j as I,F as g,B as b,l as E,t as L,d as $,E as K,K as U,_ as D}from"./entry.8cb21acd.js";import"./el-input.4cde7000.js";import"./el-popper.5ab8bdda.js";import{u as M}from"./useTitle.46f1aa8c.js";import"./index.8dc2a4a7.js";import"./scroll.d8f8224a.js";import"./isEqual.2d7ec73e.js";import"./_Uint8Array.066789e0.js";import"./focus-trap.ea571284.js";import"./vue.f36acd1f.d5db21f1.js";const Q={class:"mt-8 flex-col gap-4 flex-center"},W={class:"px-4 w-full max-w-prose flex flex-col gap-4 justify-center"},Y={class:"pb-16"},z={class:"chapter-title"},G={class:"flex flex-wrap gap-2 pl-4 pt-2 pb-4"},H={class:"flex-center pb-16"},J=P({__name:"ls",setup(X){const o=f(""),x=O(()=>(o.value.split(" ").at(-1)||"").split(".json")[0]),d=f([]),u=f([]);function B(){history.length>1?history.back():K.info(U.choice(["Oh~dear, you shouldn't click this.","Back? Where do you want to go?","I don't want you to go anywhere else.","Stay here!","You are lost."]))}const h=f(!1);function y(s=""){const e=C();s?e.set("q",s):e.delete("q"),e.save()}function S(){o.value="",u.value=[],y()}async function w(){h.value=!0;const s=[];u.value=[];const e=A(),r=o.value;y(x.value);const v=await(await fetch(`https://api.cch137.link/ls/${r}`)).json();function _(a){for(const l of s)if(l.chapter===a)return l.problems;const t=[];return s.push({chapter:a,problems:t}),t}for(const a of v){const[t,l,T]=a.isbn_c_p.split("_");_(l).push({p:T,link:a.link})}u.value=s,e.close(),h.value=!1}(async()=>{const s=C().get("q")||"",e=fetch("https://api.cch137.link/ls/list");if(d.value=await(await e).json(),s&&!o.value){for(const r of d.value)if(r.toLowerCase().includes(s.toLowerCase())){o.value=r,await w();break}}})();const j=R("appName");return M(`LS - ${j.value}`),(s,e)=>{const r=V,v=q,_=F,a=N;return n(),i("div",Q,[k(a,null,{default:m(()=>[c("h1",{class:"m-0 cursor-pointer",onClick:e[0]||(e[0]=t=>S())},"LS"),c("div",W,[k(v,{modelValue:p(o),"onUpdate:modelValue":e[1]||(e[1]=t=>I(o)?o.value=t:null),onChange:e[2]||(e[2]=t=>w()),placeholder:"請選擇原文書",loading:p(h)},{default:m(()=>[(n(!0),i(g,null,b(p(d),t=>(n(),E(r,{key:t,label:t.replaceAll(".json",""),value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),c("div",Y,[(n(!0),i(g,null,b(p(u),t=>(n(),i("details",null,[c("summary",z,L(t.chapter),1),c("div",G,[(n(!0),i(g,null,b(t.problems,l=>(n(),E(_,{href:`https://api.cch137.link/ls/i/${l.p}_${t.chapter}_${p(x)}?id=${l.link.split("/").at(-1)}`,target:"_blank"},{default:m(()=>[$(L(l.p),1)]),_:2},1032,["href"]))),256))])]))),256))]),c("div",H,[k(_,{onClick:e[3]||(e[3]=t=>B())},{default:m(()=>[$("BACK")]),_:1})])])]),_:1})])}}});const _e=D(J,[["__scopeId","data-v-c84c2c52"]]);export{_e as default};
