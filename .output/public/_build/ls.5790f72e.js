import{a as N,E as P}from"./el-select.cdc6a3ab.js";import{E as O}from"./el-link.e64450dc.js";import{_ as R}from"./client-only.380a390b.js";import{f as A,r as _,ac as I,aR as E,h as K,c,b as g,w as d,aS as M,E as L,o as a,a as r,i as u,j as U,F as k,B as y,l as B,t as S,d as T,K as D,_ as H}from"./entry.9919ca84.js";import"./el-input.fe834516.js";import"./el-popper.4cb0a8d0.js";import{u as Q}from"./useTitle.15bf4318.js";import"./index.d460f44c.js";import"./scroll.57ff5c02.js";import"./isEqual.d7447cfc.js";import"./_Uint8Array.e1b351c0.js";import"./focus-trap.e8612b68.js";import"./vue.f36acd1f.e750931d.js";const W={class:"mt-8 flex-col gap-4 flex-center"},Y={class:"px-4 w-full max-w-prose flex flex-col gap-4 justify-center"},z={class:"pb-16"},G={class:"chapter-title"},J={class:"flex flex-wrap gap-2 pl-4 pt-2 pb-4"},X={class:"flex-center pb-16"},b="https://api.cch137.link",Z=A({__name:"ls",setup(ee){const o=_(""),x=I(()=>(o.value.split(" ").at(-1)||"").split(".json")[0]),m=_([]),p=_([]);function j(){history.length>1?history.back():L.info(D.choice(["Oh~dear, you shouldn't click this.","Back? Where do you want to go?","I don't want you to go anywhere else.","Stay here!","You are lost."]))}const v=_(!1);function w(s=""){const t=E();s?t.set("q",s):t.delete("q"),t.save()}function $(){o.value="",p.value=[],w()}async function C(){v.value=!0;const s=[];p.value=[];const t=M();try{let n=function(e){if(i.has(e))return i.get(e);const l=[];return i.set(e,l),s.push({chapter:e,problems:l}),l};const h=o.value;w(x.value);const f=await(await fetch(`${b}/ls/${h}`)).json(),i=new Map;for(const e of f){const[l,q,F]=e.isbn_c_p.split("_");n(q).push({p:F,link:e.link})}p.value=s}catch{L.error("Error: Book not found.")}t.close(),v.value=!1}(async()=>{const s=E().get("q")||"";s&&!o.value&&(o.value=s,C());const t=fetch(`${b}/ls/list`);if(m.value=await(await t).json(),!!s){for(const n of m.value)if(n.toLowerCase().includes(s.toLowerCase())){o.value=n;return}$()}})();const V=K("appName");return Q(`LS - ${V.value}`),(s,t)=>{const n=N,h=P,f=O,i=R;return a(),c("div",W,[g(i,null,{default:d(()=>[r("h1",{class:"m-0 cursor-pointer",onClick:t[0]||(t[0]=e=>$())},"LS"),r("div",Y,[g(h,{modelValue:u(o),"onUpdate:modelValue":t[1]||(t[1]=e=>U(o)?o.value=e:null),onChange:t[2]||(t[2]=e=>C()),placeholder:"請選擇原文書",loading:u(v)},{default:d(()=>[(a(!0),c(k,null,y(u(m),e=>(a(),B(n,{key:e,label:e.replaceAll(".json",""),value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),r("div",z,[(a(!0),c(k,null,y(u(p),e=>(a(),c("details",null,[r("summary",G,S(e.chapter),1),r("div",J,[(a(!0),c(k,null,y(e.problems,l=>(a(),B(f,{href:`${b}/ls/i/${e.chapter}_${l.p}?id=${l.link.split("/").at(-1)}&b=${u(x)}`,target:"_blank"},{default:d(()=>[T(S(l.p),1)]),_:2},1032,["href"]))),256))])]))),256))]),r("div",X,[g(f,{onClick:t[3]||(t[3]=e=>j())},{default:d(()=>[T("BACK")]),_:1})])])]),_:1})])}}});const de=H(Z,[["__scopeId","data-v-5a9ef8ff"]]);export{de as default};
